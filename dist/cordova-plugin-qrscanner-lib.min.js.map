{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 93abf133c0670beedd53","webpack:///cordova-plugin-qrscanner-lib.min.js","webpack:///./~/webrtc-adapter/src/js/utils.js","webpack:///./src/browser/src/createQRScannerInternal.js","webpack:///./src/common/src/createQRScannerAdapter.js","webpack:///./src/browser/worker.min.js","webpack:///./~/sdp/sdp.js","webpack:///./~/webrtc-adapter/src/js/adapter_core.js","webpack:///./~/webrtc-adapter/src/js/chrome/chrome_shim.js","webpack:///./~/webrtc-adapter/src/js/chrome/getusermedia.js","webpack:///./~/webrtc-adapter/src/js/edge/edge_shim.js","webpack:///./~/webrtc-adapter/src/js/edge/getusermedia.js","webpack:///./~/webrtc-adapter/src/js/edge/rtcpeerconnection_shim.js","webpack:///./~/webrtc-adapter/src/js/firefox/firefox_shim.js","webpack:///./~/webrtc-adapter/src/js/firefox/getusermedia.js","webpack:///./~/webrtc-adapter/src/js/safari/safari_shim.js","webpack:///./src/browser/src/library.js"],"names":["root","factory","exports","module","define","amd","this","__webpack_require__","moduleId","installedModules","i","l","modules","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","logDisabled_","utils","disableLog","bool","Error","log","window","console","apply","arguments","extractVersion","uastring","expr","pos","match","length","parseInt","detectBrowser","result","browser","version","navigator","mozGetUserMedia","userAgent","webkitGetUserMedia","webkitRTCPeerConnection","mediaDevices","shimCreateObjectURL","HTMLMediaElement","nativeCreateObjectURL","URL","createObjectURL","bind","nativeRevokeObjectURL","revokeObjectURL","streams","Map","newId","stream","url","set","delete","dsc","getOwnPropertyDescriptor","srcObject","nativeSetAttribute","setAttribute","toLowerCase","browserDetails","workerScript","killStream","mediaStream","getTracks","forEach","track","stop","getCameraSpecsById","deviceId","getConstraintObj","facingMode","width","height","obj","audio","video","exact","getFirstResolvingConstraint","constraintsBestToWorst","Promise","resolveBestConstraints","reduce","chain","next","then","searchState","found","nextConstraint","getUserMedia","resolve","facingModeConstraints","facingModes","map","mode","widthConstraints","standardWidthsAndHeights","heightConstraints","facingModeSpecs","widthSpecs","heightSpecs","chooseCameras","enumerateDevices","mediaDeviceInfoList","filter","elem","kind","videoDeviceIds","searches","id","push","all","cameraSpecsArray","camera","sort","a","b","bestToWorstCameras","backCamera","frontCamera","splice","mediaStreamIsActive","activeMediaStream","killActiveMediaStream","getVideoPreview","document","getElementById","ELEMENTS","preview","getImg","still","getCurrentCameraIndex","currentCamera","getCurrentCamera","bringStillToFront","img","style","visibility","previewing","bringPreviewToFront","isInitialized","canChangeCamera","calcStatus","authorized","denied","restricted","prepared","scanning","showing","lightEnabled","canOpenSettings","canEnableLight","toString","startCamera","success","error","currentCameraIndex","ideal","src","err","getTempCanvasAndContext","videoElement","tempCanvas","createElement","tempCanvasContext","getContext","drawImage","canvas","context","getCurrentImageData","snapshot","getImageData","captureCurrentFrame","toDataURL","initialize","scanWorker","workerBlob","Blob","type","Worker","videoPreview","ZINDEXES","addEventListener","stillImg","body","appendChild","cameras","prepare","show","showCamera","hide","scan","ignore","returned","onmessage","event","data","thisScanCycle","postMessage","cancelNextScan","SCAN_INTERVAL","QRScanner_SCAN_INTERVAL","nextScan","setTimeout","sendError","clearTimeout","cancelScan","pausePreview","pause","Image","backgroundImage","resumePreview","enableLight","disableLight","useCamera","array","requestedCamera","initialized","status","openSettings","getStatus","destroy","remove","cordova","stringToBool","string","convertStatus","statusDictionary","clearBackground","backgroundColor","parentNode","errorCallback","callback","errorCode","QRScannerError","code","_message","successCallback","statusDict","doneCallback","clear","exec","index","useFrontCamera","useBackCamera","SDPUtils","generateIdentifier","Math","random","substr","localCName","splitLines","blob","trim","split","line","splitSections","part","matchPrefix","prefix","indexOf","parseCandidate","parts","substring","candidate","foundation","component","protocol","priority","ip","port","relatedAddress","relatedPort","tcpType","writeCandidate","sdp","toUpperCase","join","parseIceOptions","parseRtpMap","parsed","payloadType","shift","clockRate","numChannels","writeRtpMap","codec","pt","undefined","preferredPayloadType","parseExtmap","direction","uri","writeExtmap","headerExtension","preferredId","parseFmtp","kv","j","writeFmtp","parameters","keys","params","param","parseRtcpFb","parameter","writeRtcpFb","lines","rtcpFeedback","fb","parseSsrcMedia","sp","ssrc","colon","attribute","getMid","mediaSection","mid","parseFingerprint","algorithm","getDtlsParameters","sessionpart","role","fingerprints","writeDtlsParameters","setupType","fp","getIceParameters","concat","usernameFragment","password","writeIceParameters","parseRtpParameters","description","codecs","headerExtensions","fecMechanisms","rtcp","mline","rtpmapline","fmtps","writeRtpDescription","caps","maxptime","extension","parseRtpEncodingParameters","secondarySsrc","encodingParameters","hasRed","hasUlpfec","ssrcs","primarySsrc","flows","apt","encParam","codecPayloadType","rtx","JSON","parse","stringify","fec","mechanism","bandwidth","maxBitrate","parseRtcpParameters","rtcpParameters","remoteSsrc","cname","rsize","reducedSize","compound","mux","parseMsid","spec","planB","writeSessionBoilerplate","writeMediaSection","transceiver","iceGatherer","getLocalParameters","dtlsTransport","rtpSender","rtpReceiver","msid","sendEncodingParameters","getDirection","getKind","isRejected","logging","chromeShim","edgeShim","firefoxShim","safariShim","shimPeerConnection","browserShim","shimGetUserMedia","shimMediaStream","shimSourceObject","shimOnTrack","shimGetSendersWithDtmf","shimReplaceTrack","shimCallbacksAPI","shimAddStream","shimOnAddStream","MediaStream","webkitMediaStream","RTCPeerConnection","_ontrack","f","self","removeEventListener","_ontrackpoly","e","te","receiver","getReceivers","find","r","Event","dispatchEvent","getSenders","_senders","origAddStream","addStream","origRemoveStream","removeStream","addTrack","pc","signalingState","DOMException","slice","t","_streams","oldStream","newStream","sender","_dtmf","createDTMFSender","_srcObject","OrigPeerConnection","pcConfig","pcConstraints","iceServers","newIceServers","server","warn","urls","generateCertificate","iceTransportPolicy","iceTransports","origGetStats","getStats","selector","args","fixChromeStats_","response","standardReport","report","standardStats","timestamp","localcandidate","remotecandidate","names","stat","makeMapStats","stats","key","successCallbackWrapper_","reject","method","nativeMethod","promise","opts","RTCIceCandidate","RTCSessionDescription","nativeAddIceCandidate","addIceCandidate","constraintsToChrome_","mandatory","optional","cc","min","max","oldname_","charAt","oc","mix","advanced","shimConstraints_","constraints","func","face","getSupportedFacingModeLies","getSupportedConstraints","matches","devices","dev","some","label","shimError_","ConstraintNotSatisfiedError","PermissionDeniedError","TrackStartError","message","constraint","constraintName","getUserMedia_","onSuccess","onError","getUserMediaPromise_","kinds","MediaStreamTrack","getSources","device","groupId","echoCancellation","frameRate","origGetUserMedia","cs","getAudioTracks","getVideoTracks","shimRTCPeerConnection","RTCIceGatherer","origMSTEnabled","ev","enabled","RTCRtpSender","replaceTrack","setTrack","catch","sortTracks","tracks","audioTracks","videoTracks","filterIceServers","edgeVersion","hasTurn","isString","getCommonCapabilities","localCapabilities","remoteCapabilities","commonCapabilities","findCodecByPayloadType","rtxCapabilityMatches","lRtx","rRtx","lCodecs","rCodecs","lCodec","rCodec","lHeaderExtension","rHeaderExtension","isActionAllowedInSignalingState","action","offer","setLocalDescription","setRemoteDescription","answer","config","_eventTarget","createDocumentFragment","needNegotiation","onicecandidate","onaddstream","ontrack","onremovestream","onsignalingstatechange","oniceconnectionstatechange","onicegatheringstatechange","onnegotiationneeded","ondatachannel","canTrickleIceCandidates","localStreams","remoteStreams","getLocalStreams","getRemoteStreams","localDescription","remoteDescription","iceConnectionState","iceGatheringState","iceOptions","gatherPolicy","usingBundle","bundlePolicy","_config","transceivers","_localIceCandidatesBuffer","_emitGatheringStateChange","_emitBufferedCandidates","sections","sdpMLineIndex","every","state","iceGatheringStateChange","getConfiguration","_createTransceiver","hasBundleTransport","iceTransport","recvEncodingParameters","wantReceive","transports","_createIceAndDtlsTransports","_maybeFireNegotiationNeeded","clonedStream","clone","idx","clonedTrack","_createIceGatherer","onlocalcandidate","evt","sdpMid","cand","end","_pendingOffer","complete","RTCIceTransport","onicestatechange","_updateConnectionState","RTCDtlsTransport","ondtlsstatechange","onerror","writable","_disposeIceAndDtlsTransports","ondtlssttatechange","_transceive","send","recv","encodings","receive","isIceLite","isDatachannel","remoteIceParameters","remoteDtlsParameters","start","_updateSignalingState","TypeError","hasCallback","cb","receiverList","rejected","remoteMsid","isComplete","cands","setTransport","setRemoteCandidates","default","RTCRtpReceiver","getCapabilities","sid","item","trackEvent","getRemoteCandidates","addRemoteCandidate","close","newState","states","closed","connecting","checking","connected","completed","failed","disconnected","new","createOffer","offerOptions","numAudioTracks","numVideoTracks","offerToReceiveAudio","offerToReceiveVideo","desc","createAnswer","localTrack","mLineIndex","promises","fixStatsType","inboundrtp","outboundrtp","candidatepair","results","res","mozSrcObject","mozRTCPeerConnection","newServer","username","credential","mozRTCSessionDescription","mozRTCIceCandidate","modernStatsTypes","nativeGetStats","onSucc","onErr","assign","InternalError","NotSupportedError","SecurityError","constraintsToFF37_","require","orgEnumerateDevices","_onaddstream","_onaddstreampoly","failureCallback","options","withCallback","errcb","QRScanner","getFunc","createQRScannerAdapter","createQRScannerInternal","internal","functionList","className","functionName","inputArray"],"mappings":"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","file":"cordova-plugin-qrscanner-lib.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"QRScanner\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"QRScanner\"] = factory();\n\telse\n\t\troot[\"QRScanner\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 14);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 93abf133c0670beedd53","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"QRScanner\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"QRScanner\"] = factory();\n\telse\n\t\troot[\"QRScanner\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 14);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n\n\nvar logDisabled_ = true;\n\n// Utility methods.\nvar utils = {\n  disableLog: function(bool) {\n    if (typeof bool !== 'boolean') {\n      return new Error('Argument type: ' + typeof bool +\n          '. Please use a boolean.');\n    }\n    logDisabled_ = bool;\n    return (bool) ? 'adapter.js logging disabled' :\n        'adapter.js logging enabled';\n  },\n\n  log: function() {\n    if (typeof window === 'object') {\n      if (logDisabled_) {\n        return;\n      }\n      if (typeof console !== 'undefined' && typeof console.log === 'function') {\n        console.log.apply(console, arguments);\n      }\n    }\n  },\n\n  /**\n   * Extract browser version out of the provided user agent string.\n   *\n   * @param {!string} uastring userAgent string.\n   * @param {!string} expr Regular expression used as match criteria.\n   * @param {!number} pos position in the version string to be returned.\n   * @return {!number} browser version.\n   */\n  extractVersion: function(uastring, expr, pos) {\n    var match = uastring.match(expr);\n    return match && match.length >= pos && parseInt(match[pos], 10);\n  },\n\n  /**\n   * Browser detector.\n   *\n   * @return {object} result containing browser and version\n   *     properties.\n   */\n  detectBrowser: function() {\n    // Returned result object.\n    var result = {};\n    result.browser = null;\n    result.version = null;\n\n    // Fail early if it's not a browser\n    if (typeof window === 'undefined' || !window.navigator) {\n      result.browser = 'Not a browser.';\n      return result;\n    }\n\n    // Firefox.\n    if (navigator.mozGetUserMedia) {\n      result.browser = 'firefox';\n      result.version = this.extractVersion(navigator.userAgent,\n          /Firefox\\/(\\d+)\\./, 1);\n    } else if (navigator.webkitGetUserMedia) {\n      // Chrome, Chromium, Webview, Opera, all use the chrome shim for now\n      if (window.webkitRTCPeerConnection) {\n        result.browser = 'chrome';\n        result.version = this.extractVersion(navigator.userAgent,\n          /Chrom(e|ium)\\/(\\d+)\\./, 2);\n      } else { // Safari (in an unpublished version) or unknown webkit-based.\n        if (navigator.userAgent.match(/Version\\/(\\d+).(\\d+)/)) {\n          result.browser = 'safari';\n          result.version = this.extractVersion(navigator.userAgent,\n            /AppleWebKit\\/(\\d+)\\./, 1);\n        } else { // unknown webkit-based browser.\n          result.browser = 'Unsupported webkit-based browser ' +\n              'with GUM support but no WebRTC support.';\n          return result;\n        }\n      }\n    } else if (navigator.mediaDevices &&\n        navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/)) { // Edge.\n      result.browser = 'edge';\n      result.version = this.extractVersion(navigator.userAgent,\n          /Edge\\/(\\d+).(\\d+)$/, 2);\n    } else if (navigator.mediaDevices &&\n        navigator.userAgent.match(/AppleWebKit\\/(\\d+)\\./)) {\n        // Safari, with webkitGetUserMedia removed.\n      result.browser = 'safari';\n      result.version = this.extractVersion(navigator.userAgent,\n          /AppleWebKit\\/(\\d+)\\./, 1);\n    } else { // Default fallthrough: not supported.\n      result.browser = 'Not a supported browser.';\n      return result;\n    }\n\n    return result;\n  },\n\n  // shimCreateObjectURL must be called before shimSourceObject to avoid loop.\n\n  shimCreateObjectURL: function() {\n    if (!(typeof window === 'object' && window.HTMLMediaElement &&\n          'srcObject' in window.HTMLMediaElement.prototype)) {\n      // Only shim CreateObjectURL using srcObject if srcObject exists.\n      return undefined;\n    }\n\n    var nativeCreateObjectURL = URL.createObjectURL.bind(URL);\n    var nativeRevokeObjectURL = URL.revokeObjectURL.bind(URL);\n    var streams = new Map(), newId = 0;\n\n    URL.createObjectURL = function(stream) {\n      if ('getTracks' in stream) {\n        var url = 'polyblob:' + (++newId);\n        streams.set(url, stream);\n        console.log('URL.createObjectURL(stream) is deprecated! ' +\n                    'Use elem.srcObject = stream instead!');\n        return url;\n      }\n      return nativeCreateObjectURL(stream);\n    };\n    URL.revokeObjectURL = function(url) {\n      nativeRevokeObjectURL(url);\n      streams.delete(url);\n    };\n\n    var dsc = Object.getOwnPropertyDescriptor(window.HTMLMediaElement.prototype,\n                                              'src');\n    Object.defineProperty(window.HTMLMediaElement.prototype, 'src', {\n      get: function() {\n        return dsc.get.apply(this);\n      },\n      set: function(url) {\n        this.srcObject = streams.get(url) || null;\n        return dsc.set.apply(this, [url]);\n      }\n    });\n\n    var nativeSetAttribute = HTMLMediaElement.prototype.setAttribute;\n    HTMLMediaElement.prototype.setAttribute = function() {\n      if (arguments.length === 2 &&\n          ('' + arguments[0]).toLowerCase() === 'src') {\n        this.srcObject = streams.get(arguments[1]) || null;\n      }\n      return nativeSetAttribute.apply(this, arguments);\n    };\n  }\n};\n\n// Export.\nmodule.exports = {\n  log: utils.log,\n  disableLog: utils.disableLog,\n  browserDetails: utils.detectBrowser(),\n  extractVersion: utils.extractVersion,\n  shimCreateObjectURL: utils.shimCreateObjectURL,\n  detectBrowser: utils.detectBrowser.bind(utils)\n};\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n__webpack_require__(5);\nvar workerScript = __webpack_require__(3);\n\nmodule.exports = function(){\n\n  var ELEMENTS = {\n    preview: 'cordova-plugin-qrscanner-video-preview',\n    still: 'cordova-plugin-qrscanner-still'\n  };\n  var ZINDEXES = {\n    preview: -100,\n    still: -99\n  };\n  var backCamera = null;\n  var frontCamera = null;\n  var currentCamera = 0;\n  var activeMediaStream = null;\n  var scanning = false;\n  var previewing = false;\n  var scanWorker = null;\n  var thisScanCycle = null;\n  var nextScan = null;\n  var cancelNextScan = null;\n\n  // standard screen widths/heights, from 4k down to 320x240\n  // widths and heights are each tested separately to account for screen rotation\n  var standardWidthsAndHeights = [\n    5120, 4096, 3840, 3440, 3200, 3072, 3000, 2880, 2800, 2736, 2732, 2560,\n    2538, 2400, 2304, 2160, 2100, 2048, 2000, 1920, 1856, 1824, 1800, 1792,\n    1776, 1728, 1700, 1680, 1600, 1536, 1440, 1400, 1392, 1366, 1344, 1334,\n    1280, 1200, 1152, 1136, 1120, 1080, 1050, 1024, 1000, 960, 900, 854, 848,\n    832, 800, 768, 750, 720, 640, 624, 600, 576, 544, 540, 512, 480, 320, 240\n  ];\n\n  var facingModes = [\n    'environment',\n    'user'\n  ];\n\n  //utils\n  function killStream(mediaStream){\n    mediaStream.getTracks().forEach(function(track){\n      track.stop();\n    });\n  }\n\n  // For performance, we test best-to-worst constraints. Once we find a match,\n  // we move to the next test. Since `ConstraintNotSatisfiedError`s are thrown\n  // much faster than streams can be started and stopped, the scan is much\n  // faster, even though it may iterate through more constraint objects.\n  function getCameraSpecsById(deviceId){\n\n    // return a getUserMedia Constraints\n    function getConstraintObj(deviceId, facingMode, width, height){\n      var obj = { audio: false, video: {} };\n      obj.video.deviceId = {exact: deviceId};\n      if(facingMode) {\n        obj.video.facingMode = {exact: facingMode};\n      }\n      if(width) {\n        obj.video.width = {exact: width};\n      }\n      if(height) {\n        obj.video.height = {exact: height};\n      }\n      return obj;\n    }\n\n    var facingModeConstraints = facingModes.map(function(mode){\n    \treturn getConstraintObj(deviceId, mode);\n    });\n    var widthConstraints = standardWidthsAndHeights.map(function(width){\n    \treturn getConstraintObj(deviceId, null, width);\n    });\n    var heightConstraints = standardWidthsAndHeights.map(function(height){\n    \treturn getConstraintObj(deviceId, null, null, height);\n    });\n\n    // create a promise which tries to resolve the best constraints for this deviceId\n    // rather than reject, failures return a value of `null`\n    function getFirstResolvingConstraint(constraintsBestToWorst){\n      return new Promise(function(resolveBestConstraints){\n        // build a chain of promises which either resolves or continues searching\n        return constraintsBestToWorst.reduce(function(chain, next){\n          return chain.then(function(searchState){\n            if(searchState.found){\n              // The best working constraint was found. Skip further tests.\n              return searchState;\n            } else {\n              searchState.nextConstraint = next;\n              return window.navigator.mediaDevices.getUserMedia(searchState.nextConstraint).then(function(mediaStream){\n                // We found the first working constraint object, now we can stop\n                // the stream and short-circuit the search.\n                killStream(mediaStream);\n                searchState.found = true;\n                return searchState;\n              }, function(){\n                // didn't get a media stream. The search continues:\n                return searchState;\n              });\n            }\n          });\n        }, Promise.resolve({\n          // kick off the search:\n          found: false,\n          nextConstraint: {}\n        })).then(function(searchState){\n          if(searchState.found){\n            resolveBestConstraints(searchState.nextConstraint);\n          } else {\n            resolveBestConstraints(null);\n          }\n        });\n      });\n    }\n\n    return getFirstResolvingConstraint(facingModeConstraints).then(function(facingModeSpecs){\n      return getFirstResolvingConstraint(widthConstraints).then(function(widthSpecs){\n        return getFirstResolvingConstraint(heightConstraints).then(function(heightSpecs){\n          return {\n            deviceId: deviceId,\n            facingMode: facingModeSpecs === null ? null : facingModeSpecs.video.facingMode.exact,\n            width: widthSpecs === null ? null : widthSpecs.video.width.exact,\n            height: heightSpecs === null ? null : heightSpecs.video.height.exact\n          };\n        });\n      });\n    });\n  }\n\n  function chooseCameras(){\n    var devices = window.navigator.mediaDevices.enumerateDevices();\n    return devices.then(function(mediaDeviceInfoList){\n      var videoDeviceIds = mediaDeviceInfoList.filter(function(elem){\n        return elem.kind === 'videoinput';\n      }).map(function(elem){\n        return elem.deviceId;\n      });\n      return videoDeviceIds;\n    }).then(function(videoDeviceIds){\n      // there is no standardized way for us to get the specs of each camera\n      // (due to concerns over user fingerprinting), so we're forced to\n      // iteratively test each camera for it's capabilities\n      var searches = [];\n      videoDeviceIds.forEach(function(id){\n        searches.push(getCameraSpecsById(id));\n      });\n      return Promise.all(searches);\n    }).then(function(cameraSpecsArray){\n      return cameraSpecsArray.filter(function(camera){\n        // filter out any cameras where width and height could not be captured\n        if(camera !== null && camera.width !== null && camera.height !== null){\n          return true;\n        }\n      }).sort(function(a, b){\n        // sort cameras from highest resolution (by width) to lowest\n        return b.width - a.width;\n      });\n    }).then(function(bestToWorstCameras){\n      var backCamera = null,\n          frontCamera = null;\n      // choose backCamera\n      for(var i = 0; i < bestToWorstCameras.length; i++){\n        if (bestToWorstCameras[i].facingMode === 'environment'){\n          backCamera = bestToWorstCameras[i];\n          // (shouldn't be used for frontCamera)\n          bestToWorstCameras.splice(i, 1);\n          break;\n        }\n      }\n      // if no back-facing cameras were found, choose the highest resolution\n      if(backCamera === null){\n        if(bestToWorstCameras.length > 0){\n          backCamera = bestToWorstCameras[0];\n          // (shouldn't be used for frontCamera)\n          bestToWorstCameras.splice(0, 1);\n        } else {\n          // user doesn't have any available cameras\n          backCamera = false;\n        }\n      }\n      if(bestToWorstCameras.length > 0){\n        // frontCamera should simply be the next-best resolution camera\n        frontCamera = bestToWorstCameras[0];\n      } else {\n        // user doesn't have any more cameras\n        frontCamera = false;\n      }\n      return {\n        backCamera: backCamera,\n        frontCamera: frontCamera\n      };\n    });\n  }\n\n  function mediaStreamIsActive(){\n    return activeMediaStream !== null;\n  }\n\n  function killActiveMediaStream(){\n    killStream(activeMediaStream);\n    activeMediaStream = null;\n  }\n\n  function getVideoPreview(){\n    return document.getElementById(ELEMENTS.preview);\n  }\n\n  function getImg(){\n    return document.getElementById(ELEMENTS.still);\n  }\n\n  function getCurrentCameraIndex(){\n    return currentCamera;\n  }\n\n  function getCurrentCamera(){\n    return currentCamera === 1 ? frontCamera : backCamera;\n  }\n\n  function bringStillToFront(){\n    var img = getImg();\n    if(img){\n      img.style.visibility = 'visible';\n      previewing = false;\n    }\n  }\n\n  function bringPreviewToFront(){\n    var img = getImg();\n    if(img){\n      img.style.visibility = 'hidden';\n      previewing = true;\n    }\n  }\n\n  function isInitialized(){\n    return backCamera !== null;\n  }\n\n  function canChangeCamera(){\n    return !!backCamera && !!frontCamera;\n  }\n\n  function calcStatus(){\n    return {\n      // !authorized means the user either has no camera or has denied access.\n      // This would leave a value of `null` before prepare(), and `false` after.\n      authorized: (backCamera !== null && backCamera !== false)? '1': '0',\n      // No applicable API\n      denied: '0',\n      // No applicable API\n      restricted: '0',\n      prepared: isInitialized() ? '1' : '0',\n      scanning: scanning? '1' : '0',\n      previewing: previewing? '1' : '0',\n      // We leave this true after prepare() to match the mobile experience as\n      // closely as possible. (Without additional covering, the preview will\n      // always be visible to the user).\n      showing: getVideoPreview()? '1' : '0',\n      // No applicable API\n      lightEnabled: '0',\n      // No applicable API\n      canOpenSettings: '0',\n      // No applicable API\n      canEnableLight: '0',\n      canChangeCamera: canChangeCamera() ? '1' : '0',\n      currentCamera: currentCamera.toString()\n    };\n  }\n\n  function startCamera(success, error){\n      var currentCameraIndex = getCurrentCameraIndex();\n      var currentCamera = getCurrentCamera();\n      window.navigator.mediaDevices.getUserMedia({\n        audio: false,\n        video: {\n          deviceId: {exact: currentCamera.deviceId},\n          width: {ideal: currentCamera.width},\n          height: {ideal: currentCamera.height}\n        }\n      }).then(function(mediaStream){\n        activeMediaStream = mediaStream;\n        var video = getVideoPreview();\n        video.src = URL.createObjectURL(mediaStream);\n        success(calcStatus());\n      }, function(err){\n        // something bad happened\n        err = null;\n        var code = currentCameraIndex? 4 : 3;\n        error(code); // FRONT_CAMERA_UNAVAILABLE : BACK_CAMERA_UNAVAILABLE\n      });\n  }\n\n  function getTempCanvasAndContext(videoElement){\n    var tempCanvas = document.createElement('canvas');\n    var camera = getCurrentCamera();\n    tempCanvas.height = camera.height;\n    tempCanvas.width = camera.width;\n    var tempCanvasContext = tempCanvas.getContext('2d');\n    tempCanvasContext.drawImage(videoElement, 0, 0, camera.width, camera.height);\n    return {\n      canvas: tempCanvas,\n      context: tempCanvasContext\n    };\n  }\n\n  function getCurrentImageData(videoElement){\n    var snapshot = getTempCanvasAndContext(videoElement);\n    return snapshot.context.getImageData(0, 0, snapshot.canvas.width, snapshot.canvas.height);\n  }\n\n  // take a screenshot of the video preview with a temp canvas\n  function captureCurrentFrame(videoElement){\n    return getTempCanvasAndContext(videoElement).canvas.toDataURL('image/png');\n  }\n\n  function initialize(success, error){\n    if(scanWorker === null){\n      var workerBlob = new Blob([workerScript],{type: \"text/javascript\"});\n      scanWorker = new Worker(URL.createObjectURL(workerBlob));\n    }\n    if(!getVideoPreview()){\n      // prepare DOM (sync)\n      var videoPreview = document.createElement('video');\n      videoPreview.setAttribute('autoplay', 'autoplay');\n      videoPreview.setAttribute('id', ELEMENTS.preview);\n      videoPreview.setAttribute('style', 'display:block;position:fixed;top:50%;left:50%;' +\n      'width:auto;height:auto;min-width:100%;min-height:100%;z-index:' + ZINDEXES.preview +\n      ';-moz-transform: translateX(-50%) translateY(-50%);-webkit-transform: ' +\n      'translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);' +\n      'background-size:cover;background-position:50% 50%;background-color:#FFF;');\n      videoPreview.addEventListener('loadeddata', function(){\n        bringPreviewToFront();\n      });\n\n      var stillImg = document.createElement('div');\n      stillImg.setAttribute('id', ELEMENTS.still);\n      stillImg.setAttribute('style', 'display:block;position:fixed;top:50%;left:50%;visibility: hidden;' +\n      'width:auto;height:auto;min-width:100%;min-height:100%;z-index:' + ZINDEXES.still +\n      ';-moz-transform: translateX(-50%) translateY(-50%);-webkit-transform: ' +\n      'translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);' +\n      'background-size:cover;background-position:50% 50%;background-color:#FFF;');\n\n      document.body.appendChild(videoPreview);\n      document.body.appendChild(stillImg);\n    }\n    if(backCamera === null){\n      // set instance cameras\n      chooseCameras().then(function(cameras){\n        backCamera = cameras.backCamera;\n        frontCamera = cameras.frontCamera;\n        if(backCamera !== false){\n          success();\n        } else {\n          error(5); // CAMERA_UNAVAILABLE\n        }\n      }, function(err){\n        // something bad happened\n        err = null;\n        error(0); // UNEXPECTED_ERROR\n      });\n    } else if (backCamera === false){\n      error(5); // CAMERA_UNAVAILABLE\n    } else {\n      success();\n    }\n  }\n\n  /*\n   *  --- Begin Public API ---\n   */\n\n  function prepare(success, error){\n    initialize(function(){\n      // return status on success\n      success(calcStatus());\n    },\n    // pass errors through\n    error);\n  }\n\n  function show(success, error){\n    function showCamera(){\n      if(!mediaStreamIsActive()){\n        startCamera(success, error);\n      } else {\n        success(calcStatus());\n      }\n    }\n    if(!isInitialized()){\n      initialize(function(){\n        // on successful initialization, attempt to showCamera\n        showCamera();\n      },\n      // pass errors through\n      error);\n    } else {\n      showCamera();\n    }\n  }\n\n  function hide(success, error){\n    error = null; // should never error\n    if(mediaStreamIsActive()){\n      killActiveMediaStream();\n    }\n    var video = getVideoPreview();\n    if(video){\n      video.src = '';\n    }\n    success(calcStatus());\n  }\n\n  function scan(success, error) {\n    // initialize and start video preview if not already active\n    show(function(ignore){\n      // ignore success output – `scan` method callback should be passed the decoded data\n      ignore = null;\n      var video = getVideoPreview();\n      var returned = false;\n      scanning = true;\n      scanWorker.onmessage = function(event){\n        var obj = event.data;\n        if(obj.result && !returned){\n          returned = true;\n          thisScanCycle = null;\n          success(obj.result);\n        }\n      };\n      thisScanCycle = function(){\n        scanWorker.postMessage(getCurrentImageData(video));\n        if(cancelNextScan !== null){\n          // avoid race conditions, always clear before starting a cycle\n          cancelNextScan();\n        }\n        // interval in milliseconds at which to try decoding the QR code\n        var SCAN_INTERVAL = window.QRScanner_SCAN_INTERVAL || 130;\n        // this value can be adjusted on-the-fly (while a scan is active) to\n        // balance scan speed vs. CPU/power usage\n        nextScan = window.setTimeout(thisScanCycle, SCAN_INTERVAL);\n        cancelNextScan = function(sendError){\n          window.clearTimeout(nextScan);\n          nextScan = null;\n          cancelNextScan = null;\n          if(sendError){\n            error(6); // SCAN_CANCELED\n          }\n        };\n      };\n      thisScanCycle();\n    }, error);\n  }\n\n  function cancelScan(success, error){\n    error = null; // should never error\n    if(cancelNextScan !== null){\n      cancelNextScan(true);\n    }\n    scanning = false;\n    if(typeof success === \"function\"){\n      success(calcStatus());\n    }\n  }\n\n  function pausePreview(success, error){\n    error = null; // should never error\n    if(mediaStreamIsActive()){\n      // pause scanning too\n      if(cancelNextScan !== null){\n        cancelNextScan();\n      }\n      var video = getVideoPreview();\n      video.pause();\n      var img = new Image();\n      img.src = captureCurrentFrame(video);\n      getImg().style.backgroundImage = 'url(' + img.src + ')';\n      bringStillToFront();\n      // kill the active stream to turn off the privacy light (the screenshot\n      // in the stillImg will remain visible)\n      killActiveMediaStream();\n      success(calcStatus());\n    } else {\n      success(calcStatus());\n    }\n  }\n\n  function resumePreview(success, error){\n    // if a scan was happening, resume it\n    if(thisScanCycle !== null){\n      thisScanCycle();\n    }\n    show(success, error);\n  }\n\n  function enableLight(success, error){\n    error(7); //LIGHT_UNAVAILABLE\n  }\n\n  function disableLight(success, error){\n    error(7); //LIGHT_UNAVAILABLE\n  }\n\n  function useCamera(success, error, array){\n    var requestedCamera = array[0];\n    var initialized = isInitialized();\n    if(requestedCamera !== currentCamera){\n      if(initialized && requestedCamera === 1 && !canChangeCamera()){\n          error(4); //FRONT_CAMERA_UNAVAILABLE\n      } else {\n        currentCamera = requestedCamera;\n        if(initialized){\n          hide(function(status){\n            // Don't need this one\n            status = null;\n          });\n          show(success, error);\n        } else {\n          success(calcStatus());\n        }\n      }\n    } else {\n      success(calcStatus());\n    }\n  }\n\n  function openSettings(success, error){\n    error(8); //OPEN_SETTINGS_UNAVAILABLE\n  }\n\n  function getStatus(success, error){\n    error = null; // should never error\n    success(calcStatus());\n  }\n\n  // Reset all instance variables to their original state.\n  // This method might be useful in cases where a new camera is available, and\n  // the application needs to force the plugin to chooseCameras() again.\n  function destroy(success, error){\n    error = null; // should never error\n    cancelScan();\n    if(mediaStreamIsActive()){\n      killActiveMediaStream();\n    }\n    backCamera = null;\n    frontCamera = null;\n    var preview = getVideoPreview();\n    var still = getImg();\n    if(preview){\n      preview.remove();\n    }\n    if(still){\n      still.remove();\n    }\n    success(calcStatus());\n  }\n\n  return {\n      prepare: prepare,\n      show: show,\n      hide: hide,\n      scan: scan,\n      cancelScan: cancelScan,\n      pausePreview: pausePreview,\n      resumePreview: resumePreview,\n      enableLight: enableLight,\n      disableLight: disableLight,\n      useCamera: useCamera,\n      openSettings: openSettings,\n      getStatus: getStatus,\n      destroy: destroy\n  };\n};\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports) {\n\nmodule.exports = function createQRScanner(cordova){\n// The native implementations should return their status as ['string':'string']\n// dictionaries. Boolean values are encoded to '0' and '1', respectively.\nfunction stringToBool(string) {\n  switch (string) {\n    case '1':\n      return true;\n    case '0':\n      return false;\n    default:\n    throw new Error('QRScanner plugin returned an invalid boolean number-string: ' + string);\n  }\n}\n\n// Converts the returned ['string':'string'] dictionary to a status object.\nfunction convertStatus(statusDictionary) {\n  return {\n    authorized: stringToBool(statusDictionary.authorized),\n    denied: stringToBool(statusDictionary.denied),\n    restricted: stringToBool(statusDictionary.restricted),\n    prepared: stringToBool(statusDictionary.prepared),\n    scanning: stringToBool(statusDictionary.scanning),\n    previewing: stringToBool(statusDictionary.previewing),\n    showing: stringToBool(statusDictionary.showing),\n    lightEnabled: stringToBool(statusDictionary.lightEnabled),\n    canOpenSettings: stringToBool(statusDictionary.canOpenSettings),\n    canEnableLight: stringToBool(statusDictionary.canEnableLight),\n    canChangeCamera: stringToBool(statusDictionary.canChangeCamera),\n    currentCamera: parseInt(statusDictionary.currentCamera)\n  };\n}\n\n// Simple utility method to ensure the background is transparent. Used by the\n// plugin to force re-rendering immediately after the native webview background\n// is made transparent.\nfunction clearBackground() {\n  var body = document.body;\n  if (body.style) {\n    body.style.backgroundColor = 'rgba(0,0,0,0.01)';\n    body.style.backgroundImage = '';\n    setTimeout(function() {\n      body.style.backgroundColor = 'transparent';\n    }, 1);\n    if (body.parentNode && body.parentNode.style) {\n      body.parentNode.style.backgroundColor = 'transparent';\n      body.parentNode.style.backgroundImage = '';\n    }\n  }\n}\n\nfunction errorCallback(callback) {\n  if (!callback) {\n    return null;\n  }\n  return function(error) {\n    var errorCode = parseInt(error);\n    var QRScannerError = {};\n    switch (errorCode) {\n      case 0:\n        QRScannerError = {\n          name: 'UNEXPECTED_ERROR',\n          code: 0,\n          _message: 'QRScanner experienced an unexpected error.'\n        };\n        break;\n      case 1:\n        QRScannerError = {\n          name: 'CAMERA_ACCESS_DENIED',\n          code: 1,\n          _message: 'The user denied camera access.'\n        };\n        break;\n      case 2:\n        QRScannerError = {\n          name: 'CAMERA_ACCESS_RESTRICTED',\n          code: 2,\n          _message: 'Camera access is restricted.'\n        };\n        break;\n      case 3:\n        QRScannerError = {\n          name: 'BACK_CAMERA_UNAVAILABLE',\n          code: 3,\n          _message: 'The back camera is unavailable.'\n        };\n        break;\n      case 4:\n        QRScannerError = {\n          name: 'FRONT_CAMERA_UNAVAILABLE',\n          code: 4,\n          _message: 'The front camera is unavailable.'\n        };\n        break;\n      case 5:\n        QRScannerError = {\n          name: 'CAMERA_UNAVAILABLE',\n          code: 5,\n          _message: 'The camera is unavailable.'\n        };\n        break;\n      case 6:\n        QRScannerError = {\n          name: 'SCAN_CANCELED',\n          code: 6,\n          _message: 'Scan was canceled.'\n        };\n        break;\n      case 7:\n        QRScannerError = {\n          name: 'LIGHT_UNAVAILABLE',\n          code: 7,\n          _message: 'The device light is unavailable.'\n        };\n        break;\n      case 8:\n        // Open settings is only available on iOS 8.0+.\n        QRScannerError = {\n          name: 'OPEN_SETTINGS_UNAVAILABLE',\n          code: 8,\n          _message: 'The device is unable to open settings.'\n        };\n        break;\n      default:\n        QRScannerError = {\n          name: 'UNEXPECTED_ERROR',\n          code: 0,\n          _message: 'QRScanner returned an invalid error code.'\n        };\n        break;\n    }\n    callback(QRScannerError);\n  };\n}\n\nfunction successCallback(callback) {\n  if (!callback) {\n    return null;\n  }\n  return function(statusDict) {\n    callback(null, convertStatus(statusDict));\n  };\n}\n\nfunction doneCallback(callback, clear) {\n  if (!callback) {\n    return null;\n  }\n  return function(statusDict) {\n    if (clear) {\n      clearBackground();\n    }\n    callback(convertStatus(statusDict));\n  };\n}\n\nreturn {\n  prepare: function(callback) {\n    cordova.exec(successCallback(callback), errorCallback(callback), 'QRScanner', 'prepare', []);\n  },\n  destroy: function(callback) {\n    cordova.exec(doneCallback(callback, true), null, 'QRScanner', 'destroy', []);\n  },\n  scan: function(callback) {\n    if (!callback) {\n      throw new Error('No callback provided to scan method.');\n    }\n    var success = function(result) {\n      callback(null, result);\n    };\n    cordova.exec(success, errorCallback(callback), 'QRScanner', 'scan', []);\n  },\n  cancelScan: function(callback) {\n    cordova.exec(doneCallback(callback), null, 'QRScanner', 'cancelScan', []);\n  },\n  show: function(callback) {\n    cordova.exec(doneCallback(callback, true), null, 'QRScanner', 'show', []);\n  },\n  hide: function(callback) {\n    cordova.exec(doneCallback(callback, true), null, 'QRScanner', 'hide', []);\n  },\n  pausePreview: function(callback) {\n    cordova.exec(doneCallback(callback), null, 'QRScanner', 'pausePreview', []);\n  },\n  resumePreview: function(callback) {\n    cordova.exec(doneCallback(callback), null, 'QRScanner', 'resumePreview', []);\n  },\n  enableLight: function(callback) {\n    cordova.exec(successCallback(callback), errorCallback(callback), 'QRScanner', 'enableLight', []);\n  },\n  disableLight: function(callback) {\n    cordova.exec(successCallback(callback), errorCallback(callback), 'QRScanner', 'disableLight', []);\n  },\n  useCamera: function(index, callback) {\n    cordova.exec(successCallback(callback), errorCallback(callback), 'QRScanner', 'useCamera', [index]);\n  },\n  useFrontCamera: function(callback) {\n    var frontCamera = 1;\n    if (callback) {\n      this.useCamera(frontCamera, callback);\n    } else {\n      cordova.exec(null, null, 'QRScanner', 'useCamera', [frontCamera]);\n    }\n  },\n  useBackCamera: function(callback) {\n    var backCamera = 0;\n    if (callback) {\n      this.useCamera(backCamera, callback);\n    } else {\n      cordova.exec(null, null, 'QRScanner', 'useCamera', [backCamera]);\n    }\n  },\n  openSettings: function(callback) {\n    if (callback) {\n      cordova.exec(successCallback(callback), errorCallback(callback), 'QRScanner', 'openSettings', []);\n    } else {\n      cordova.exec(null, null, 'QRScanner', 'openSettings', []);\n    }\n  },\n  getStatus: function(callback) {\n    if (!callback) {\n      throw new Error('No callback provided to getStatus method.');\n    }\n    cordova.exec(doneCallback(callback), null, 'QRScanner', 'getStatus', []);\n  }\n};\n};\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"!function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,\\\"a\\\",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p=\\\"\\\",e(e.s=19)}([function(t,e,n){\\\"use strict\\\";function i(){this.imagedata=null,this.width=0,this.height=0,this.qrCodeSymbol=null,this.debug=!1,this.callback=null}function r(t,e){return t>=0?t>>e:(t>>e)+(2<<~e)}n.d(e,\\\"b\\\",function(){return s}),e.a=i,e.c=r;var o=n(14),a=n(13),s={};s.sizeOfDataLengthInfo=[[10,9,8,8],[12,11,16,10],[14,13,16,12]],i.prototype.decode=function(t,e){var n=function(){try{this.error=void 0,this.result=this.process(this.imagedata)}catch(t){this.error=t,this.result=void 0}return null!=this.callback&&this.callback(this.error,this.result),this.result}.bind(this);if(void 0!=t&&void 0!=t.width)this.width=t.width,this.height=t.height,this.imagedata={data:e||t.data},this.imagedata.width=t.width,this.imagedata.height=t.height,n();else{if(\\\"undefined\\\"==typeof Image)throw new Error(\\\"This source format is not supported in your environment, you need to pass an image buffer with width and height (see https://github.com/edi9999/jsqrcode/blob/master/test/qrcode.js)\\\");var i=new Image;i.crossOrigin=\\\"Anonymous\\\",i.onload=function(){var t=document.createElement(\\\"canvas\\\"),e=t.getContext(\\\"2d\\\"),r=document.getElementById(\\\"out-canvas\\\");if(null!=r){var o=r.getContext(\\\"2d\\\");o.clearRect(0,0,320,240),o.drawImage(i,0,0,320,240)}t.width=i.width,t.height=i.height,e.drawImage(i,0,0),this.width=i.width,this.height=i.height;try{this.imagedata=e.getImageData(0,0,i.width,i.height)}catch(t){if(this.result=\\\"Cross domain image reading not supported in your browser! Save it to your computer then drag and drop the file!\\\",null!=this.callback)return this.callback(null,this.result)}n()}.bind(this),i.src=t}},i.prototype.decode_utf8=function(t){return decodeURIComponent(escape(t))},i.prototype.process=function(t){for(var e=(new Date).getTime(),n=this.grayScaleToBitmap(this.grayscale(t)),i=new o.a(n),r=i.detect(),s=a.a.decode(r.bits),h=s.DataByte,f=\\\"\\\",w=0;w<h.length;w++)for(var u=0;u<h[w].length;u++)f+=String.fromCharCode(h[w][u]);var l=(new Date).getTime(),c=l-e;return this.debug&&console.log(\\\"QR Code processing time (ms): \\\"+c),{result:this.decode_utf8(f),points:r.points}},i.prototype.getPixel=function(t,e,n){if(t.width<e)throw\\\"point error\\\";if(t.height<n)throw\\\"point error\\\";var i=4*e+n*t.width*4;return(33*t.data[i]+34*t.data[i+1]+33*t.data[i+2])/100},i.prototype.binarize=function(t){for(var e=new Array(this.width*this.height),n=0;n<this.height;n++)for(var i=0;i<this.width;i++){var r=this.getPixel(i,n);e[i+n*this.width]=r<=t}return e},i.prototype.getMiddleBrightnessPerArea=function(t){for(var e=Math.floor(t.width/4),n=Math.floor(t.height/4),i=new Array(4),r=0;r<4;r++){i[r]=new Array(4);for(var o=0;o<4;o++)i[r][o]=[0,0]}for(var a=0;a<4;a++)for(var s=0;s<4;s++){i[s][a][0]=255;for(var h=0;h<n;h++)for(var f=0;f<e;f++){var w=t.data[e*s+f+(n*a+h)*t.width];w<i[s][a][0]&&(i[s][a][0]=w),w>i[s][a][1]&&(i[s][a][1]=w)}}for(var u=new Array(4),l=0;l<4;l++)u[l]=new Array(4);for(var a=0;a<4;a++)for(var s=0;s<4;s++)u[s][a]=Math.floor((i[s][a][0]+i[s][a][1])/2);return u},i.prototype.grayScaleToBitmap=function(t){for(var e=this.getMiddleBrightnessPerArea(t),n=e.length,i=Math.floor(t.width/n),r=Math.floor(t.height/n),o=0;o<n;o++)for(var a=0;a<n;a++)for(var s=0;s<r;s++)for(var h=0;h<i;h++)t.data[i*a+h+(r*o+s)*t.width]=t.data[i*a+h+(r*o+s)*t.width]<e[a][o];return t},i.prototype.grayscale=function(t){for(var e=new Array(t.width*t.height),n=0;n<t.height;n++)for(var i=0;i<t.width;i++){var r=this.getPixel(t,i,n);e[i+n*t.width]=r}return{height:t.height,width:t.width,data:e}}},function(t,e,n){\\\"use strict\\\";function i(t,e){if(e||(e=t),t<1||e<1)throw\\\"Both dimensions must be greater than 0\\\";this.width=t,this.height=e;var n=t>>5;0!=(31&t)&&n++,this.rowSize=n,this.bits=new Array(n*e);for(var i=0;i<this.bits.length;i++)this.bits[i]=0}e.a=i;var r=n(0);Object.defineProperty(i.prototype,\\\"Dimension\\\",{get:function(){if(this.width!=this.height)throw\\\"Can't call getDimension() on a non-square matrix\\\";return this.width}}),i.prototype.get_Renamed=function(t,e){var i=e*this.rowSize+(t>>5);return 0!=(1&n.i(r.c)(this.bits[i],31&t))},i.prototype.set_Renamed=function(t,e){var n=e*this.rowSize+(t>>5);this.bits[n]|=1<<(31&t)},i.prototype.flip=function(t,e){var n=e*this.rowSize+(t>>5);this.bits[n]^=1<<(31&t)},i.prototype.clear=function(){for(var t=this.bits.length,e=0;e<t;e++)this.bits[e]=0},i.prototype.setRegion=function(t,e,n,i){if(e<0||t<0)throw\\\"Left and top must be nonnegative\\\";if(i<1||n<1)throw\\\"Height and width must be at least 1\\\";var r=t+n,o=e+i;if(o>this.height||r>this.width)throw\\\"The region must fit inside the matrix\\\";for(var a=e;a<o;a++)for(var s=a*this.rowSize,h=t;h<r;h++)this.bits[s+(h>>5)]|=1<<(31&h)}},function(t,e,n){\\\"use strict\\\";function i(t){this.errorCorrectionLevel=o.a.forBits(t>>3&3),this.dataMask=7&t}e.a=i;var r=n(0),o=n(15),a=[[21522,0],[20773,1],[24188,2],[23371,3],[17913,4],[16590,5],[20375,6],[19104,7],[30660,8],[29427,9],[32170,10],[30877,11],[26159,12],[25368,13],[27713,14],[26998,15],[5769,16],[5054,17],[7399,18],[6608,19],[1890,20],[597,21],[3340,22],[2107,23],[13663,24],[12392,25],[16177,26],[14854,27],[9396,28],[8579,29],[11994,30],[11245,31]],s=[0,1,1,2,1,2,2,3,1,2,2,3,2,3,3,4];i.prototype.GetHashCode=function(){return this.errorCorrectionLevel.ordinal()<<3|this.dataMask},i.prototype.Equals=function(t){var e=t;return this.errorCorrectionLevel==e.errorCorrectionLevel&&this.dataMask==e.dataMask},i.numBitsDiffering=function(t,e){return t^=e,s[15&t]+s[15&n.i(r.c)(t,4)]+s[15&n.i(r.c)(t,8)]+s[15&n.i(r.c)(t,12)]+s[15&n.i(r.c)(t,16)]+s[15&n.i(r.c)(t,20)]+s[15&n.i(r.c)(t,24)]+s[15&n.i(r.c)(t,28)]},i.decodeFormatInformation=function(t){var e=i.doDecodeFormatInformation(t);return null!=e?e:i.doDecodeFormatInformation(21522^t)},i.doDecodeFormatInformation=function(t){for(var e=4294967295,n=0,r=0;r<a.length;r++){var o=a[r],s=o[0];if(s==t)return new i(o[1]);var h=this.numBitsDiffering(t,s);h<e&&(n=o[1],e=h)}return e<=3?new i(n):null}},function(t,e,n){\\\"use strict\\\";function i(t){this.expTable=new Array(256),this.logTable=new Array(256);for(var e=1,n=0;n<256;n++)this.expTable[n]=e,(e<<=1)>=256&&(e^=t);for(var n=0;n<255;n++)this.logTable[this.expTable[n]]=n;var i=new Array(1);i[0]=0,this.zero=new r.a(this,new Array(i));var o=new Array(1);o[0]=1,this.one=new r.a(this,new Array(o))}e.a=i;var r=n(4);Object.defineProperty(i.prototype,\\\"Zero\\\",{get:function(){return this.zero}}),Object.defineProperty(i.prototype,\\\"One\\\",{get:function(){return this.one}}),i.prototype.buildMonomial=function(t,e){if(t<0)throw\\\"System.ArgumentException\\\";if(0==e)return this.zero;for(var n=new Array(t+1),i=0;i<n.length;i++)n[i]=0;return n[0]=e,new r.a(this,n)},i.prototype.exp=function(t){return this.expTable[t]},i.prototype.log=function(t){if(0==t)throw\\\"System.ArgumentException\\\";return this.logTable[t]},i.prototype.inverse=function(t){if(0==t)throw\\\"System.ArithmeticException\\\";return this.expTable[255-this.logTable[t]]},i.prototype.addOrSubtract=function(t,e){return t^e},i.prototype.multiply=function(t,e){return 0==t||0==e?0:1==t?e:1==e?t:this.expTable[(this.logTable[t]+this.logTable[e])%255]},i.QR_CODE_FIELD=new i(285),i.DATA_MATRIX_FIELD=new i(301)},function(t,e,n){\\\"use strict\\\";function i(t,e){if(null==e||0==e.length)throw\\\"System.ArgumentException\\\";this.field=t;var n=e.length;if(n>1&&0==e[0]){for(var i=1;i<n&&0==e[i];)i++;if(i==n)this.coefficients=t.Zero.coefficients;else{this.coefficients=new Array(n-i);for(var r=0;r<this.coefficients.length;r++)this.coefficients[r]=0;for(var o=0;o<this.coefficients.length;o++)this.coefficients[o]=e[i+o]}}else this.coefficients=e}e.a=i,Object.defineProperty(i.prototype,\\\"Zero\\\",{get:function(){return 0==this.coefficients[0]}}),Object.defineProperty(i.prototype,\\\"Degree\\\",{get:function(){return this.coefficients.length-1}}),i.prototype.getCoefficient=function(t){return this.coefficients[this.coefficients.length-1-t]},i.prototype.evaluateAt=function(t){if(0==t)return this.getCoefficient(0);var e=this.coefficients.length;if(1==t){for(var n=0,i=0;i<e;i++)n=this.field.addOrSubtract(n,this.coefficients[i]);return n}for(var r=this.coefficients[0],i=1;i<e;i++)r=this.field.addOrSubtract(this.field.multiply(t,r),this.coefficients[i]);return r},i.prototype.addOrSubtract=function(t){if(this.field!=t.field)throw\\\"GF256Polys do not have same GF256 field\\\";if(this.Zero)return t;if(t.Zero)return this;var e=this.coefficients,n=t.coefficients;if(e.length>n.length){var r=e;e=n,n=r}for(var o=new Array(n.length),a=n.length-e.length,s=0;s<a;s++)o[s]=n[s];for(var h=a;h<n.length;h++)o[h]=this.field.addOrSubtract(e[h-a],n[h]);return new i(this.field,o)},i.prototype.multiply1=function(t){if(this.field!=t.field)throw\\\"GF256Polys do not have same GF256 field\\\";if(this.Zero||t.Zero)return this.field.Zero;for(var e=this.coefficients,n=e.length,r=t.coefficients,o=r.length,a=new Array(n+o-1),s=0;s<n;s++)for(var h=e[s],f=0;f<o;f++)a[s+f]=this.field.addOrSubtract(a[s+f],this.field.multiply(h,r[f]));return new i(this.field,a)},i.prototype.multiply2=function(t){if(0==t)return this.field.Zero;if(1==t)return this;for(var e=this.coefficients.length,n=new Array(e),r=0;r<e;r++)n[r]=this.field.multiply(this.coefficients[r],t);return new i(this.field,n)},i.prototype.multiplyByMonomial=function(t,e){if(t<0)throw\\\"System.ArgumentException\\\";if(0==e)return this.field.Zero;for(var n=this.coefficients.length,r=new Array(n+t),o=0;o<r.length;o++)r[o]=0;for(var o=0;o<n;o++)r[o]=this.field.multiply(this.coefficients[o],e);return new i(this.field,r)},i.prototype.divide=function(t){if(this.field!=t.field)throw\\\"GF256Polys do not have same GF256 field\\\";if(t.Zero)throw\\\"Divide by 0\\\";for(var e=this.field.Zero,n=this,i=t.getCoefficient(t.Degree),r=this.field.inverse(i);n.Degree>=t.Degree&&!n.Zero;){var o=n.Degree-t.Degree,a=this.field.multiply(n.getCoefficient(n.Degree),r),s=t.multiplyByMonomial(o,a),h=this.field.buildMonomial(o,a);e=e.addOrSubtract(h),n=n.addOrSubtract(s)}return[e,n]}},function(t,e,n){\\\"use strict\\\";function i(t,e){this.count=t,this.dataCodewords=e}function r(t,e,n){this.ecCodewordsPerBlock=t,this.ecBlocks=n?[e,n]:[e]}function o(t,e,n,i,r,o){this.versionNumber=t,this.alignmentPatternCenters=e,this.ecBlocks=[n,i,r,o];for(var a=0,s=n.ecCodewordsPerBlock,h=n.getECBlocks(),f=0;f<h.length;f++){var w=h[f];a+=w.count*(w.dataCodewords+s)}this.totalCodewords=a}e.a=o;var a=n(2),s=n(1);Object.defineProperty(r.prototype,\\\"TotalECCodewords\\\",{get:function(){return this.ecCodewordsPerBlock*this.NumBlocks}}),Object.defineProperty(r.prototype,\\\"NumBlocks\\\",{get:function(){for(var t=0,e=0;e<this.ecBlocks.length;e++)t+=this.ecBlocks[e].length;return t}}),r.prototype.getECBlocks=function(){return this.ecBlocks},Object.defineProperty(o.prototype,\\\"DimensionForVersion\\\",{get:function(){return 17+4*this.versionNumber}}),o.prototype.buildFunctionPattern=function(){var t=this.DimensionForVersion,e=new s.a(t);e.setRegion(0,0,9,9),e.setRegion(t-8,0,8,9),e.setRegion(0,t-8,9,8);for(var n=this.alignmentPatternCenters.length,i=0;i<n;i++)for(var r=this.alignmentPatternCenters[i]-2,o=0;o<n;o++)0==i&&(0==o||o==n-1)||i==n-1&&0==o||e.setRegion(this.alignmentPatternCenters[o]-2,r,5,5);return e.setRegion(6,9,1,t-17),e.setRegion(9,6,t-17,1),this.versionNumber>6&&(e.setRegion(t-11,0,3,6),e.setRegion(0,t-11,6,3)),e},o.prototype.getECBlocksForLevel=function(t){return this.ecBlocks[t.ordinal()]},o.VERSION_DECODE_INFO=[31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017],o.VERSIONS=function(){return[new o(1,[],new r(7,new i(1,19)),new r(10,new i(1,16)),new r(13,new i(1,13)),new r(17,new i(1,9))),new o(2,[6,18],new r(10,new i(1,34)),new r(16,new i(1,28)),new r(22,new i(1,22)),new r(28,new i(1,16))),new o(3,[6,22],new r(15,new i(1,55)),new r(26,new i(1,44)),new r(18,new i(2,17)),new r(22,new i(2,13))),new o(4,[6,26],new r(20,new i(1,80)),new r(18,new i(2,32)),new r(26,new i(2,24)),new r(16,new i(4,9))),new o(5,[6,30],new r(26,new i(1,108)),new r(24,new i(2,43)),new r(18,new i(2,15),new i(2,16)),new r(22,new i(2,11),new i(2,12))),new o(6,[6,34],new r(18,new i(2,68)),new r(16,new i(4,27)),new r(24,new i(4,19)),new r(28,new i(4,15))),new o(7,[6,22,38],new r(20,new i(2,78)),new r(18,new i(4,31)),new r(18,new i(2,14),new i(4,15)),new r(26,new i(4,13),new i(1,14))),new o(8,[6,24,42],new r(24,new i(2,97)),new r(22,new i(2,38),new i(2,39)),new r(22,new i(4,18),new i(2,19)),new r(26,new i(4,14),new i(2,15))),new o(9,[6,26,46],new r(30,new i(2,116)),new r(22,new i(3,36),new i(2,37)),new r(20,new i(4,16),new i(4,17)),new r(24,new i(4,12),new i(4,13))),new o(10,[6,28,50],new r(18,new i(2,68),new i(2,69)),new r(26,new i(4,43),new i(1,44)),new r(24,new i(6,19),new i(2,20)),new r(28,new i(6,15),new i(2,16))),new o(11,[6,30,54],new r(20,new i(4,81)),new r(30,new i(1,50),new i(4,51)),new r(28,new i(4,22),new i(4,23)),new r(24,new i(3,12),new i(8,13))),new o(12,[6,32,58],new r(24,new i(2,92),new i(2,93)),new r(22,new i(6,36),new i(2,37)),new r(26,new i(4,20),new i(6,21)),new r(28,new i(7,14),new i(4,15))),new o(13,[6,34,62],new r(26,new i(4,107)),new r(22,new i(8,37),new i(1,38)),new r(24,new i(8,20),new i(4,21)),new r(22,new i(12,11),new i(4,12))),new o(14,[6,26,46,66],new r(30,new i(3,115),new i(1,116)),new r(24,new i(4,40),new i(5,41)),new r(20,new i(11,16),new i(5,17)),new r(24,new i(11,12),new i(5,13))),new o(15,[6,26,48,70],new r(22,new i(5,87),new i(1,88)),new r(24,new i(5,41),new i(5,42)),new r(30,new i(5,24),new i(7,25)),new r(24,new i(11,12),new i(7,13))),new o(16,[6,26,50,74],new r(24,new i(5,98),new i(1,99)),new r(28,new i(7,45),new i(3,46)),new r(24,new i(15,19),new i(2,20)),new r(30,new i(3,15),new i(13,16))),new o(17,[6,30,54,78],new r(28,new i(1,107),new i(5,108)),new r(28,new i(10,46),new i(1,47)),new r(28,new i(1,22),new i(15,23)),new r(28,new i(2,14),new i(17,15))),new o(18,[6,30,56,82],new r(30,new i(5,120),new i(1,121)),new r(26,new i(9,43),new i(4,44)),new r(28,new i(17,22),new i(1,23)),new r(28,new i(2,14),new i(19,15))),new o(19,[6,30,58,86],new r(28,new i(3,113),new i(4,114)),new r(26,new i(3,44),new i(11,45)),new r(26,new i(17,21),new i(4,22)),new r(26,new i(9,13),new i(16,14))),new o(20,[6,34,62,90],new r(28,new i(3,107),new i(5,108)),new r(26,new i(3,41),new i(13,42)),new r(30,new i(15,24),new i(5,25)),new r(28,new i(15,15),new i(10,16))),new o(21,[6,28,50,72,94],new r(28,new i(4,116),new i(4,117)),new r(26,new i(17,42)),new r(28,new i(17,22),new i(6,23)),new r(30,new i(19,16),new i(6,17))),new o(22,[6,26,50,74,98],new r(28,new i(2,111),new i(7,112)),new r(28,new i(17,46)),new r(30,new i(7,24),new i(16,25)),new r(24,new i(34,13))),new o(23,[6,30,54,74,102],new r(30,new i(4,121),new i(5,122)),new r(28,new i(4,47),new i(14,48)),new r(30,new i(11,24),new i(14,25)),new r(30,new i(16,15),new i(14,16))),new o(24,[6,28,54,80,106],new r(30,new i(6,117),new i(4,118)),new r(28,new i(6,45),new i(14,46)),new r(30,new i(11,24),new i(16,25)),new r(30,new i(30,16),new i(2,17))),new o(25,[6,32,58,84,110],new r(26,new i(8,106),new i(4,107)),new r(28,new i(8,47),new i(13,48)),new r(30,new i(7,24),new i(22,25)),new r(30,new i(22,15),new i(13,16))),new o(26,[6,30,58,86,114],new r(28,new i(10,114),new i(2,115)),new r(28,new i(19,46),new i(4,47)),new r(28,new i(28,22),new i(6,23)),new r(30,new i(33,16),new i(4,17))),new o(27,[6,34,62,90,118],new r(30,new i(8,122),new i(4,123)),new r(28,new i(22,45),new i(3,46)),new r(30,new i(8,23),new i(26,24)),new r(30,new i(12,15),new i(28,16))),new o(28,[6,26,50,74,98,122],new r(30,new i(3,117),new i(10,118)),new r(28,new i(3,45),new i(23,46)),new r(30,new i(4,24),new i(31,25)),new r(30,new i(11,15),new i(31,16))),new o(29,[6,30,54,78,102,126],new r(30,new i(7,116),new i(7,117)),new r(28,new i(21,45),new i(7,46)),new r(30,new i(1,23),new i(37,24)),new r(30,new i(19,15),new i(26,16))),new o(30,[6,26,52,78,104,130],new r(30,new i(5,115),new i(10,116)),new r(28,new i(19,47),new i(10,48)),new r(30,new i(15,24),new i(25,25)),new r(30,new i(23,15),new i(25,16))),new o(31,[6,30,56,82,108,134],new r(30,new i(13,115),new i(3,116)),new r(28,new i(2,46),new i(29,47)),new r(30,new i(42,24),new i(1,25)),new r(30,new i(23,15),new i(28,16))),new o(32,[6,34,60,86,112,138],new r(30,new i(17,115)),new r(28,new i(10,46),new i(23,47)),new r(30,new i(10,24),new i(35,25)),new r(30,new i(19,15),new i(35,16))),new o(33,[6,30,58,86,114,142],new r(30,new i(17,115),new i(1,116)),new r(28,new i(14,46),new i(21,47)),new r(30,new i(29,24),new i(19,25)),new r(30,new i(11,15),new i(46,16))),new o(34,[6,34,62,90,118,146],new r(30,new i(13,115),new i(6,116)),new r(28,new i(14,46),new i(23,47)),new r(30,new i(44,24),new i(7,25)),new r(30,new i(59,16),new i(1,17))),new o(35,[6,30,54,78,102,126,150],new r(30,new i(12,121),new i(7,122)),new r(28,new i(12,47),new i(26,48)),new r(30,new i(39,24),new i(14,25)),new r(30,new i(22,15),new i(41,16))),new o(36,[6,24,50,76,102,128,154],new r(30,new i(6,121),new i(14,122)),new r(28,new i(6,47),new i(34,48)),new r(30,new i(46,24),new i(10,25)),new r(30,new i(2,15),new i(64,16))),new o(37,[6,28,54,80,106,132,158],new r(30,new i(17,122),new i(4,123)),new r(28,new i(29,46),new i(14,47)),new r(30,new i(49,24),new i(10,25)),new r(30,new i(24,15),new i(46,16))),new o(38,[6,32,58,84,110,136,162],new r(30,new i(4,122),new i(18,123)),new r(28,new i(13,46),new i(32,47)),new r(30,new i(48,24),new i(14,25)),new r(30,new i(42,15),new i(32,16))),new o(39,[6,26,54,82,110,138,166],new r(30,new i(20,117),new i(4,118)),new r(28,new i(40,47),new i(7,48)),new r(30,new i(43,24),new i(22,25)),new r(30,new i(10,15),new i(67,16))),new o(40,[6,30,58,86,114,142,170],new r(30,new i(19,118),new i(6,119)),new r(28,new i(18,47),new i(31,48)),new r(30,new i(34,24),new i(34,25)),new r(30,new i(20,15),new i(61,16)))]}(),o.getVersionForNumber=function(t){if(t<1||t>40)throw\\\"ArgumentException\\\";return o.VERSIONS[t-1]},o.getProvisionalVersionForDimension=function(t){if(t%4!=1)throw\\\"Error getProvisionalVersionForDimension\\\";try{return o.getVersionForNumber(t-17>>2)}catch(t){throw\\\"Error getVersionForNumber\\\"}},o.decodeVersionInformation=function(t){for(var e=4294967295,n=0,i=0;i<o.VERSION_DECODE_INFO.length;i++){var r=o.VERSION_DECODE_INFO[i];if(r==t)return this.getVersionForNumber(i+7);var s=a.a.numBitsDiffering(t,r);s<e&&(n=i+7,e=s)}return e<=3?this.getVersionForNumber(n):null}},function(t,e,n){\\\"use strict\\\";Object.defineProperty(e,\\\"__esModule\\\",{value:!0});var i=n(0);e.default=i.a},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,\\\"loaded\\\",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,\\\"id\\\",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){\\\"use strict\\\";function i(t,e,n){this.x=t,this.y=e,this.count=1,this.estimatedModuleSize=n}function r(t,e,n,i,r,o,a){this.image=t,this.possibleCenters=[],this.startX=e,this.startY=n,this.width=i,this.height=r,this.moduleSize=o,this.crossCheckStateCount=[0,0,0],this.resultPointCallback=a}e.a=r,Object.defineProperty(i.prototype,\\\"X\\\",{get:function(){return Math.floor(this.x)}}),Object.defineProperty(i.prototype,\\\"Y\\\",{get:function(){return Math.floor(this.y)}}),i.prototype.incrementCount=function(){this.count++},i.prototype.aboutEquals=function(t,e,n){if(Math.abs(e-this.y)<=t&&Math.abs(n-this.x)<=t){var i=Math.abs(t-this.estimatedModuleSize);return i<=1||i/this.estimatedModuleSize<=1}return!1},r.prototype.centerFromEnd=function(t,e){return e-t[2]-t[1]/2},r.prototype.foundPatternCross=function(t){for(var e=this.moduleSize,n=e/2,i=0;i<3;i++)if(Math.abs(e-t[i])>=n)return!1;return!0},r.prototype.crossCheckVertical=function(t,e,n,i){var r=this.image,o=r.height,a=this.crossCheckStateCount;a[0]=0,a[1]=0,a[2]=0;for(var s=t;s>=0&&r.data[e+s*r.width]&&a[1]<=n;)a[1]++,s--;if(s<0||a[1]>n)return NaN;for(;s>=0&&!r.data[e+s*r.width]&&a[0]<=n;)a[0]++,s--;if(a[0]>n)return NaN;for(s=t+1;s<o&&r.data[e+s*r.width]&&a[1]<=n;)a[1]++,s++;if(s==o||a[1]>n)return NaN;for(;s<o&&!r.data[e+s*r.width]&&a[2]<=n;)a[2]++,s++;if(a[2]>n)return NaN;var h=a[0]+a[1]+a[2];return 5*Math.abs(h-i)>=2*i?NaN:this.foundPatternCross(a)?this.centerFromEnd(a,s):NaN},r.prototype.handlePossibleCenter=function(t,e,n){var r=t[0]+t[1]+t[2],o=this.centerFromEnd(t,n),a=this.crossCheckVertical(e,Math.floor(o),2*t[1],r);if(!isNaN(a)){for(var s=(t[0]+t[1]+t[2])/3,h=this.possibleCenters.length,f=0;f<h;f++){if(this.possibleCenters[f].aboutEquals(s,a,o))return new i(o,a,s)}var w=new i(o,a,s);this.possibleCenters.push(w),null!=this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(w)}return null},r.prototype.find=function(){for(var t=this.image,e=this.startX,n=this.height,i=e+this.width,r=this.startY+(n>>1),o=[0,0,0],a=0;a<n;a++){var s=r+(0==(1&a)?a+1>>1:-(a+1>>1));o[0]=0,o[1]=0,o[2]=0;for(var h=e;h<i&&!t.data[h+t.width*s];)h++;for(var f=0;h<i;){if(t.data[h+s*t.width])if(1==f)o[f]++;else if(2==f){if(this.foundPatternCross(o)){var w=this.handlePossibleCenter(o,s,h);if(null!=w)return w}o[0]=o[2],o[1]=1,o[2]=0,f=1}else o[++f]++;else 1==f&&f++,o[f]++;h++}if(this.foundPatternCross(o)){var w=this.handlePossibleCenter(o,s,i);if(null!=w)return w}}if(0!=this.possibleCenters.length)return this.possibleCenters[0];throw\\\"Couldn't find enough alignment patterns\\\"}},function(t,e,n){\\\"use strict\\\";function i(t){var e=t.Dimension;if(e<21||1!=(3&e))throw\\\"Error BitMatrixParser\\\";this.bitMatrix=t,this.parsedVersion=null,this.parsedFormatInfo=null}e.a=i;var r=n(2),o=n(5),a=n(12);i.prototype.copyBit=function(t,e,n){return this.bitMatrix.get_Renamed(t,e)?n<<1|1:n<<1},i.prototype.readFormatInformation=function(){if(null!=this.parsedFormatInfo)return this.parsedFormatInfo;for(var t=0,e=0;e<6;e++)t=this.copyBit(e,8,t);t=this.copyBit(7,8,t),t=this.copyBit(8,8,t),t=this.copyBit(8,7,t);for(var n=5;n>=0;n--)t=this.copyBit(8,n,t);if(this.parsedFormatInfo=r.a.decodeFormatInformation(t),null!=this.parsedFormatInfo)return this.parsedFormatInfo;var i=this.bitMatrix.Dimension;t=0;for(var o=i-8,e=i-1;e>=o;e--)t=this.copyBit(e,8,t);for(var n=i-7;n<i;n++)t=this.copyBit(8,n,t);if(this.parsedFormatInfo=r.a.decodeFormatInformation(t),null!=this.parsedFormatInfo)return this.parsedFormatInfo;throw\\\"Error readFormatInformation\\\"},i.prototype.readVersion=function(){if(null!=this.parsedVersion)return this.parsedVersion;var t=this.bitMatrix.Dimension,e=t-17>>2;if(e<=6)return o.a.getVersionForNumber(e);for(var n=0,i=t-11,r=5;r>=0;r--)for(var a=t-9;a>=i;a--)n=this.copyBit(a,r,n);if(this.parsedVersion=o.a.decodeVersionInformation(n),null!=this.parsedVersion&&this.parsedVersion.DimensionForVersion==t)return this.parsedVersion;n=0;for(var a=5;a>=0;a--)for(var r=t-9;r>=i;r--)n=this.copyBit(a,r,n);if(this.parsedVersion=o.a.decodeVersionInformation(n),null!=this.parsedVersion&&this.parsedVersion.DimensionForVersion==t)return this.parsedVersion;throw\\\"Error readVersion\\\"},i.prototype.readCodewords=function(){var t=this.readFormatInformation(),e=this.readVersion(),n=a.a.forReference(t.dataMask),i=this.bitMatrix.Dimension;n.unmaskBitMatrix(this.bitMatrix,i);for(var r=e.buildFunctionPattern(),o=!0,s=new Array(e.totalCodewords),h=0,f=0,w=0,u=i-1;u>0;u-=2){6==u&&u--;for(var l=0;l<i;l++)for(var c=o?i-1-l:l,d=0;d<2;d++)r.get_Renamed(u-d,c)||(w++,f<<=1,this.bitMatrix.get_Renamed(u-d,c)&&(f|=1),8==w&&(s[h++]=f,w=0,f=0));o^=!0}if(h!=e.totalCodewords)throw\\\"Error readCodewords\\\";return s}},function(t,e,n){\\\"use strict\\\";function i(t,e){this.numDataCodewords=t,this.codewords=e}e.a=i,i.getDataBlocks=function(t,e,n){if(t.length!=e.totalCodewords)throw\\\"ArgumentException\\\";for(var r=e.getECBlocksForLevel(n),o=0,a=r.getECBlocks(),s=0;s<a.length;s++)o+=a[s].count;for(var h=new Array(o),f=0,w=0;w<a.length;w++)for(var u=a[w],s=0;s<u.count;s++){var l=u.dataCodewords,c=r.ecCodewordsPerBlock+l;h[f++]=new i(l,new Array(c))}for(var d=h[0].codewords.length,p=h.length-1;p>=0;){if(h[p].codewords.length==d)break;p--}p++;for(var g=d-r.ecCodewordsPerBlock,v=0,s=0;s<g;s++)for(var w=0;w<f;w++)h[w].codewords[s]=t[v++];for(var w=p;w<f;w++)h[w].codewords[g]=t[v++];for(var m=h[0].codewords.length,s=g;s<m;s++)for(var w=0;w<f;w++){var b=w<p?s:s+1;h[w].codewords[b]=t[v++]}return h}},function(t,e,n){\\\"use strict\\\";function i(t,e,n){this.blockPointer=0,this.bitPointer=7,this.dataLength=0,this.blocks=t,this.numErrorCorrectionCode=n,e<=9?this.dataLengthMode=0:e>=10&&e<=26?this.dataLengthMode=1:e>=27&&e<=40&&(this.dataLengthMode=2)}e.a=i;var r=n(0);i.prototype.getNextBits=function(t){var e=0;if(t<this.bitPointer+1){for(var n=0,i=0;i<t;i++)n+=1<<i;return n<<=this.bitPointer-t+1,e=(this.blocks[this.blockPointer]&n)>>this.bitPointer-t+1,this.bitPointer-=t,e}if(t<this.bitPointer+1+8){for(var r=0,i=0;i<this.bitPointer+1;i++)r+=1<<i;return e=(this.blocks[this.blockPointer]&r)<<t-(this.bitPointer+1),this.blockPointer++,e+=this.blocks[this.blockPointer]>>8-(t-(this.bitPointer+1)),this.bitPointer=this.bitPointer-t%8,this.bitPointer<0&&(this.bitPointer=8+this.bitPointer),e}if(t<this.bitPointer+1+16){for(var r=0,o=0,i=0;i<this.bitPointer+1;i++)r+=1<<i;var a=(this.blocks[this.blockPointer]&r)<<t-(this.bitPointer+1);this.blockPointer++;var s=this.blocks[this.blockPointer]<<t-(this.bitPointer+1+8);this.blockPointer++;for(var i=0;i<t-(this.bitPointer+1+8);i++)o+=1<<i;o<<=8-(t-(this.bitPointer+1+8));return e=a+s+((this.blocks[this.blockPointer]&o)>>8-(t-(this.bitPointer+1+8))),this.bitPointer=this.bitPointer-(t-8)%8,this.bitPointer<0&&(this.bitPointer=8+this.bitPointer),e}return 0},i.prototype.NextMode=function(){return this.blockPointer>this.blocks.length-this.numErrorCorrectionCode-2?0:this.getNextBits(4)},i.prototype.getDataLength=function(t){for(var e=0;;){if(t>>e==1)break;e++}return this.getNextBits(r.b.sizeOfDataLengthInfo[this.dataLengthMode][e])},i.prototype.getRomanAndFigureString=function(t){var e=t,n=0,i=\\\"\\\",r=[\\\"0\\\",\\\"1\\\",\\\"2\\\",\\\"3\\\",\\\"4\\\",\\\"5\\\",\\\"6\\\",\\\"7\\\",\\\"8\\\",\\\"9\\\",\\\"A\\\",\\\"B\\\",\\\"C\\\",\\\"D\\\",\\\"E\\\",\\\"F\\\",\\\"G\\\",\\\"H\\\",\\\"I\\\",\\\"J\\\",\\\"K\\\",\\\"L\\\",\\\"M\\\",\\\"N\\\",\\\"O\\\",\\\"P\\\",\\\"Q\\\",\\\"R\\\",\\\"S\\\",\\\"T\\\",\\\"U\\\",\\\"V\\\",\\\"W\\\",\\\"X\\\",\\\"Y\\\",\\\"Z\\\",\\\" \\\",\\\"$\\\",\\\"%\\\",\\\"*\\\",\\\"+\\\",\\\"-\\\",\\\".\\\",\\\"/\\\",\\\":\\\"];do{if(e>1){n=this.getNextBits(11);var o=Math.floor(n/45),a=n%45;i+=r[o],i+=r[a],e-=2}else 1==e&&(n=this.getNextBits(6),i+=r[n],e-=1)}while(e>0);return i},i.prototype.getFigureString=function(t){var e=t,n=0,i=\\\"\\\";do{e>=3?(n=this.getNextBits(10),n<100&&(i+=\\\"0\\\"),n<10&&(i+=\\\"0\\\"),e-=3):2==e?(n=this.getNextBits(7),n<10&&(i+=\\\"0\\\"),e-=2):1==e&&(n=this.getNextBits(4),e-=1),i+=n}while(e>0);return i},i.prototype.get8bitByteArray=function(t){var e=t,n=0,i=[];do{n=this.getNextBits(8),i.push(n),e--}while(e>0);return i},i.prototype.getKanjiString=function(t){var e=t,n=0,i=\\\"\\\";do{n=this.getNextBits(13);var r=n%192,o=n/192,a=(o<<8)+r,s=0;s=a+33088<=40956?a+33088:a+49472,i+=String.fromCharCode(s),e--}while(e>0);return i},Object.defineProperty(i.prototype,\\\"DataByte\\\",{get:function(){for(var t=[];;){var e=this.NextMode();if(0==e){if(t.length>0)break;throw\\\"Empty data block\\\"}if(1!=e&&2!=e&&4!=e&&8!=e&&7!=e)throw\\\"Invalid mode: \\\"+e+\\\" in (block:\\\"+this.blockPointer+\\\" bit:\\\"+this.bitPointer+\\\")\\\";var n=this.getDataLength(e);if(n<1)throw\\\"Invalid data length: \\\"+n;switch(e){case 1:for(var i=this.getFigureString(n),r=new Array(i.length),o=0;o<i.length;o++)r[o]=i.charCodeAt(o);t.push(r);break;case 2:for(var i=this.getRomanAndFigureString(n),r=new Array(i.length),o=0;o<i.length;o++)r[o]=i.charCodeAt(o);t.push(r);break;case 4:var a=this.get8bitByteArray(n);t.push(a);break;case 8:var i=this.getKanjiString(n);t.push(i)}}return t}})},function(t,e,n){\\\"use strict\\\";function i(){this.unmaskBitMatrix=function(t,e){for(var n=0;n<e;n++)for(var i=0;i<e;i++)this.isMasked(n,i)&&t.flip(i,n)},this.isMasked=function(t,e){return 0==(t+e&1)}}function r(){this.unmaskBitMatrix=function(t,e){for(var n=0;n<e;n++)for(var i=0;i<e;i++)this.isMasked(n,i)&&t.flip(i,n)},this.isMasked=function(t,e){return 0==(1&t)}}function o(){this.unmaskBitMatrix=function(t,e){for(var n=0;n<e;n++)for(var i=0;i<e;i++)this.isMasked(n,i)&&t.flip(i,n)},this.isMasked=function(t,e){return e%3==0}}function a(){this.unmaskBitMatrix=function(t,e){for(var n=0;n<e;n++)for(var i=0;i<e;i++)this.isMasked(n,i)&&t.flip(i,n)},this.isMasked=function(t,e){return(t+e)%3==0}}function s(){this.unmaskBitMatrix=function(t,e){for(var n=0;n<e;n++)for(var i=0;i<e;i++)this.isMasked(n,i)&&t.flip(i,n)},this.isMasked=function(t,e){return 0==(n.i(u.c)(t,1)+e/3&1)}}function h(){this.unmaskBitMatrix=function(t,e){for(var n=0;n<e;n++)for(var i=0;i<e;i++)this.isMasked(n,i)&&t.flip(i,n)},this.isMasked=function(t,e){var n=t*e;return(1&n)+n%3==0}}function f(){this.unmaskBitMatrix=function(t,e){for(var n=0;n<e;n++)for(var i=0;i<e;i++)this.isMasked(n,i)&&t.flip(i,n)},this.isMasked=function(t,e){var n=t*e;return 0==((1&n)+n%3&1)}}function w(){this.unmaskBitMatrix=function(t,e){for(var n=0;n<e;n++)for(var i=0;i<e;i++)this.isMasked(n,i)&&t.flip(i,n)},this.isMasked=function(t,e){return 0==((t+e&1)+t*e%3&1)}}var u=n(0),l={};l.forReference=function(t){if(t<0||t>7)throw\\\"System.ArgumentException\\\";return l.DATA_MASKS[t]},l.DATA_MASKS=[new i,new r,new o,new a,new s,new h,new f,new w],e.a=l},function(t,e,n){\\\"use strict\\\";var i=n(18),r=n(3),o=n(9),a=n(10),s=n(11),h={};h.rsDecoder=new i.a(r.a.QR_CODE_FIELD),h.correctErrors=function(t,e){for(var n=t.length,i=new Array(n),r=0;r<n;r++)i[r]=255&t[r];var o=t.length-e;try{h.rsDecoder.decode(i,o)}catch(t){throw t}for(var r=0;r<e;r++)t[r]=i[r]},h.decode=function(t){for(var e=new o.a(t),n=e.readVersion(),i=e.readFormatInformation().errorCorrectionLevel,r=e.readCodewords(),f=a.a.getDataBlocks(r,n,i),w=0,u=0;u<f.length;u++)w+=f[u].numDataCodewords;for(var l=new Array(w),c=0,d=0;d<f.length;d++){var p=f[d],g=p.codewords,v=p.numDataCodewords;h.correctErrors(g,v);for(var u=0;u<v;u++)l[c++]=g[u]}return new s.a(l,n.versionNumber,i.bits)},e.a=h},function(t,e,n){\\\"use strict\\\";function i(t,e,n,i,r,o,a,s,h){this.a11=t,this.a12=i,this.a13=a,this.a21=e,this.a22=r,this.a23=s,this.a31=n,this.a32=o,this.a33=h}function r(t,e){this.bits=t,this.points=e}function o(t){this.image=t,this.resultPointCallback=null}e.a=o;var a=n(5),s=n(8),h=n(17),f=n(16);i.prototype.transformPoints1=function(t){for(var e=t.length,n=this.a11,i=this.a12,r=this.a13,o=this.a21,a=this.a22,s=this.a23,h=this.a31,f=this.a32,w=this.a33,u=0;u<e;u+=2){var l=t[u],c=t[u+1],d=r*l+s*c+w;t[u]=(n*l+o*c+h)/d,t[u+1]=(i*l+a*c+f)/d}},i.prototype.transformPoints2=function(t,e){for(var n=t.length,i=0;i<n;i++){var r=t[i],o=e[i],a=this.a13*r+this.a23*o+this.a33;t[i]=(this.a11*r+this.a21*o+this.a31)/a,e[i]=(this.a12*r+this.a22*o+this.a32)/a}},i.prototype.buildAdjoint=function(){return new i(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)},i.prototype.times=function(t){return new i(this.a11*t.a11+this.a21*t.a12+this.a31*t.a13,this.a11*t.a21+this.a21*t.a22+this.a31*t.a23,this.a11*t.a31+this.a21*t.a32+this.a31*t.a33,this.a12*t.a11+this.a22*t.a12+this.a32*t.a13,this.a12*t.a21+this.a22*t.a22+this.a32*t.a23,this.a12*t.a31+this.a22*t.a32+this.a32*t.a33,this.a13*t.a11+this.a23*t.a12+this.a33*t.a13,this.a13*t.a21+this.a23*t.a22+this.a33*t.a23,this.a13*t.a31+this.a23*t.a32+this.a33*t.a33)},i.quadrilateralToQuadrilateral=function(t,e,n,i,r,o,a,s,h,f,w,u,l,c,d,p){var g=this.quadrilateralToSquare(t,e,n,i,r,o,a,s);return this.squareToQuadrilateral(h,f,w,u,l,c,d,p).times(g)},i.squareToQuadrilateral=function(t,e,n,r,o,a,s,h){var f=h-a,w=e-r+a-h;if(0==f&&0==w)return new i(n-t,o-n,t,r-e,a-r,e,0,0,1);var u=n-o,l=s-o,c=t-n+o-s,d=r-a,p=u*f-l*d,g=(c*f-l*w)/p,v=(u*w-c*d)/p;return new i(n-t+g*n,s-t+v*s,t,r-e+g*r,h-e+v*h,e,g,v,1)},i.quadrilateralToSquare=function(t,e,n,i,r,o,a,s){return this.squareToQuadrilateral(t,e,n,i,r,o,a,s).buildAdjoint()},o.prototype.sizeOfBlackWhiteBlackRun=function(t,e,n,i){var r=Math.abs(i-e)>Math.abs(n-t);if(r){var o=t;t=e,e=o,o=n,n=i,i=o}for(var a=Math.abs(n-t),s=Math.abs(i-e),h=-a>>1,f=e<i?1:-1,w=t<n?1:-1,u=0,l=t,c=e;l!=n;l+=w){var d=r?c:l,p=r?l:c;if(1==u?this.image.data[d+p*this.image.width]&&u++:this.image.data[d+p*this.image.width]||u++,3==u){var g=l-t,v=c-e;return Math.sqrt(g*g+v*v)}if((h+=s)>0){if(c==i)break;c+=f,h-=a}}var m=n-t,b=i-e;return Math.sqrt(m*m+b*b)},o.prototype.sizeOfBlackWhiteBlackRunBothWays=function(t,e,n,i){var r=this.sizeOfBlackWhiteBlackRun(t,e,n,i),o=1,a=t-(n-t);a<0?(o=t/(t-a),a=0):a>=this.image.width&&(o=(this.image.width-1-t)/(a-t),a=this.image.width-1);var s=Math.floor(e-(i-e)*o);return o=1,s<0?(o=e/(e-s),s=0):s>=this.image.height&&(o=(this.image.height-1-e)/(s-e),s=this.image.height-1),a=Math.floor(t+(a-t)*o),(r+=this.sizeOfBlackWhiteBlackRun(t,e,a,s))-1},o.prototype.calculateModuleSizeOneWay=function(t,e){var n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.X),Math.floor(t.Y),Math.floor(e.X),Math.floor(e.Y)),i=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.X),Math.floor(e.Y),Math.floor(t.X),Math.floor(t.Y));return isNaN(n)?i/7:isNaN(i)?n/7:(n+i)/14},o.prototype.calculateModuleSize=function(t,e,n){return(this.calculateModuleSizeOneWay(t,e)+this.calculateModuleSizeOneWay(t,n))/2},o.prototype.distance=function(t,e){var n=t.X-e.X,i=t.Y-e.Y;return Math.sqrt(n*n+i*i)},o.prototype.computeDimension=function(t,e,n,i){var r=Math.round(this.distance(t,e)/i),o=Math.round(this.distance(t,n)/i),a=7+(r+o>>1);switch(3&a){case 0:a++;break;case 2:a--;break;case 3:throw\\\"Error\\\"}return a},o.prototype.findAlignmentInRegion=function(t,e,n,i){var r=Math.floor(i*t),o=Math.max(0,e-r),a=Math.min(this.image.width-1,e+r);if(a-o<3*t)throw\\\"Error\\\";var h=Math.max(0,n-r),f=Math.min(this.image.height-1,n+r);return new s.a(this.image,o,h,a-o,f-h,t,this.resultPointCallback).find()},o.prototype.createTransform=function(t,e,n,r,o){var a,s,h,f,w=o-3.5;return null!=r?(a=r.X,s=r.Y,h=f=w-3):(a=e.X-t.X+n.X,s=e.Y-t.Y+n.Y,h=f=w),i.quadrilateralToQuadrilateral(3.5,3.5,w,3.5,h,f,3.5,w,t.X,t.Y,e.X,e.Y,a,s,n.X,n.Y)},o.prototype.sampleGrid=function(t,e,n){return h.a.sampleGrid3(t,n,e)},o.prototype.processFinderPatternInfo=function(t){var e=t.topLeft,n=t.topRight,i=t.bottomLeft,o=this.calculateModuleSize(e,n,i);if(o<1)throw\\\"Error\\\";var s=this.computeDimension(e,n,i,o),h=a.a.getProvisionalVersionForDimension(s),f=h.DimensionForVersion-7,w=null;if(h.alignmentPatternCenters.length>0)for(var u=n.X-e.X+i.X,l=n.Y-e.Y+i.Y,c=1-3/f,d=Math.floor(e.X+c*(u-e.X)),p=Math.floor(e.Y+c*(l-e.Y)),g=4;g<=16;g<<=1){w=this.findAlignmentInRegion(o,d,p,g);break}var v,m=this.createTransform(e,n,i,w,s),b=this.sampleGrid(this.image,m,s);return v=null==w?[i,e,n]:[i,e,n,w],new r(b,v)},o.prototype.detect=function(){var t=(new f.a).findFinderPattern(this.image);return this.processFinderPatternInfo(t)}},function(t,e,n){\\\"use strict\\\";function i(t,e,n){this.ordinal_Renamed_Field=t,this.bits=e,this.name=n}e.a=i,i.prototype.ordinal=function(){return this.ordinal_Renamed_Field},i.forBits=function(t){if(t<0||t>=r.length)throw\\\"ArgumentException\\\";return r[t]};var r=[new i(1,0,\\\"M\\\"),new i(0,1,\\\"L\\\"),new i(3,2,\\\"H\\\"),new i(2,3,\\\"Q\\\")]},function(t,e,n){\\\"use strict\\\";function i(t){function e(t,e){var n=t.X-e.X,i=t.Y-e.Y;return Math.sqrt(n*n+i*i)}var n,i,r,o=e(t[0],t[1]),a=e(t[1],t[2]),s=e(t[0],t[2]);if(a>=o&&a>=s?(i=t[0],n=t[1],r=t[2]):s>=a&&s>=o?(i=t[1],n=t[0],r=t[2]):(i=t[2],n=t[0],r=t[1]),function(t,e,n){var i=e.x,r=e.y;return(n.x-i)*(t.y-r)-(n.y-r)*(t.x-i)}(n,i,r)<0){var h=n;n=r,r=h}t[0]=n,t[1]=i,t[2]=r}function r(t,e,n){this.x=t,this.y=e,this.count=1,this.estimatedModuleSize=n}function o(t){this.bottomLeft=t[0],this.topLeft=t[1],this.topRight=t[2]}function a(){this.image=null,this.possibleCenters=[],this.hasSkipped=!1,this.crossCheckStateCount=[0,0,0,0,0],this.resultPointCallback=null}e.a=a;Object.defineProperty(r.prototype,\\\"X\\\",{get:function(){return this.x}}),Object.defineProperty(r.prototype,\\\"Y\\\",{get:function(){return this.y}}),r.prototype.incrementCount=function(){this.count++},r.prototype.aboutEquals=function(t,e,n){if(Math.abs(e-this.y)<=t&&Math.abs(n-this.x)<=t){var i=Math.abs(t-this.estimatedModuleSize);return i<=1||i/this.estimatedModuleSize<=1}return!1},Object.defineProperty(a.prototype,\\\"CrossCheckStateCount\\\",{get:function(){return this.crossCheckStateCount[0]=0,this.crossCheckStateCount[1]=0,this.crossCheckStateCount[2]=0,this.crossCheckStateCount[3]=0,this.crossCheckStateCount[4]=0,this.crossCheckStateCount}}),a.prototype.foundPatternCross=function(t){for(var e=0,n=0;n<5;n++){var i=t[n];if(0==i)return!1;e+=i}if(e<7)return!1;var r=Math.floor((e<<8)/7),o=Math.floor(r/2);return Math.abs(r-(t[0]<<8))<o&&Math.abs(r-(t[1]<<8))<o&&Math.abs(3*r-(t[2]<<8))<3*o&&Math.abs(r-(t[3]<<8))<o&&Math.abs(r-(t[4]<<8))<o},a.prototype.centerFromEnd=function(t,e){return e-t[4]-t[3]-t[2]/2},a.prototype.crossCheckVertical=function(t,e,n,i){for(var r=this.image,o=r.height,a=this.CrossCheckStateCount,s=t;s>=0&&r.data[e+s*r.width];)a[2]++,s--;if(s<0)return NaN;for(;s>=0&&!r.data[e+s*r.width]&&a[1]<=n;)a[1]++,s--;if(s<0||a[1]>n)return NaN;for(;s>=0&&r.data[e+s*r.width]&&a[0]<=n;)a[0]++,s--;if(a[0]>n)return NaN;for(s=t+1;s<o&&r.data[e+s*r.width];)a[2]++,s++;if(s==o)return NaN;for(;s<o&&!r.data[e+s*r.width]&&a[3]<n;)a[3]++,s++;if(s==o||a[3]>=n)return NaN;for(;s<o&&r.data[e+s*r.width]&&a[4]<n;)a[4]++,s++;if(a[4]>=n)return NaN;var h=a[0]+a[1]+a[2]+a[3]+a[4];return 5*Math.abs(h-i)>=2*i?NaN:this.foundPatternCross(a)?this.centerFromEnd(a,s):NaN},a.prototype.crossCheckHorizontal=function(t,e,n,i){for(var r=this.image,o=r.width,a=this.CrossCheckStateCount,s=t;s>=0&&r.data[s+e*r.width];)a[2]++,s--;if(s<0)return NaN;for(;s>=0&&!r.data[s+e*r.width]&&a[1]<=n;)a[1]++,s--;if(s<0||a[1]>n)return NaN;for(;s>=0&&r.data[s+e*r.width]&&a[0]<=n;)a[0]++,s--;if(a[0]>n)return NaN;for(s=t+1;s<o&&r.data[s+e*r.width];)a[2]++,s++;if(s==o)return NaN;for(;s<o&&!r.data[s+e*r.width]&&a[3]<n;)a[3]++,s++;if(s==o||a[3]>=n)return NaN;for(;s<o&&r.data[s+e*r.width]&&a[4]<n;)a[4]++,s++;if(a[4]>=n)return NaN;var h=a[0]+a[1]+a[2]+a[3]+a[4];return 5*Math.abs(h-i)>=i?NaN:this.foundPatternCross(a)?this.centerFromEnd(a,s):NaN},a.prototype.handlePossibleCenter=function(t,e,n){var i=t[0]+t[1]+t[2]+t[3]+t[4],o=this.centerFromEnd(t,n),a=this.crossCheckVertical(e,Math.floor(o),t[2],i);if(!isNaN(a)&&(o=this.crossCheckHorizontal(Math.floor(o),Math.floor(a),t[2],i),!isNaN(o))){for(var s=i/7,h=!1,f=this.possibleCenters.length,w=0;w<f;w++){var u=this.possibleCenters[w];if(u.aboutEquals(s,a,o)){u.incrementCount(),h=!0;break}}if(!h){var l=new r(o,a,s);this.possibleCenters.push(l),null!=this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(l)}return!0}return!1},a.prototype.selectBestPatterns=function(){var t=this.possibleCenters.length;if(t<3)throw\\\"Couldn't find enough finder patterns:\\\"+t+\\\" patterns found\\\";if(t>3){for(var e=0,n=0,i=0;i<t;i++){var r=this.possibleCenters[i].estimatedModuleSize;e+=r,n+=r*r}var o=e/t;this.possibleCenters.sort(function(t,e){var n=Math.abs(e.estimatedModuleSize-o),i=Math.abs(t.estimatedModuleSize-o);return n<i?-1:n==i?0:1});for(var a=Math.sqrt(n/t-o*o),s=Math.max(.2*o,a),i=this.possibleCenters-1;i>=0;i--){var h=this.possibleCenters[i];Math.abs(h.estimatedModuleSize-o)>s&&this.possibleCenters.splice(i,1)}}return this.possibleCenters.length>3&&this.possibleCenters.sort(function(t,e){return t.count>e.count?-1:t.count<e.count?1:0}),[this.possibleCenters[0],this.possibleCenters[1],this.possibleCenters[2]]},a.prototype.findRowSkip=function(){var t=this.possibleCenters.length;if(t<=1)return 0;for(var e=null,n=0;n<t;n++){var i=this.possibleCenters[n];if(i.count>=2){if(null!=e)return this.hasSkipped=!0,Math.floor((Math.abs(e.X-i.X)-Math.abs(e.Y-i.Y))/2);e=i}}return 0},a.prototype.haveMultiplyConfirmedCenters=function(){for(var t=0,e=0,n=this.possibleCenters.length,i=0;i<n;i++){var r=this.possibleCenters[i];r.count>=2&&(t++,e+=r.estimatedModuleSize)}if(t<3)return!1;for(var o=e/n,a=0,i=0;i<n;i++)r=this.possibleCenters[i],a+=Math.abs(r.estimatedModuleSize-o);return a<=.05*e},a.prototype.findFinderPattern=function(t){this.image=t;var e=t.height,n=t.width,r=Math.floor(3*e/228);r<3&&(r=3);for(var a=!1,s=new Array(5),h=r-1;h<e&&!a;h+=r){s[0]=0,s[1]=0,s[2]=0,s[3]=0,s[4]=0;for(var f=0,w=0;w<n;w++)if(t.data[w+h*t.width])1==(1&f)&&f++,s[f]++;else if(0==(1&f))if(4==f)if(this.foundPatternCross(s)){var u=this.handlePossibleCenter(s,h,w);if(u)if(r=2,this.hasSkipped)a=this.haveMultiplyConfirmedCenters();else{var l=this.findRowSkip();l>s[2]&&(h+=l-s[2]-r,w=n-1)}else{do{w++}while(w<n&&!t.data[w+h*t.width]);w--}f=0,s[0]=0,s[1]=0,s[2]=0,s[3]=0,s[4]=0}else s[0]=s[2],s[1]=s[3],s[2]=s[4],s[3]=1,s[4]=0,f=3;else s[++f]++;else s[f]++;if(this.foundPatternCross(s)){var u=this.handlePossibleCenter(s,h,n);u&&(r=s[0],this.hasSkipped&&(a=this.haveMultiplyConfirmedCenters()))}}var c=this.selectBestPatterns();return i(c),new o(c)}},function(t,e,n){\\\"use strict\\\";var i=n(1),r={};r.checkAndNudgePoints=function(t,e){for(var n=t.width,i=t.height,r=!0,o=0;o<e.length&&r;o+=2){var a=Math.floor(e[o]),s=Math.floor(e[o+1]);if(a<-1||a>n||s<-1||s>i)throw\\\"Error.checkAndNudgePoints \\\";r=!1,-1==a?(e[o]=0,r=!0):a==n&&(e[o]=n-1,r=!0),-1==s?(e[o+1]=0,r=!0):s==i&&(e[o+1]=i-1,r=!0)}r=!0;for(var o=e.length-2;o>=0&&r;o-=2){var a=Math.floor(e[o]),s=Math.floor(e[o+1]);if(a<-1||a>n||s<-1||s>i)throw\\\"Error.checkAndNudgePoints \\\";r=!1,-1==a?(e[o]=0,r=!0):a==n&&(e[o]=n-1,r=!0),-1==s?(e[o+1]=0,r=!0):s==i&&(e[o+1]=i-1,r=!0)}},r.sampleGrid3=function(t,e,n){for(var o=new i.a(e),a=new Array(e<<1),s=0;s<e;s++){for(var h=a.length,f=s+.5,w=0;w<h;w+=2)a[w]=.5+(w>>1),a[w+1]=f;n.transformPoints1(a),r.checkAndNudgePoints(t,a);try{for(var w=0;w<h;w+=2){t.data[Math.floor(a[w])+t.width*Math.floor(a[w+1])]&&o.set_Renamed(w>>1,s)}}catch(t){throw\\\"Error.checkAndNudgePoints\\\"}}return o},e.a=r},function(t,e,n){\\\"use strict\\\";function i(t){this.field=t}e.a=i;var r=n(3),o=n(4);i.prototype.decode=function(t,e){for(var n=new o.a(this.field,t),i=new Array(e),a=0;a<i.length;a++)i[a]=0;for(var s=!0,a=0;a<e;a++){var h=n.evaluateAt(this.field.exp(a));i[i.length-1-a]=h,0!=h&&(s=!1)}if(!s)for(var f=new o.a(this.field,i),w=this.runEuclideanAlgorithm(this.field.buildMonomial(e,1),f,e),u=w[0],l=w[1],c=this.findErrorLocations(u),d=this.findErrorMagnitudes(l,c,!1),a=0;a<c.length;a++){var p=t.length-1-this.field.log(c[a]);if(p<0)throw\\\"ReedSolomonException Bad error location\\\";t[p]=r.a.prototype.addOrSubtract(t[p],d[a])}},i.prototype.runEuclideanAlgorithm=function(t,e,n){if(t.Degree<e.Degree){var i=t;t=e,e=i}for(var r=t,o=e,a=this.field.One,s=this.field.Zero,h=this.field.Zero,f=this.field.One;o.Degree>=Math.floor(n/2);){var w=r,u=a,l=h;if(r=o,a=s,h=f,r.Zero)throw\\\"r_{i-1} was zero\\\";o=w;for(var c=this.field.Zero,d=r.getCoefficient(r.Degree),p=this.field.inverse(d);o.Degree>=r.Degree&&!o.Zero;){var g=o.Degree-r.Degree,v=this.field.multiply(o.getCoefficient(o.Degree),p);c=c.addOrSubtract(this.field.buildMonomial(g,v)),o=o.addOrSubtract(r.multiplyByMonomial(g,v))}s=c.multiply1(a).addOrSubtract(u),f=c.multiply1(h).addOrSubtract(l)}var m=f.getCoefficient(0);if(0==m)throw\\\"ReedSolomonException sigmaTilde(0) was zero\\\";var b=this.field.inverse(m);return[f.multiply2(b),o.multiply2(b)]},i.prototype.findErrorLocations=function(t){var e=t.Degree;if(1==e)return new Array(t.getCoefficient(1));for(var n=new Array(e),i=0,r=1;r<256&&i<e;r++)0==t.evaluateAt(r)&&(n[i]=this.field.inverse(r),i++);if(i!=e)throw\\\"Error locator degree does not match number of roots\\\";return n},i.prototype.findErrorMagnitudes=function(t,e,n){for(var i=e.length,o=new Array(i),a=0;a<i;a++){for(var s=this.field.inverse(e[a]),h=1,f=0;f<i;f++)a!=f&&(h=this.field.multiply(h,r.a.prototype.addOrSubtract(1,this.field.multiply(e[f],s))));o[a]=this.field.multiply(t.evaluateAt(s),this.field.inverse(h)),n&&(o[a]=this.field.multiply(o[a],s))}return o}},function(t,e,n){(function(t){var e=n(6).default,i=new e;i.callback=function(t,e){postMessage({result:e,err:t})},onmessage=function(t){var e=t.data;i.decode(e)}}).call(e,n(7)(t))}]);\"\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n /* eslint-env node */\n\n\n// SDP helpers.\nvar SDPUtils = {};\n\n// Generate an alphanumeric identifier for cname or mids.\n// TODO: use UUIDs instead? https://gist.github.com/jed/982883\nSDPUtils.generateIdentifier = function() {\n  return Math.random().toString(36).substr(2, 10);\n};\n\n// The RTCP CNAME used by all peerconnections from the same JS.\nSDPUtils.localCName = SDPUtils.generateIdentifier();\n\n// Splits SDP into lines, dealing with both CRLF and LF.\nSDPUtils.splitLines = function(blob) {\n  return blob.trim().split('\\n').map(function(line) {\n    return line.trim();\n  });\n};\n// Splits SDP into sessionpart and mediasections. Ensures CRLF.\nSDPUtils.splitSections = function(blob) {\n  var parts = blob.split('\\nm=');\n  return parts.map(function(part, index) {\n    return (index > 0 ? 'm=' + part : part).trim() + '\\r\\n';\n  });\n};\n\n// Returns lines that start with a certain prefix.\nSDPUtils.matchPrefix = function(blob, prefix) {\n  return SDPUtils.splitLines(blob).filter(function(line) {\n    return line.indexOf(prefix) === 0;\n  });\n};\n\n// Parses an ICE candidate line. Sample input:\n// candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8\n// rport 55996\"\nSDPUtils.parseCandidate = function(line) {\n  var parts;\n  // Parse both variants.\n  if (line.indexOf('a=candidate:') === 0) {\n    parts = line.substring(12).split(' ');\n  } else {\n    parts = line.substring(10).split(' ');\n  }\n\n  var candidate = {\n    foundation: parts[0],\n    component: parts[1],\n    protocol: parts[2].toLowerCase(),\n    priority: parseInt(parts[3], 10),\n    ip: parts[4],\n    port: parseInt(parts[5], 10),\n    // skip parts[6] == 'typ'\n    type: parts[7]\n  };\n\n  for (var i = 8; i < parts.length; i += 2) {\n    switch (parts[i]) {\n      case 'raddr':\n        candidate.relatedAddress = parts[i + 1];\n        break;\n      case 'rport':\n        candidate.relatedPort = parseInt(parts[i + 1], 10);\n        break;\n      case 'tcptype':\n        candidate.tcpType = parts[i + 1];\n        break;\n      default: // extension handling, in particular ufrag\n        candidate[parts[i]] = parts[i + 1];\n        break;\n    }\n  }\n  return candidate;\n};\n\n// Translates a candidate object into SDP candidate attribute.\nSDPUtils.writeCandidate = function(candidate) {\n  var sdp = [];\n  sdp.push(candidate.foundation);\n  sdp.push(candidate.component);\n  sdp.push(candidate.protocol.toUpperCase());\n  sdp.push(candidate.priority);\n  sdp.push(candidate.ip);\n  sdp.push(candidate.port);\n\n  var type = candidate.type;\n  sdp.push('typ');\n  sdp.push(type);\n  if (type !== 'host' && candidate.relatedAddress &&\n      candidate.relatedPort) {\n    sdp.push('raddr');\n    sdp.push(candidate.relatedAddress); // was: relAddr\n    sdp.push('rport');\n    sdp.push(candidate.relatedPort); // was: relPort\n  }\n  if (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {\n    sdp.push('tcptype');\n    sdp.push(candidate.tcpType);\n  }\n  return 'candidate:' + sdp.join(' ');\n};\n\n// Parses an ice-options line, returns an array of option tags.\n// a=ice-options:foo bar\nSDPUtils.parseIceOptions = function(line) {\n  return line.substr(14).split(' ');\n}\n\n// Parses an rtpmap line, returns RTCRtpCoddecParameters. Sample input:\n// a=rtpmap:111 opus/48000/2\nSDPUtils.parseRtpMap = function(line) {\n  var parts = line.substr(9).split(' ');\n  var parsed = {\n    payloadType: parseInt(parts.shift(), 10) // was: id\n  };\n\n  parts = parts[0].split('/');\n\n  parsed.name = parts[0];\n  parsed.clockRate = parseInt(parts[1], 10); // was: clockrate\n  // was: channels\n  parsed.numChannels = parts.length === 3 ? parseInt(parts[2], 10) : 1;\n  return parsed;\n};\n\n// Generate an a=rtpmap line from RTCRtpCodecCapability or\n// RTCRtpCodecParameters.\nSDPUtils.writeRtpMap = function(codec) {\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  return 'a=rtpmap:' + pt + ' ' + codec.name + '/' + codec.clockRate +\n      (codec.numChannels !== 1 ? '/' + codec.numChannels : '') + '\\r\\n';\n};\n\n// Parses an a=extmap line (headerextension from RFC 5285). Sample input:\n// a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n// a=extmap:2/sendonly urn:ietf:params:rtp-hdrext:toffset\nSDPUtils.parseExtmap = function(line) {\n  var parts = line.substr(9).split(' ');\n  return {\n    id: parseInt(parts[0], 10),\n    direction: parts[0].indexOf('/') > 0 ? parts[0].split('/')[1] : 'sendrecv',\n    uri: parts[1]\n  };\n};\n\n// Generates a=extmap line from RTCRtpHeaderExtensionParameters or\n// RTCRtpHeaderExtension.\nSDPUtils.writeExtmap = function(headerExtension) {\n  return 'a=extmap:' + (headerExtension.id || headerExtension.preferredId) +\n      (headerExtension.direction && headerExtension.direction !== 'sendrecv'\n          ? '/' + headerExtension.direction\n          : '') +\n      ' ' + headerExtension.uri + '\\r\\n';\n};\n\n// Parses an ftmp line, returns dictionary. Sample input:\n// a=fmtp:96 vbr=on;cng=on\n// Also deals with vbr=on; cng=on\nSDPUtils.parseFmtp = function(line) {\n  var parsed = {};\n  var kv;\n  var parts = line.substr(line.indexOf(' ') + 1).split(';');\n  for (var j = 0; j < parts.length; j++) {\n    kv = parts[j].trim().split('=');\n    parsed[kv[0].trim()] = kv[1];\n  }\n  return parsed;\n};\n\n// Generates an a=ftmp line from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeFmtp = function(codec) {\n  var line = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.parameters && Object.keys(codec.parameters).length) {\n    var params = [];\n    Object.keys(codec.parameters).forEach(function(param) {\n      params.push(param + '=' + codec.parameters[param]);\n    });\n    line += 'a=fmtp:' + pt + ' ' + params.join(';') + '\\r\\n';\n  }\n  return line;\n};\n\n// Parses an rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:\n// a=rtcp-fb:98 nack rpsi\nSDPUtils.parseRtcpFb = function(line) {\n  var parts = line.substr(line.indexOf(' ') + 1).split(' ');\n  return {\n    type: parts.shift(),\n    parameter: parts.join(' ')\n  };\n};\n// Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeRtcpFb = function(codec) {\n  var lines = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.rtcpFeedback && codec.rtcpFeedback.length) {\n    // FIXME: special handling for trr-int?\n    codec.rtcpFeedback.forEach(function(fb) {\n      lines += 'a=rtcp-fb:' + pt + ' ' + fb.type +\n      (fb.parameter && fb.parameter.length ? ' ' + fb.parameter : '') +\n          '\\r\\n';\n    });\n  }\n  return lines;\n};\n\n// Parses an RFC 5576 ssrc media attribute. Sample input:\n// a=ssrc:3735928559 cname:something\nSDPUtils.parseSsrcMedia = function(line) {\n  var sp = line.indexOf(' ');\n  var parts = {\n    ssrc: parseInt(line.substr(7, sp - 7), 10)\n  };\n  var colon = line.indexOf(':', sp);\n  if (colon > -1) {\n    parts.attribute = line.substr(sp + 1, colon - sp - 1);\n    parts.value = line.substr(colon + 1);\n  } else {\n    parts.attribute = line.substr(sp + 1);\n  }\n  return parts;\n};\n\n// Extracts the MID (RFC 5888) from a media section.\n// returns the MID or undefined if no mid line was found.\nSDPUtils.getMid = function(mediaSection) {\n  var mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:')[0];\n  if (mid) {\n    return mid.substr(6);\n  }\n}\n\nSDPUtils.parseFingerprint = function(line) {\n  var parts = line.substr(14).split(' ');\n  return {\n    algorithm: parts[0].toLowerCase(), // algorithm is case-sensitive in Edge.\n    value: parts[1]\n  };\n};\n\n// Extracts DTLS parameters from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the fingerprint line as input. See also getIceParameters.\nSDPUtils.getDtlsParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n      'a=fingerprint:');\n  // Note: a=setup line is ignored since we use the 'auto' role.\n  // Note2: 'algorithm' is not case sensitive except in Edge.\n  return {\n    role: 'auto',\n    fingerprints: lines.map(SDPUtils.parseFingerprint)\n  };\n};\n\n// Serializes DTLS parameters to SDP.\nSDPUtils.writeDtlsParameters = function(params, setupType) {\n  var sdp = 'a=setup:' + setupType + '\\r\\n';\n  params.fingerprints.forEach(function(fp) {\n    sdp += 'a=fingerprint:' + fp.algorithm + ' ' + fp.value + '\\r\\n';\n  });\n  return sdp;\n};\n// Parses ICE information from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the ice-ufrag and ice-pwd lines as input.\nSDPUtils.getIceParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  // Search in session part, too.\n  lines = lines.concat(SDPUtils.splitLines(sessionpart));\n  var iceParameters = {\n    usernameFragment: lines.filter(function(line) {\n      return line.indexOf('a=ice-ufrag:') === 0;\n    })[0].substr(12),\n    password: lines.filter(function(line) {\n      return line.indexOf('a=ice-pwd:') === 0;\n    })[0].substr(10)\n  };\n  return iceParameters;\n};\n\n// Serializes ICE parameters to SDP.\nSDPUtils.writeIceParameters = function(params) {\n  return 'a=ice-ufrag:' + params.usernameFragment + '\\r\\n' +\n      'a=ice-pwd:' + params.password + '\\r\\n';\n};\n\n// Parses the SDP media section and returns RTCRtpParameters.\nSDPUtils.parseRtpParameters = function(mediaSection) {\n  var description = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: [],\n    rtcp: []\n  };\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  for (var i = 3; i < mline.length; i++) { // find all codecs from mline[3..]\n    var pt = mline[i];\n    var rtpmapline = SDPUtils.matchPrefix(\n        mediaSection, 'a=rtpmap:' + pt + ' ')[0];\n    if (rtpmapline) {\n      var codec = SDPUtils.parseRtpMap(rtpmapline);\n      var fmtps = SDPUtils.matchPrefix(\n          mediaSection, 'a=fmtp:' + pt + ' ');\n      // Only the first a=fmtp:<pt> is considered.\n      codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};\n      codec.rtcpFeedback = SDPUtils.matchPrefix(\n          mediaSection, 'a=rtcp-fb:' + pt + ' ')\n        .map(SDPUtils.parseRtcpFb);\n      description.codecs.push(codec);\n      // parse FEC mechanisms from rtpmap lines.\n      switch (codec.name.toUpperCase()) {\n        case 'RED':\n        case 'ULPFEC':\n          description.fecMechanisms.push(codec.name.toUpperCase());\n          break;\n        default: // only RED and ULPFEC are recognized as FEC mechanisms.\n          break;\n      }\n    }\n  }\n  SDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach(function(line) {\n    description.headerExtensions.push(SDPUtils.parseExtmap(line));\n  });\n  // FIXME: parse rtcp.\n  return description;\n};\n\n// Generates parts of the SDP media section describing the capabilities /\n// parameters.\nSDPUtils.writeRtpDescription = function(kind, caps) {\n  var sdp = '';\n\n  // Build the mline.\n  sdp += 'm=' + kind + ' ';\n  sdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.\n  sdp += ' UDP/TLS/RTP/SAVPF ';\n  sdp += caps.codecs.map(function(codec) {\n    if (codec.preferredPayloadType !== undefined) {\n      return codec.preferredPayloadType;\n    }\n    return codec.payloadType;\n  }).join(' ') + '\\r\\n';\n\n  sdp += 'c=IN IP4 0.0.0.0\\r\\n';\n  sdp += 'a=rtcp:9 IN IP4 0.0.0.0\\r\\n';\n\n  // Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.\n  caps.codecs.forEach(function(codec) {\n    sdp += SDPUtils.writeRtpMap(codec);\n    sdp += SDPUtils.writeFmtp(codec);\n    sdp += SDPUtils.writeRtcpFb(codec);\n  });\n  var maxptime = 0;\n  caps.codecs.forEach(function(codec) {\n    if (codec.maxptime > maxptime) {\n      maxptime = codec.maxptime;\n    }\n  });\n  if (maxptime > 0) {\n    sdp += 'a=maxptime:' + maxptime + '\\r\\n';\n  }\n  sdp += 'a=rtcp-mux\\r\\n';\n\n  caps.headerExtensions.forEach(function(extension) {\n    sdp += SDPUtils.writeExtmap(extension);\n  });\n  // FIXME: write fecMechanisms.\n  return sdp;\n};\n\n// Parses the SDP media section and returns an array of\n// RTCRtpEncodingParameters.\nSDPUtils.parseRtpEncodingParameters = function(mediaSection) {\n  var encodingParameters = [];\n  var description = SDPUtils.parseRtpParameters(mediaSection);\n  var hasRed = description.fecMechanisms.indexOf('RED') !== -1;\n  var hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;\n\n  // filter a=ssrc:... cname:, ignore PlanB-msid\n  var ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n  .map(function(line) {\n    return SDPUtils.parseSsrcMedia(line);\n  })\n  .filter(function(parts) {\n    return parts.attribute === 'cname';\n  });\n  var primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;\n  var secondarySsrc;\n\n  var flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID')\n  .map(function(line) {\n    var parts = line.split(' ');\n    parts.shift();\n    return parts.map(function(part) {\n      return parseInt(part, 10);\n    });\n  });\n  if (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {\n    secondarySsrc = flows[0][1];\n  }\n\n  description.codecs.forEach(function(codec) {\n    if (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {\n      var encParam = {\n        ssrc: primarySsrc,\n        codecPayloadType: parseInt(codec.parameters.apt, 10),\n        rtx: {\n          ssrc: secondarySsrc\n        }\n      };\n      encodingParameters.push(encParam);\n      if (hasRed) {\n        encParam = JSON.parse(JSON.stringify(encParam));\n        encParam.fec = {\n          ssrc: secondarySsrc,\n          mechanism: hasUlpfec ? 'red+ulpfec' : 'red'\n        };\n        encodingParameters.push(encParam);\n      }\n    }\n  });\n  if (encodingParameters.length === 0 && primarySsrc) {\n    encodingParameters.push({\n      ssrc: primarySsrc\n    });\n  }\n\n  // we support both b=AS and b=TIAS but interpret AS as TIAS.\n  var bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');\n  if (bandwidth.length) {\n    if (bandwidth[0].indexOf('b=TIAS:') === 0) {\n      bandwidth = parseInt(bandwidth[0].substr(7), 10);\n    } else if (bandwidth[0].indexOf('b=AS:') === 0) {\n      bandwidth = parseInt(bandwidth[0].substr(5), 10);\n    }\n    encodingParameters.forEach(function(params) {\n      params.maxBitrate = bandwidth;\n    });\n  }\n  return encodingParameters;\n};\n\n// parses http://draft.ortc.org/#rtcrtcpparameters*\nSDPUtils.parseRtcpParameters = function(mediaSection) {\n  var rtcpParameters = {};\n\n  var cname;\n  // Gets the first SSRC. Note that with RTX there might be multiple\n  // SSRCs.\n  var remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n      .map(function(line) {\n        return SDPUtils.parseSsrcMedia(line);\n      })\n      .filter(function(obj) {\n        return obj.attribute === 'cname';\n      })[0];\n  if (remoteSsrc) {\n    rtcpParameters.cname = remoteSsrc.value;\n    rtcpParameters.ssrc = remoteSsrc.ssrc;\n  }\n\n  // Edge uses the compound attribute instead of reducedSize\n  // compound is !reducedSize\n  var rsize = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-rsize');\n  rtcpParameters.reducedSize = rsize.length > 0;\n  rtcpParameters.compound = rsize.length === 0;\n\n  // parses the rtcp-mux attrіbute.\n  // Note that Edge does not support unmuxed RTCP.\n  var mux = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-mux');\n  rtcpParameters.mux = mux.length > 0;\n\n  return rtcpParameters;\n};\n\n// parses either a=msid: or a=ssrc:... msid lines and returns\n// the id of the MediaStream and MediaStreamTrack.\nSDPUtils.parseMsid = function(mediaSection) {\n  var parts;\n  var spec = SDPUtils.matchPrefix(mediaSection, 'a=msid:');\n  if (spec.length === 1) {\n    parts = spec[0].substr(7).split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n  var planB = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n  .map(function(line) {\n    return SDPUtils.parseSsrcMedia(line);\n  })\n  .filter(function(parts) {\n    return parts.attribute === 'msid';\n  });\n  if (planB.length > 0) {\n    parts = planB[0].value.split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n};\n\nSDPUtils.writeSessionBoilerplate = function() {\n  // FIXME: sess-id should be an NTP timestamp.\n  return 'v=0\\r\\n' +\n      'o=thisisadapterortc 8169639915646943137 2 IN IP4 127.0.0.1\\r\\n' +\n      's=-\\r\\n' +\n      't=0 0\\r\\n';\n};\n\nSDPUtils.writeMediaSection = function(transceiver, caps, type, stream) {\n  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\n\n  // Map ICE parameters (ufrag, pwd) to SDP.\n  sdp += SDPUtils.writeIceParameters(\n      transceiver.iceGatherer.getLocalParameters());\n\n  // Map DTLS parameters to SDP.\n  sdp += SDPUtils.writeDtlsParameters(\n      transceiver.dtlsTransport.getLocalParameters(),\n      type === 'offer' ? 'actpass' : 'active');\n\n  sdp += 'a=mid:' + transceiver.mid + '\\r\\n';\n\n  if (transceiver.direction) {\n    sdp += 'a=' + transceiver.direction + '\\r\\n';\n  } else if (transceiver.rtpSender && transceiver.rtpReceiver) {\n    sdp += 'a=sendrecv\\r\\n';\n  } else if (transceiver.rtpSender) {\n    sdp += 'a=sendonly\\r\\n';\n  } else if (transceiver.rtpReceiver) {\n    sdp += 'a=recvonly\\r\\n';\n  } else {\n    sdp += 'a=inactive\\r\\n';\n  }\n\n  if (transceiver.rtpSender) {\n    // spec.\n    var msid = 'msid:' + stream.id + ' ' +\n        transceiver.rtpSender.track.id + '\\r\\n';\n    sdp += 'a=' + msid;\n\n    // for Chrome.\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n        ' ' + msid;\n    if (transceiver.sendEncodingParameters[0].rtx) {\n      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n          ' ' + msid;\n      sdp += 'a=ssrc-group:FID ' +\n          transceiver.sendEncodingParameters[0].ssrc + ' ' +\n          transceiver.sendEncodingParameters[0].rtx.ssrc +\n          '\\r\\n';\n    }\n  }\n  // FIXME: this should be written by writeRtpDescription.\n  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n      ' cname:' + SDPUtils.localCName + '\\r\\n';\n  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n        ' cname:' + SDPUtils.localCName + '\\r\\n';\n  }\n  return sdp;\n};\n\n// Gets the direction from the mediaSection or the sessionpart.\nSDPUtils.getDirection = function(mediaSection, sessionpart) {\n  // Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.\n  var lines = SDPUtils.splitLines(mediaSection);\n  for (var i = 0; i < lines.length; i++) {\n    switch (lines[i]) {\n      case 'a=sendrecv':\n      case 'a=sendonly':\n      case 'a=recvonly':\n      case 'a=inactive':\n        return lines[i].substr(2);\n      default:\n        // FIXME: What should happen here?\n    }\n  }\n  if (sessionpart) {\n    return SDPUtils.getDirection(sessionpart);\n  }\n  return 'sendrecv';\n};\n\nSDPUtils.getKind = function(mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  return mline[0].substr(2);\n};\n\nSDPUtils.isRejected = function(mediaSection) {\n  return mediaSection.split(' ', 2)[1] === '0';\n};\n\n// Expose public methods.\nmodule.exports = SDPUtils;\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n\n\n\n// Shimming starts here.\n(function() {\n  // Utils.\n  var utils = __webpack_require__(0);\n  var logging = utils.log;\n  var browserDetails = utils.browserDetails;\n  // Export to the adapter global object visible in the browser.\n  module.exports.browserDetails = browserDetails;\n  module.exports.extractVersion = utils.extractVersion;\n  module.exports.disableLog = utils.disableLog;\n\n  // Uncomment the line below if you want logging to occur, including logging\n  // for the switch statement below. Can also be turned on in the browser via\n  // adapter.disableLog(false), but then logging from the switch statement below\n  // will not appear.\n  // require('./utils').disableLog(false);\n\n  // Browser shims.\n  var chromeShim = __webpack_require__(6) || null;\n  var edgeShim = __webpack_require__(8) || null;\n  var firefoxShim = __webpack_require__(11) || null;\n  var safariShim = __webpack_require__(13) || null;\n\n  // Shim browser if found.\n  switch (browserDetails.browser) {\n    case 'chrome':\n      if (!chromeShim || !chromeShim.shimPeerConnection) {\n        logging('Chrome shim is not included in this adapter release.');\n        return;\n      }\n      logging('adapter.js shimming chrome.');\n      // Export to the adapter global object visible in the browser.\n      module.exports.browserShim = chromeShim;\n\n      chromeShim.shimGetUserMedia();\n      chromeShim.shimMediaStream();\n      utils.shimCreateObjectURL();\n      chromeShim.shimSourceObject();\n      chromeShim.shimPeerConnection();\n      chromeShim.shimOnTrack();\n      chromeShim.shimGetSendersWithDtmf();\n      break;\n    case 'firefox':\n      if (!firefoxShim || !firefoxShim.shimPeerConnection) {\n        logging('Firefox shim is not included in this adapter release.');\n        return;\n      }\n      logging('adapter.js shimming firefox.');\n      // Export to the adapter global object visible in the browser.\n      module.exports.browserShim = firefoxShim;\n\n      firefoxShim.shimGetUserMedia();\n      utils.shimCreateObjectURL();\n      firefoxShim.shimSourceObject();\n      firefoxShim.shimPeerConnection();\n      firefoxShim.shimOnTrack();\n      break;\n    case 'edge':\n      if (!edgeShim || !edgeShim.shimPeerConnection) {\n        logging('MS edge shim is not included in this adapter release.');\n        return;\n      }\n      logging('adapter.js shimming edge.');\n      // Export to the adapter global object visible in the browser.\n      module.exports.browserShim = edgeShim;\n\n      edgeShim.shimGetUserMedia();\n      utils.shimCreateObjectURL();\n      edgeShim.shimPeerConnection();\n      edgeShim.shimReplaceTrack();\n      break;\n    case 'safari':\n      if (!safariShim) {\n        logging('Safari shim is not included in this adapter release.');\n        return;\n      }\n      logging('adapter.js shimming safari.');\n      // Export to the adapter global object visible in the browser.\n      module.exports.browserShim = safariShim;\n\n      safariShim.shimCallbacksAPI();\n      safariShim.shimAddStream();\n      safariShim.shimOnAddStream();\n      safariShim.shimGetUserMedia();\n      break;\n    default:\n      logging('Unsupported browser!');\n  }\n})();\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n\nvar logging = __webpack_require__(0).log;\nvar browserDetails = __webpack_require__(0).browserDetails;\n\nvar chromeShim = {\n  shimMediaStream: function() {\n    window.MediaStream = window.MediaStream || window.webkitMediaStream;\n  },\n\n  shimOnTrack: function() {\n    if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in\n        window.RTCPeerConnection.prototype)) {\n      Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n        get: function() {\n          return this._ontrack;\n        },\n        set: function(f) {\n          var self = this;\n          if (this._ontrack) {\n            this.removeEventListener('track', this._ontrack);\n            this.removeEventListener('addstream', this._ontrackpoly);\n          }\n          this.addEventListener('track', this._ontrack = f);\n          this.addEventListener('addstream', this._ontrackpoly = function(e) {\n            // onaddstream does not fire when a track is added to an existing\n            // stream. But stream.onaddtrack is implemented so we use that.\n            e.stream.addEventListener('addtrack', function(te) {\n              var receiver;\n              if (RTCPeerConnection.prototype.getReceivers) {\n                receiver = self.getReceivers().find(function(r) {\n                  return r.track.id === te.track.id;\n                });\n              } else {\n                receiver = {track: te.track};\n              }\n\n              var event = new Event('track');\n              event.track = te.track;\n              event.receiver = receiver;\n              event.streams = [e.stream];\n              self.dispatchEvent(event);\n            });\n            e.stream.getTracks().forEach(function(track) {\n              var receiver;\n              if (RTCPeerConnection.prototype.getReceivers) {\n                receiver = self.getReceivers().find(function(r) {\n                  return r.track.id === track.id;\n                });\n              } else {\n                receiver = {track: track};\n              }\n              var event = new Event('track');\n              event.track = track;\n              event.receiver = receiver;\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            }.bind(this));\n          }.bind(this));\n        }\n      });\n    }\n  },\n\n  shimGetSendersWithDtmf: function() {\n    if (typeof window === 'object' && window.RTCPeerConnection &&\n        !('getSenders' in RTCPeerConnection.prototype) &&\n        'createDTMFSender' in RTCPeerConnection.prototype) {\n      RTCPeerConnection.prototype.getSenders = function() {\n        return this._senders || [];\n      };\n      var origAddStream = RTCPeerConnection.prototype.addStream;\n      var origRemoveStream = RTCPeerConnection.prototype.removeStream;\n\n      if (!RTCPeerConnection.prototype.addTrack) {\n        RTCPeerConnection.prototype.addTrack = function(track, stream) {\n          var pc = this;\n          if (pc.signalingState === 'closed') {\n            throw new DOMException(\n              'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n              'InvalidStateError');\n          }\n          var streams = [].slice.call(arguments, 1);\n          if (streams.length !== 1 ||\n              !streams[0].getTracks().find(function(t) {\n                return t === track;\n              })) {\n            // this is not fully correct but all we can manage without\n            // [[associated MediaStreams]] internal slot.\n            throw new DOMException(\n              'The adapter.js addTrack polyfill only supports a single ' +\n              ' stream which is associated with the specified track.',\n              'NotSupportedError');\n          }\n\n          pc._senders = pc._senders || [];\n          var alreadyExists = pc._senders.find(function(t) {\n            return t.track === track;\n          });\n          if (alreadyExists) {\n            throw new DOMException('Track already exists.',\n                'InvalidAccessError');\n          }\n\n          pc._streams = pc._streams || {};\n          var oldStream = pc._streams[stream.id];\n          if (oldStream) {\n            oldStream.addTrack(track);\n            pc.removeStream(oldStream);\n            pc.addStream(oldStream);\n          } else {\n            var newStream = new MediaStream([track]);\n            pc._streams[stream.id] = newStream;\n            pc.addStream(newStream);\n          }\n\n          var sender = {\n            track: track,\n            get dtmf() {\n              if (this._dtmf === undefined) {\n                if (track.kind === 'audio') {\n                  this._dtmf = pc.createDTMFSender(track);\n                } else {\n                  this._dtmf = null;\n                }\n              }\n              return this._dtmf;\n            }\n          };\n          pc._senders.push(sender);\n          return sender;\n        };\n      }\n      RTCPeerConnection.prototype.addStream = function(stream) {\n        var pc = this;\n        pc._senders = pc._senders || [];\n        origAddStream.apply(pc, [stream]);\n        stream.getTracks().forEach(function(track) {\n          pc._senders.push({\n            track: track,\n            get dtmf() {\n              if (this._dtmf === undefined) {\n                if (track.kind === 'audio') {\n                  this._dtmf = pc.createDTMFSender(track);\n                } else {\n                  this._dtmf = null;\n                }\n              }\n              return this._dtmf;\n            }\n          });\n        });\n      };\n\n      RTCPeerConnection.prototype.removeStream = function(stream) {\n        var pc = this;\n        pc._senders = pc._senders || [];\n        origRemoveStream.apply(pc, [stream]);\n        stream.getTracks().forEach(function(track) {\n          var sender = pc._senders.find(function(s) {\n            return s.track === track;\n          });\n          if (sender) {\n            pc._senders.splice(pc._senders.indexOf(sender), 1); // remove sender\n          }\n        });\n      };\n    }\n  },\n\n  shimSourceObject: function() {\n    if (typeof window === 'object') {\n      if (window.HTMLMediaElement &&\n        !('srcObject' in window.HTMLMediaElement.prototype)) {\n        // Shim the srcObject property, once, when HTMLMediaElement is found.\n        Object.defineProperty(window.HTMLMediaElement.prototype, 'srcObject', {\n          get: function() {\n            return this._srcObject;\n          },\n          set: function(stream) {\n            var self = this;\n            // Use _srcObject as a private property for this shim\n            this._srcObject = stream;\n            if (this.src) {\n              URL.revokeObjectURL(this.src);\n            }\n\n            if (!stream) {\n              this.src = '';\n              return undefined;\n            }\n            this.src = URL.createObjectURL(stream);\n            // We need to recreate the blob url when a track is added or\n            // removed. Doing it manually since we want to avoid a recursion.\n            stream.addEventListener('addtrack', function() {\n              if (self.src) {\n                URL.revokeObjectURL(self.src);\n              }\n              self.src = URL.createObjectURL(stream);\n            });\n            stream.addEventListener('removetrack', function() {\n              if (self.src) {\n                URL.revokeObjectURL(self.src);\n              }\n              self.src = URL.createObjectURL(stream);\n            });\n          }\n        });\n      }\n    }\n  },\n\n  shimPeerConnection: function() {\n    // The RTCPeerConnection object.\n    if (!window.RTCPeerConnection) {\n      window.RTCPeerConnection = function(pcConfig, pcConstraints) {\n        // Translate iceTransportPolicy to iceTransports,\n        // see https://code.google.com/p/webrtc/issues/detail?id=4869\n        // this was fixed in M56 along with unprefixing RTCPeerConnection.\n        logging('PeerConnection');\n        if (pcConfig && pcConfig.iceTransportPolicy) {\n          pcConfig.iceTransports = pcConfig.iceTransportPolicy;\n        }\n\n        return new webkitRTCPeerConnection(pcConfig, pcConstraints);\n      };\n      window.RTCPeerConnection.prototype = webkitRTCPeerConnection.prototype;\n      // wrap static methods. Currently just generateCertificate.\n      if (webkitRTCPeerConnection.generateCertificate) {\n        Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n          get: function() {\n            return webkitRTCPeerConnection.generateCertificate;\n          }\n        });\n      }\n    } else {\n      // migrate from non-spec RTCIceServer.url to RTCIceServer.urls\n      var OrigPeerConnection = RTCPeerConnection;\n      window.RTCPeerConnection = function(pcConfig, pcConstraints) {\n        if (pcConfig && pcConfig.iceServers) {\n          var newIceServers = [];\n          for (var i = 0; i < pcConfig.iceServers.length; i++) {\n            var server = pcConfig.iceServers[i];\n            if (!server.hasOwnProperty('urls') &&\n                server.hasOwnProperty('url')) {\n              console.warn('RTCIceServer.url is deprecated! Use urls instead.');\n              server = JSON.parse(JSON.stringify(server));\n              server.urls = server.url;\n              newIceServers.push(server);\n            } else {\n              newIceServers.push(pcConfig.iceServers[i]);\n            }\n          }\n          pcConfig.iceServers = newIceServers;\n        }\n        return new OrigPeerConnection(pcConfig, pcConstraints);\n      };\n      window.RTCPeerConnection.prototype = OrigPeerConnection.prototype;\n      // wrap static methods. Currently just generateCertificate.\n      Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n        get: function() {\n          return OrigPeerConnection.generateCertificate;\n        }\n      });\n    }\n\n    var origGetStats = RTCPeerConnection.prototype.getStats;\n    RTCPeerConnection.prototype.getStats = function(selector,\n        successCallback, errorCallback) {\n      var self = this;\n      var args = arguments;\n\n      // If selector is a function then we are in the old style stats so just\n      // pass back the original getStats format to avoid breaking old users.\n      if (arguments.length > 0 && typeof selector === 'function') {\n        return origGetStats.apply(this, arguments);\n      }\n\n      // When spec-style getStats is supported, return those when called with\n      // either no arguments or the selector argument is null.\n      if (origGetStats.length === 0 && (arguments.length === 0 ||\n          typeof arguments[0] !== 'function')) {\n        return origGetStats.apply(this, []);\n      }\n\n      var fixChromeStats_ = function(response) {\n        var standardReport = {};\n        var reports = response.result();\n        reports.forEach(function(report) {\n          var standardStats = {\n            id: report.id,\n            timestamp: report.timestamp,\n            type: {\n              localcandidate: 'local-candidate',\n              remotecandidate: 'remote-candidate'\n            }[report.type] || report.type\n          };\n          report.names().forEach(function(name) {\n            standardStats[name] = report.stat(name);\n          });\n          standardReport[standardStats.id] = standardStats;\n        });\n\n        return standardReport;\n      };\n\n      // shim getStats with maplike support\n      var makeMapStats = function(stats) {\n        return new Map(Object.keys(stats).map(function(key) {\n          return [key, stats[key]];\n        }));\n      };\n\n      if (arguments.length >= 2) {\n        var successCallbackWrapper_ = function(response) {\n          args[1](makeMapStats(fixChromeStats_(response)));\n        };\n\n        return origGetStats.apply(this, [successCallbackWrapper_,\n          arguments[0]]);\n      }\n\n      // promise-support\n      return new Promise(function(resolve, reject) {\n        origGetStats.apply(self, [\n          function(response) {\n            resolve(makeMapStats(fixChromeStats_(response)));\n          }, reject]);\n      }).then(successCallback, errorCallback);\n    };\n\n    // add promise support -- natively available in Chrome 51\n    if (browserDetails.version < 51) {\n      ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n          .forEach(function(method) {\n            var nativeMethod = RTCPeerConnection.prototype[method];\n            RTCPeerConnection.prototype[method] = function() {\n              var args = arguments;\n              var self = this;\n              var promise = new Promise(function(resolve, reject) {\n                nativeMethod.apply(self, [args[0], resolve, reject]);\n              });\n              if (args.length < 2) {\n                return promise;\n              }\n              return promise.then(function() {\n                args[1].apply(null, []);\n              },\n              function(err) {\n                if (args.length >= 3) {\n                  args[2].apply(null, [err]);\n                }\n              });\n            };\n          });\n    }\n\n    // promise support for createOffer and createAnswer. Available (without\n    // bugs) since M52: crbug/619289\n    if (browserDetails.version < 52) {\n      ['createOffer', 'createAnswer'].forEach(function(method) {\n        var nativeMethod = RTCPeerConnection.prototype[method];\n        RTCPeerConnection.prototype[method] = function() {\n          var self = this;\n          if (arguments.length < 1 || (arguments.length === 1 &&\n              typeof arguments[0] === 'object')) {\n            var opts = arguments.length === 1 ? arguments[0] : undefined;\n            return new Promise(function(resolve, reject) {\n              nativeMethod.apply(self, [resolve, reject, opts]);\n            });\n          }\n          return nativeMethod.apply(this, arguments);\n        };\n      });\n    }\n\n    // shim implicit creation of RTCSessionDescription/RTCIceCandidate\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n        .forEach(function(method) {\n          var nativeMethod = RTCPeerConnection.prototype[method];\n          RTCPeerConnection.prototype[method] = function() {\n            arguments[0] = new ((method === 'addIceCandidate') ?\n                RTCIceCandidate : RTCSessionDescription)(arguments[0]);\n            return nativeMethod.apply(this, arguments);\n          };\n        });\n\n    // support for addIceCandidate(null or undefined)\n    var nativeAddIceCandidate =\n        RTCPeerConnection.prototype.addIceCandidate;\n    RTCPeerConnection.prototype.addIceCandidate = function() {\n      if (!arguments[0]) {\n        if (arguments[1]) {\n          arguments[1].apply(null);\n        }\n        return Promise.resolve();\n      }\n      return nativeAddIceCandidate.apply(this, arguments);\n    };\n  }\n};\n\n\n// Expose public methods.\nmodule.exports = {\n  shimMediaStream: chromeShim.shimMediaStream,\n  shimOnTrack: chromeShim.shimOnTrack,\n  shimGetSendersWithDtmf: chromeShim.shimGetSendersWithDtmf,\n  shimSourceObject: chromeShim.shimSourceObject,\n  shimPeerConnection: chromeShim.shimPeerConnection,\n  shimGetUserMedia: __webpack_require__(7)\n};\n\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n\nvar logging = __webpack_require__(0).log;\nvar browserDetails = __webpack_require__(0).browserDetails;\n\n// Expose public methods.\nmodule.exports = function() {\n  var constraintsToChrome_ = function(c) {\n    if (typeof c !== 'object' || c.mandatory || c.optional) {\n      return c;\n    }\n    var cc = {};\n    Object.keys(c).forEach(function(key) {\n      if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n        return;\n      }\n      var r = (typeof c[key] === 'object') ? c[key] : {ideal: c[key]};\n      if (r.exact !== undefined && typeof r.exact === 'number') {\n        r.min = r.max = r.exact;\n      }\n      var oldname_ = function(prefix, name) {\n        if (prefix) {\n          return prefix + name.charAt(0).toUpperCase() + name.slice(1);\n        }\n        return (name === 'deviceId') ? 'sourceId' : name;\n      };\n      if (r.ideal !== undefined) {\n        cc.optional = cc.optional || [];\n        var oc = {};\n        if (typeof r.ideal === 'number') {\n          oc[oldname_('min', key)] = r.ideal;\n          cc.optional.push(oc);\n          oc = {};\n          oc[oldname_('max', key)] = r.ideal;\n          cc.optional.push(oc);\n        } else {\n          oc[oldname_('', key)] = r.ideal;\n          cc.optional.push(oc);\n        }\n      }\n      if (r.exact !== undefined && typeof r.exact !== 'number') {\n        cc.mandatory = cc.mandatory || {};\n        cc.mandatory[oldname_('', key)] = r.exact;\n      } else {\n        ['min', 'max'].forEach(function(mix) {\n          if (r[mix] !== undefined) {\n            cc.mandatory = cc.mandatory || {};\n            cc.mandatory[oldname_(mix, key)] = r[mix];\n          }\n        });\n      }\n    });\n    if (c.advanced) {\n      cc.optional = (cc.optional || []).concat(c.advanced);\n    }\n    return cc;\n  };\n\n  var shimConstraints_ = function(constraints, func) {\n    constraints = JSON.parse(JSON.stringify(constraints));\n    if (constraints && constraints.audio) {\n      constraints.audio = constraintsToChrome_(constraints.audio);\n    }\n    if (constraints && typeof constraints.video === 'object') {\n      // Shim facingMode for mobile & surface pro.\n      var face = constraints.video.facingMode;\n      face = face && ((typeof face === 'object') ? face : {ideal: face});\n      var getSupportedFacingModeLies = browserDetails.version < 61;\n\n      if ((face && (face.exact === 'user' || face.exact === 'environment' ||\n                    face.ideal === 'user' || face.ideal === 'environment')) &&\n          !(navigator.mediaDevices.getSupportedConstraints &&\n            navigator.mediaDevices.getSupportedConstraints().facingMode &&\n            !getSupportedFacingModeLies)) {\n        delete constraints.video.facingMode;\n        var matches;\n        if (face.exact === 'environment' || face.ideal === 'environment') {\n          matches = ['back', 'rear'];\n        } else if (face.exact === 'user' || face.ideal === 'user') {\n          matches = ['front'];\n        }\n        if (matches) {\n          // Look for matches in label, or use last cam for back (typical).\n          return navigator.mediaDevices.enumerateDevices()\n          .then(function(devices) {\n            devices = devices.filter(function(d) {\n              return d.kind === 'videoinput';\n            });\n            var dev = devices.find(function(d) {\n              return matches.some(function(match) {\n                return d.label.toLowerCase().indexOf(match) !== -1;\n              });\n            });\n            if (!dev && devices.length && matches.indexOf('back') !== -1) {\n              dev = devices[devices.length - 1]; // more likely the back cam\n            }\n            if (dev) {\n              constraints.video.deviceId = face.exact ? {exact: dev.deviceId} :\n                                                        {ideal: dev.deviceId};\n            }\n            constraints.video = constraintsToChrome_(constraints.video);\n            logging('chrome: ' + JSON.stringify(constraints));\n            return func(constraints);\n          });\n        }\n      }\n      constraints.video = constraintsToChrome_(constraints.video);\n    }\n    logging('chrome: ' + JSON.stringify(constraints));\n    return func(constraints);\n  };\n\n  var shimError_ = function(e) {\n    return {\n      name: {\n        ConstraintNotSatisfiedError: 'OverconstrainedError',\n        PermissionDeniedError: 'NotAllowedError',\n        TrackStartError: 'NotReadableError'\n      }[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraintName,\n      toString: function() {\n        return this.name + (this.message && ': ') + this.message;\n      }\n    };\n  };\n\n  var getUserMedia_ = function(constraints, onSuccess, onError) {\n    shimConstraints_(constraints, function(c) {\n      navigator.webkitGetUserMedia(c, onSuccess, function(e) {\n        onError(shimError_(e));\n      });\n    });\n  };\n\n  navigator.getUserMedia = getUserMedia_;\n\n  // Returns the result of getUserMedia as a Promise.\n  var getUserMediaPromise_ = function(constraints) {\n    return new Promise(function(resolve, reject) {\n      navigator.getUserMedia(constraints, resolve, reject);\n    });\n  };\n\n  if (!navigator.mediaDevices) {\n    navigator.mediaDevices = {\n      getUserMedia: getUserMediaPromise_,\n      enumerateDevices: function() {\n        return new Promise(function(resolve) {\n          var kinds = {audio: 'audioinput', video: 'videoinput'};\n          return MediaStreamTrack.getSources(function(devices) {\n            resolve(devices.map(function(device) {\n              return {label: device.label,\n                kind: kinds[device.kind],\n                deviceId: device.id,\n                groupId: ''};\n            }));\n          });\n        });\n      },\n      getSupportedConstraints: function() {\n        return {\n          deviceId: true, echoCancellation: true, facingMode: true,\n          frameRate: true, height: true, width: true\n        };\n      }\n    };\n  }\n\n  // A shim for getUserMedia method on the mediaDevices object.\n  // TODO(KaptenJansson) remove once implemented in Chrome stable.\n  if (!navigator.mediaDevices.getUserMedia) {\n    navigator.mediaDevices.getUserMedia = function(constraints) {\n      return getUserMediaPromise_(constraints);\n    };\n  } else {\n    // Even though Chrome 45 has navigator.mediaDevices and a getUserMedia\n    // function which returns a Promise, it does not accept spec-style\n    // constraints.\n    var origGetUserMedia = navigator.mediaDevices.getUserMedia.\n        bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(cs) {\n      return shimConstraints_(cs, function(c) {\n        return origGetUserMedia(c).then(function(stream) {\n          if (c.audio && !stream.getAudioTracks().length ||\n              c.video && !stream.getVideoTracks().length) {\n            stream.getTracks().forEach(function(track) {\n              track.stop();\n            });\n            throw new DOMException('', 'NotFoundError');\n          }\n          return stream;\n        }, function(e) {\n          return Promise.reject(shimError_(e));\n        });\n      });\n    };\n  }\n\n  // Dummy devicechange event methods.\n  // TODO(KaptenJansson) remove once implemented in Chrome stable.\n  if (typeof navigator.mediaDevices.addEventListener === 'undefined') {\n    navigator.mediaDevices.addEventListener = function() {\n      logging('Dummy mediaDevices.addEventListener called.');\n    };\n  }\n  if (typeof navigator.mediaDevices.removeEventListener === 'undefined') {\n    navigator.mediaDevices.removeEventListener = function() {\n      logging('Dummy mediaDevices.removeEventListener called.');\n    };\n  }\n};\n\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n\n\nvar browserDetails = __webpack_require__(0).browserDetails;\nvar shimRTCPeerConnection = __webpack_require__(10);\n\nmodule.exports = {\n  shimGetUserMedia: __webpack_require__(9),\n  shimPeerConnection: function() {\n    if (window.RTCIceGatherer) {\n      // ORTC defines an RTCIceCandidate object but no constructor.\n      // Not implemented in Edge.\n      if (!window.RTCIceCandidate) {\n        window.RTCIceCandidate = function(args) {\n          return args;\n        };\n      }\n      // ORTC does not have a session description object but\n      // other browsers (i.e. Chrome) that will support both PC and ORTC\n      // in the future might have this defined already.\n      if (!window.RTCSessionDescription) {\n        window.RTCSessionDescription = function(args) {\n          return args;\n        };\n      }\n      // this adds an additional event listener to MediaStrackTrack that signals\n      // when a tracks enabled property was changed. Workaround for a bug in\n      // addStream, see below. No longer required in 15025+\n      if (browserDetails.version < 15025) {\n        var origMSTEnabled = Object.getOwnPropertyDescriptor(\n            MediaStreamTrack.prototype, 'enabled');\n        Object.defineProperty(MediaStreamTrack.prototype, 'enabled', {\n          set: function(value) {\n            origMSTEnabled.set.call(this, value);\n            var ev = new Event('enabled');\n            ev.enabled = value;\n            this.dispatchEvent(ev);\n          }\n        });\n      }\n    }\n    window.RTCPeerConnection = shimRTCPeerConnection(browserDetails.version);\n  },\n  shimReplaceTrack: function() {\n    // ORTC has replaceTrack -- https://github.com/w3c/ortc/issues/614\n    if (window.RTCRtpSender && !('replaceTrack' in RTCRtpSender.prototype)) {\n      RTCRtpSender.prototype.replaceTrack = RTCRtpSender.prototype.setTrack;\n    }\n  }\n};\n\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n\n\n// Expose public methods.\nmodule.exports = function() {\n  var shimError_ = function(e) {\n    return {\n      name: {PermissionDeniedError: 'NotAllowedError'}[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint,\n      toString: function() {\n        return this.name;\n      }\n    };\n  };\n\n  // getUserMedia error shim.\n  var origGetUserMedia = navigator.mediaDevices.getUserMedia.\n      bind(navigator.mediaDevices);\n  navigator.mediaDevices.getUserMedia = function(c) {\n    return origGetUserMedia(c).catch(function(e) {\n      return Promise.reject(shimError_(e));\n    });\n  };\n};\n\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n\n\nvar SDPUtils = __webpack_require__(4);\n\n// sort tracks such that they follow an a-v-a-v...\n// pattern.\nfunction sortTracks(tracks) {\n  var audioTracks = tracks.filter(function(track) {\n    return track.kind === 'audio';\n  });\n  var videoTracks = tracks.filter(function(track) {\n    return track.kind === 'video';\n  });\n  tracks = [];\n  while (audioTracks.length || videoTracks.length) {\n    if (audioTracks.length) {\n      tracks.push(audioTracks.shift());\n    }\n    if (videoTracks.length) {\n      tracks.push(videoTracks.shift());\n    }\n  }\n  return tracks;\n}\n\n// Edge does not like\n// 1) stun:\n// 2) turn: that does not have all of turn:host:port?transport=udp\n// 3) turn: with ipv6 addresses\n// 4) turn: occurring muliple times\nfunction filterIceServers(iceServers, edgeVersion) {\n  var hasTurn = false;\n  iceServers = JSON.parse(JSON.stringify(iceServers));\n  return iceServers.filter(function(server) {\n    if (server && (server.urls || server.url)) {\n      var urls = server.urls || server.url;\n      if (server.url && !server.urls) {\n        console.warn('RTCIceServer.url is deprecated! Use urls instead.');\n      }\n      var isString = typeof urls === 'string';\n      if (isString) {\n        urls = [urls];\n      }\n      urls = urls.filter(function(url) {\n        var validTurn = url.indexOf('turn:') === 0 &&\n            url.indexOf('transport=udp') !== -1 &&\n            url.indexOf('turn:[') === -1 &&\n            !hasTurn;\n\n        if (validTurn) {\n          hasTurn = true;\n          return true;\n        }\n        return url.indexOf('stun:') === 0 && edgeVersion >= 14393;\n      });\n\n      delete server.url;\n      server.urls = isString ? urls[0] : urls;\n      return !!urls.length;\n    }\n    return false;\n  });\n}\n\n// Determines the intersection of local and remote capabilities.\nfunction getCommonCapabilities(localCapabilities, remoteCapabilities) {\n  var commonCapabilities = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: []\n  };\n\n  var findCodecByPayloadType = function(pt, codecs) {\n    pt = parseInt(pt, 10);\n    for (var i = 0; i < codecs.length; i++) {\n      if (codecs[i].payloadType === pt ||\n          codecs[i].preferredPayloadType === pt) {\n        return codecs[i];\n      }\n    }\n  };\n\n  var rtxCapabilityMatches = function(lRtx, rRtx, lCodecs, rCodecs) {\n    var lCodec = findCodecByPayloadType(lRtx.parameters.apt, lCodecs);\n    var rCodec = findCodecByPayloadType(rRtx.parameters.apt, rCodecs);\n    return lCodec && rCodec &&\n        lCodec.name.toLowerCase() === rCodec.name.toLowerCase();\n  };\n\n  localCapabilities.codecs.forEach(function(lCodec) {\n    for (var i = 0; i < remoteCapabilities.codecs.length; i++) {\n      var rCodec = remoteCapabilities.codecs[i];\n      if (lCodec.name.toLowerCase() === rCodec.name.toLowerCase() &&\n          lCodec.clockRate === rCodec.clockRate) {\n        if (lCodec.name.toLowerCase() === 'rtx' &&\n            lCodec.parameters && rCodec.parameters.apt) {\n          // for RTX we need to find the local rtx that has a apt\n          // which points to the same local codec as the remote one.\n          if (!rtxCapabilityMatches(lCodec, rCodec,\n              localCapabilities.codecs, remoteCapabilities.codecs)) {\n            continue;\n          }\n        }\n        rCodec = JSON.parse(JSON.stringify(rCodec)); // deepcopy\n        // number of channels is the highest common number of channels\n        rCodec.numChannels = Math.min(lCodec.numChannels,\n            rCodec.numChannels);\n        // push rCodec so we reply with offerer payload type\n        commonCapabilities.codecs.push(rCodec);\n\n        // determine common feedback mechanisms\n        rCodec.rtcpFeedback = rCodec.rtcpFeedback.filter(function(fb) {\n          for (var j = 0; j < lCodec.rtcpFeedback.length; j++) {\n            if (lCodec.rtcpFeedback[j].type === fb.type &&\n                lCodec.rtcpFeedback[j].parameter === fb.parameter) {\n              return true;\n            }\n          }\n          return false;\n        });\n        // FIXME: also need to determine .parameters\n        //  see https://github.com/openpeer/ortc/issues/569\n        break;\n      }\n    }\n  });\n\n  localCapabilities.headerExtensions.forEach(function(lHeaderExtension) {\n    for (var i = 0; i < remoteCapabilities.headerExtensions.length;\n         i++) {\n      var rHeaderExtension = remoteCapabilities.headerExtensions[i];\n      if (lHeaderExtension.uri === rHeaderExtension.uri) {\n        commonCapabilities.headerExtensions.push(rHeaderExtension);\n        break;\n      }\n    }\n  });\n\n  // FIXME: fecMechanisms\n  return commonCapabilities;\n}\n\n// is action=setLocalDescription with type allowed in signalingState\nfunction isActionAllowedInSignalingState(action, type, signalingState) {\n  return {\n    offer: {\n      setLocalDescription: ['stable', 'have-local-offer'],\n      setRemoteDescription: ['stable', 'have-remote-offer']\n    },\n    answer: {\n      setLocalDescription: ['have-remote-offer', 'have-local-pranswer'],\n      setRemoteDescription: ['have-local-offer', 'have-remote-pranswer']\n    }\n  }[type][action].indexOf(signalingState) !== -1;\n}\n\nmodule.exports = function(edgeVersion) {\n  var RTCPeerConnection = function(config) {\n    var self = this;\n\n    var _eventTarget = document.createDocumentFragment();\n    ['addEventListener', 'removeEventListener', 'dispatchEvent']\n        .forEach(function(method) {\n          self[method] = _eventTarget[method].bind(_eventTarget);\n        });\n\n    this.needNegotiation = false;\n\n    this.onicecandidate = null;\n    this.onaddstream = null;\n    this.ontrack = null;\n    this.onremovestream = null;\n    this.onsignalingstatechange = null;\n    this.oniceconnectionstatechange = null;\n    this.onicegatheringstatechange = null;\n    this.onnegotiationneeded = null;\n    this.ondatachannel = null;\n    this.canTrickleIceCandidates = null;\n\n    this.localStreams = [];\n    this.remoteStreams = [];\n    this.getLocalStreams = function() {\n      return self.localStreams;\n    };\n    this.getRemoteStreams = function() {\n      return self.remoteStreams;\n    };\n\n    this.localDescription = new RTCSessionDescription({\n      type: '',\n      sdp: ''\n    });\n    this.remoteDescription = new RTCSessionDescription({\n      type: '',\n      sdp: ''\n    });\n    this.signalingState = 'stable';\n    this.iceConnectionState = 'new';\n    this.iceGatheringState = 'new';\n\n    this.iceOptions = {\n      gatherPolicy: 'all',\n      iceServers: []\n    };\n    if (config && config.iceTransportPolicy) {\n      switch (config.iceTransportPolicy) {\n        case 'all':\n        case 'relay':\n          this.iceOptions.gatherPolicy = config.iceTransportPolicy;\n          break;\n        default:\n          // don't set iceTransportPolicy.\n          break;\n      }\n    }\n    this.usingBundle = config && config.bundlePolicy === 'max-bundle';\n\n    if (config && config.iceServers) {\n      this.iceOptions.iceServers = filterIceServers(config.iceServers,\n          edgeVersion);\n    }\n    this._config = config || {};\n\n    // per-track iceGathers, iceTransports, dtlsTransports, rtpSenders, ...\n    // everything that is needed to describe a SDP m-line.\n    this.transceivers = [];\n\n    // since the iceGatherer is currently created in createOffer but we\n    // must not emit candidates until after setLocalDescription we buffer\n    // them in this array.\n    this._localIceCandidatesBuffer = [];\n  };\n\n  RTCPeerConnection.prototype._emitGatheringStateChange = function() {\n    var event = new Event('icegatheringstatechange');\n    this.dispatchEvent(event);\n    if (this.onicegatheringstatechange !== null) {\n      this.onicegatheringstatechange(event);\n    }\n  };\n\n  RTCPeerConnection.prototype._emitBufferedCandidates = function() {\n    var self = this;\n    var sections = SDPUtils.splitSections(self.localDescription.sdp);\n    // FIXME: need to apply ice candidates in a way which is async but\n    // in-order\n    this._localIceCandidatesBuffer.forEach(function(event) {\n      var end = !event.candidate || Object.keys(event.candidate).length === 0;\n      if (end) {\n        for (var j = 1; j < sections.length; j++) {\n          if (sections[j].indexOf('\\r\\na=end-of-candidates\\r\\n') === -1) {\n            sections[j] += 'a=end-of-candidates\\r\\n';\n          }\n        }\n      } else {\n        sections[event.candidate.sdpMLineIndex + 1] +=\n            'a=' + event.candidate.candidate + '\\r\\n';\n      }\n      self.localDescription.sdp = sections.join('');\n      self.dispatchEvent(event);\n      if (self.onicecandidate !== null) {\n        self.onicecandidate(event);\n      }\n      if (!event.candidate && self.iceGatheringState !== 'complete') {\n        var complete = self.transceivers.every(function(transceiver) {\n          return transceiver.iceGatherer &&\n              transceiver.iceGatherer.state === 'completed';\n        });\n        if (complete && self.iceGatheringStateChange !== 'complete') {\n          self.iceGatheringState = 'complete';\n          self._emitGatheringStateChange();\n        }\n      }\n    });\n    this._localIceCandidatesBuffer = [];\n  };\n\n  RTCPeerConnection.prototype.getConfiguration = function() {\n    return this._config;\n  };\n\n  // internal helper to create a transceiver object.\n  // (whih is not yet the same as the WebRTC 1.0 transceiver)\n  RTCPeerConnection.prototype._createTransceiver = function(kind) {\n    var hasBundleTransport = this.transceivers.length > 0;\n    var transceiver = {\n      track: null,\n      iceGatherer: null,\n      iceTransport: null,\n      dtlsTransport: null,\n      localCapabilities: null,\n      remoteCapabilities: null,\n      rtpSender: null,\n      rtpReceiver: null,\n      kind: kind,\n      mid: null,\n      sendEncodingParameters: null,\n      recvEncodingParameters: null,\n      stream: null,\n      wantReceive: true\n    };\n    if (this.usingBundle && hasBundleTransport) {\n      transceiver.iceTransport = this.transceivers[0].iceTransport;\n      transceiver.dtlsTransport = this.transceivers[0].dtlsTransport;\n    } else {\n      var transports = this._createIceAndDtlsTransports();\n      transceiver.iceTransport = transports.iceTransport;\n      transceiver.dtlsTransport = transports.dtlsTransport;\n    }\n    this.transceivers.push(transceiver);\n    return transceiver;\n  };\n\n  RTCPeerConnection.prototype.addTrack = function(track, stream) {\n    var transceiver;\n    for (var i = 0; i < this.transceivers.length; i++) {\n      if (!this.transceivers[i].track &&\n          this.transceivers[i].kind === track.kind) {\n        transceiver = this.transceivers[i];\n      }\n    }\n    if (!transceiver) {\n      transceiver = this._createTransceiver(track.kind);\n    }\n\n    transceiver.track = track;\n    transceiver.stream = stream;\n    transceiver.rtpSender = new RTCRtpSender(track,\n        transceiver.dtlsTransport);\n\n    this._maybeFireNegotiationNeeded();\n    return transceiver.rtpSender;\n  };\n\n  RTCPeerConnection.prototype.addStream = function(stream) {\n    var self = this;\n    if (edgeVersion >= 15025) {\n      this.localStreams.push(stream);\n      stream.getTracks().forEach(function(track) {\n        self.addTrack(track, stream);\n      });\n    } else {\n      // Clone is necessary for local demos mostly, attaching directly\n      // to two different senders does not work (build 10547).\n      // Fixed in 15025 (or earlier)\n      var clonedStream = stream.clone();\n      stream.getTracks().forEach(function(track, idx) {\n        var clonedTrack = clonedStream.getTracks()[idx];\n        track.addEventListener('enabled', function(event) {\n          clonedTrack.enabled = event.enabled;\n        });\n      });\n      clonedStream.getTracks().forEach(function(track) {\n        self.addTrack(track, clonedStream);\n      });\n      this.localStreams.push(clonedStream);\n    }\n    this._maybeFireNegotiationNeeded();\n  };\n\n  RTCPeerConnection.prototype.removeStream = function(stream) {\n    var idx = this.localStreams.indexOf(stream);\n    if (idx > -1) {\n      this.localStreams.splice(idx, 1);\n      this._maybeFireNegotiationNeeded();\n    }\n  };\n\n  RTCPeerConnection.prototype.getSenders = function() {\n    return this.transceivers.filter(function(transceiver) {\n      return !!transceiver.rtpSender;\n    })\n    .map(function(transceiver) {\n      return transceiver.rtpSender;\n    });\n  };\n\n  RTCPeerConnection.prototype.getReceivers = function() {\n    return this.transceivers.filter(function(transceiver) {\n      return !!transceiver.rtpReceiver;\n    })\n    .map(function(transceiver) {\n      return transceiver.rtpReceiver;\n    });\n  };\n\n  // Create ICE gatherer and hook it up.\n  RTCPeerConnection.prototype._createIceGatherer = function(mid,\n      sdpMLineIndex) {\n    var self = this;\n    var iceGatherer = new RTCIceGatherer(self.iceOptions);\n    iceGatherer.onlocalcandidate = function(evt) {\n      var event = new Event('icecandidate');\n      event.candidate = {sdpMid: mid, sdpMLineIndex: sdpMLineIndex};\n\n      var cand = evt.candidate;\n      var end = !cand || Object.keys(cand).length === 0;\n      // Edge emits an empty object for RTCIceCandidateComplete‥\n      if (end) {\n        // polyfill since RTCIceGatherer.state is not implemented in\n        // Edge 10547 yet.\n        if (iceGatherer.state === undefined) {\n          iceGatherer.state = 'completed';\n        }\n      } else {\n        // RTCIceCandidate doesn't have a component, needs to be added\n        cand.component = 1;\n        event.candidate.candidate = SDPUtils.writeCandidate(cand);\n      }\n\n      // update local description.\n      var sections = SDPUtils.splitSections(self.localDescription.sdp);\n      if (!end) {\n        sections[event.candidate.sdpMLineIndex + 1] +=\n            'a=' + event.candidate.candidate + '\\r\\n';\n      } else {\n        sections[event.candidate.sdpMLineIndex + 1] +=\n            'a=end-of-candidates\\r\\n';\n      }\n      self.localDescription.sdp = sections.join('');\n      var transceivers = self._pendingOffer ? self._pendingOffer :\n          self.transceivers;\n      var complete = transceivers.every(function(transceiver) {\n        return transceiver.iceGatherer &&\n            transceiver.iceGatherer.state === 'completed';\n      });\n\n      // Emit candidate if localDescription is set.\n      // Also emits null candidate when all gatherers are complete.\n      switch (self.iceGatheringState) {\n        case 'new':\n          if (!end) {\n            self._localIceCandidatesBuffer.push(event);\n          }\n          if (end && complete) {\n            self._localIceCandidatesBuffer.push(\n                new Event('icecandidate'));\n          }\n          break;\n        case 'gathering':\n          self._emitBufferedCandidates();\n          if (!end) {\n            self.dispatchEvent(event);\n            if (self.onicecandidate !== null) {\n              self.onicecandidate(event);\n            }\n          }\n          if (complete) {\n            self.dispatchEvent(new Event('icecandidate'));\n            if (self.onicecandidate !== null) {\n              self.onicecandidate(new Event('icecandidate'));\n            }\n            self.iceGatheringState = 'complete';\n            self._emitGatheringStateChange();\n          }\n          break;\n        case 'complete':\n          // should not happen... currently!\n          break;\n        default: // no-op.\n          break;\n      }\n    };\n    return iceGatherer;\n  };\n\n  // Create ICE transport and DTLS transport.\n  RTCPeerConnection.prototype._createIceAndDtlsTransports = function() {\n    var self = this;\n    var iceTransport = new RTCIceTransport(null);\n    iceTransport.onicestatechange = function() {\n      self._updateConnectionState();\n    };\n\n    var dtlsTransport = new RTCDtlsTransport(iceTransport);\n    dtlsTransport.ondtlsstatechange = function() {\n      self._updateConnectionState();\n    };\n    dtlsTransport.onerror = function() {\n      // onerror does not set state to failed by itself.\n      Object.defineProperty(dtlsTransport, 'state',\n          {value: 'failed', writable: true});\n      self._updateConnectionState();\n    };\n\n    return {\n      iceTransport: iceTransport,\n      dtlsTransport: dtlsTransport\n    };\n  };\n\n  // Destroy ICE gatherer, ICE transport and DTLS transport.\n  // Without triggering the callbacks.\n  RTCPeerConnection.prototype._disposeIceAndDtlsTransports = function(\n      sdpMLineIndex) {\n    var iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;\n    if (iceGatherer) {\n      delete iceGatherer.onlocalcandidate;\n      delete this.transceivers[sdpMLineIndex].iceGatherer;\n    }\n    var iceTransport = this.transceivers[sdpMLineIndex].iceTransport;\n    if (iceTransport) {\n      delete iceTransport.onicestatechange;\n      delete this.transceivers[sdpMLineIndex].iceTransport;\n    }\n    var dtlsTransport = this.transceivers[sdpMLineIndex].dtlsTransport;\n    if (dtlsTransport) {\n      delete dtlsTransport.ondtlssttatechange;\n      delete dtlsTransport.onerror;\n      delete this.transceivers[sdpMLineIndex].dtlsTransport;\n    }\n  };\n\n  // Start the RTP Sender and Receiver for a transceiver.\n  RTCPeerConnection.prototype._transceive = function(transceiver,\n      send, recv) {\n    var params = getCommonCapabilities(transceiver.localCapabilities,\n        transceiver.remoteCapabilities);\n    if (send && transceiver.rtpSender) {\n      params.encodings = transceiver.sendEncodingParameters;\n      params.rtcp = {\n        cname: SDPUtils.localCName,\n        compound: transceiver.rtcpParameters.compound\n      };\n      if (transceiver.recvEncodingParameters.length) {\n        params.rtcp.ssrc = transceiver.recvEncodingParameters[0].ssrc;\n      }\n      transceiver.rtpSender.send(params);\n    }\n    if (recv && transceiver.rtpReceiver) {\n      // remove RTX field in Edge 14942\n      if (transceiver.kind === 'video'\n          && transceiver.recvEncodingParameters\n          && edgeVersion < 15019) {\n        transceiver.recvEncodingParameters.forEach(function(p) {\n          delete p.rtx;\n        });\n      }\n      params.encodings = transceiver.recvEncodingParameters;\n      params.rtcp = {\n        cname: transceiver.rtcpParameters.cname,\n        compound: transceiver.rtcpParameters.compound\n      };\n      if (transceiver.sendEncodingParameters.length) {\n        params.rtcp.ssrc = transceiver.sendEncodingParameters[0].ssrc;\n      }\n      transceiver.rtpReceiver.receive(params);\n    }\n  };\n\n  RTCPeerConnection.prototype.setLocalDescription = function(description) {\n    var self = this;\n\n    if (!isActionAllowedInSignalingState('setLocalDescription',\n        description.type, this.signalingState)) {\n      var e = new Error('Can not set local ' + description.type +\n          ' in state ' + this.signalingState);\n      e.name = 'InvalidStateError';\n      if (arguments.length > 2 && typeof arguments[2] === 'function') {\n        window.setTimeout(arguments[2], 0, e);\n      }\n      return Promise.reject(e);\n    }\n\n    var sections;\n    var sessionpart;\n    if (description.type === 'offer') {\n      // FIXME: What was the purpose of this empty if statement?\n      // if (!this._pendingOffer) {\n      // } else {\n      if (this._pendingOffer) {\n        // VERY limited support for SDP munging. Limited to:\n        // * changing the order of codecs\n        sections = SDPUtils.splitSections(description.sdp);\n        sessionpart = sections.shift();\n        sections.forEach(function(mediaSection, sdpMLineIndex) {\n          var caps = SDPUtils.parseRtpParameters(mediaSection);\n          self._pendingOffer[sdpMLineIndex].localCapabilities = caps;\n        });\n        this.transceivers = this._pendingOffer;\n        delete this._pendingOffer;\n      }\n    } else if (description.type === 'answer') {\n      sections = SDPUtils.splitSections(self.remoteDescription.sdp);\n      sessionpart = sections.shift();\n      var isIceLite = SDPUtils.matchPrefix(sessionpart,\n          'a=ice-lite').length > 0;\n      sections.forEach(function(mediaSection, sdpMLineIndex) {\n        var transceiver = self.transceivers[sdpMLineIndex];\n        var iceGatherer = transceiver.iceGatherer;\n        var iceTransport = transceiver.iceTransport;\n        var dtlsTransport = transceiver.dtlsTransport;\n        var localCapabilities = transceiver.localCapabilities;\n        var remoteCapabilities = transceiver.remoteCapabilities;\n\n        var rejected = SDPUtils.isRejected(mediaSection);\n\n        if (!rejected && !transceiver.isDatachannel) {\n          var remoteIceParameters = SDPUtils.getIceParameters(\n              mediaSection, sessionpart);\n          var remoteDtlsParameters = SDPUtils.getDtlsParameters(\n              mediaSection, sessionpart);\n          if (isIceLite) {\n            remoteDtlsParameters.role = 'server';\n          }\n\n          if (!self.usingBundle || sdpMLineIndex === 0) {\n            iceTransport.start(iceGatherer, remoteIceParameters,\n                isIceLite ? 'controlling' : 'controlled');\n            dtlsTransport.start(remoteDtlsParameters);\n          }\n\n          // Calculate intersection of capabilities.\n          var params = getCommonCapabilities(localCapabilities,\n              remoteCapabilities);\n\n          // Start the RTCRtpSender. The RTCRtpReceiver for this\n          // transceiver has already been started in setRemoteDescription.\n          self._transceive(transceiver,\n              params.codecs.length > 0,\n              false);\n        }\n      });\n    }\n\n    this.localDescription = {\n      type: description.type,\n      sdp: description.sdp\n    };\n    switch (description.type) {\n      case 'offer':\n        this._updateSignalingState('have-local-offer');\n        break;\n      case 'answer':\n        this._updateSignalingState('stable');\n        break;\n      default:\n        throw new TypeError('unsupported type \"' + description.type +\n            '\"');\n    }\n\n    // If a success callback was provided, emit ICE candidates after it\n    // has been executed. Otherwise, emit callback after the Promise is\n    // resolved.\n    var hasCallback = arguments.length > 1 &&\n      typeof arguments[1] === 'function';\n    if (hasCallback) {\n      var cb = arguments[1];\n      window.setTimeout(function() {\n        cb();\n        if (self.iceGatheringState === 'new') {\n          self.iceGatheringState = 'gathering';\n          self._emitGatheringStateChange();\n        }\n        self._emitBufferedCandidates();\n      }, 0);\n    }\n    var p = Promise.resolve();\n    p.then(function() {\n      if (!hasCallback) {\n        if (self.iceGatheringState === 'new') {\n          self.iceGatheringState = 'gathering';\n          self._emitGatheringStateChange();\n        }\n        // Usually candidates will be emitted earlier.\n        window.setTimeout(self._emitBufferedCandidates.bind(self), 500);\n      }\n    });\n    return p;\n  };\n\n  RTCPeerConnection.prototype.setRemoteDescription = function(description) {\n    var self = this;\n\n    if (!isActionAllowedInSignalingState('setRemoteDescription',\n        description.type, this.signalingState)) {\n      var e = new Error('Can not set remote ' + description.type +\n          ' in state ' + this.signalingState);\n      e.name = 'InvalidStateError';\n      if (arguments.length > 2 && typeof arguments[2] === 'function') {\n        window.setTimeout(arguments[2], 0, e);\n      }\n      return Promise.reject(e);\n    }\n\n    var streams = {};\n    var receiverList = [];\n    var sections = SDPUtils.splitSections(description.sdp);\n    var sessionpart = sections.shift();\n    var isIceLite = SDPUtils.matchPrefix(sessionpart,\n        'a=ice-lite').length > 0;\n    var usingBundle = SDPUtils.matchPrefix(sessionpart,\n        'a=group:BUNDLE ').length > 0;\n    this.usingBundle = usingBundle;\n    var iceOptions = SDPUtils.matchPrefix(sessionpart,\n        'a=ice-options:')[0];\n    if (iceOptions) {\n      this.canTrickleIceCandidates = iceOptions.substr(14).split(' ')\n          .indexOf('trickle') >= 0;\n    } else {\n      this.canTrickleIceCandidates = false;\n    }\n\n    sections.forEach(function(mediaSection, sdpMLineIndex) {\n      var lines = SDPUtils.splitLines(mediaSection);\n      var kind = SDPUtils.getKind(mediaSection);\n      var rejected = SDPUtils.isRejected(mediaSection);\n      var protocol = lines[0].substr(2).split(' ')[2];\n\n      var direction = SDPUtils.getDirection(mediaSection, sessionpart);\n      var remoteMsid = SDPUtils.parseMsid(mediaSection);\n\n      var mid = SDPUtils.getMid(mediaSection) || SDPUtils.generateIdentifier();\n\n      // Reject datachannels which are not implemented yet.\n      if (kind === 'application' && protocol === 'DTLS/SCTP') {\n        self.transceivers[sdpMLineIndex] = {\n          mid: mid,\n          isDatachannel: true\n        };\n        return;\n      }\n\n      var transceiver;\n      var iceGatherer;\n      var iceTransport;\n      var dtlsTransport;\n      var rtpReceiver;\n      var sendEncodingParameters;\n      var recvEncodingParameters;\n      var localCapabilities;\n\n      var track;\n      // FIXME: ensure the mediaSection has rtcp-mux set.\n      var remoteCapabilities = SDPUtils.parseRtpParameters(mediaSection);\n      var remoteIceParameters;\n      var remoteDtlsParameters;\n      if (!rejected) {\n        remoteIceParameters = SDPUtils.getIceParameters(mediaSection,\n            sessionpart);\n        remoteDtlsParameters = SDPUtils.getDtlsParameters(mediaSection,\n            sessionpart);\n        remoteDtlsParameters.role = 'client';\n      }\n      recvEncodingParameters =\n          SDPUtils.parseRtpEncodingParameters(mediaSection);\n\n      var rtcpParameters = SDPUtils.parseRtcpParameters(mediaSection);\n\n      var isComplete = SDPUtils.matchPrefix(mediaSection,\n          'a=end-of-candidates', sessionpart).length > 0;\n      var cands = SDPUtils.matchPrefix(mediaSection, 'a=candidate:')\n          .map(function(cand) {\n            return SDPUtils.parseCandidate(cand);\n          })\n          .filter(function(cand) {\n            return cand.component === '1' || cand.component === 1;\n          });\n      if (description.type === 'offer' && !rejected) {\n        transceiver = self.transceivers[sdpMLineIndex] ||\n            self._createTransceiver(kind);\n        transceiver.mid = mid;\n\n        if (!transceiver.iceGatherer) {\n          transceiver.iceGatherer = usingBundle && sdpMLineIndex > 0 ?\n              self.transceivers[0].iceGatherer :\n              self._createIceGatherer(mid, sdpMLineIndex);\n        }\n\n        if (isComplete && (!usingBundle || sdpMLineIndex === 0)) {\n          transceiver.iceTransport.setRemoteCandidates(cands);\n        }\n\n        localCapabilities = RTCRtpReceiver.getCapabilities(kind);\n\n        // filter RTX until additional stuff needed for RTX is implemented\n        // in adapter.js\n        if (edgeVersion < 15019) {\n          localCapabilities.codecs = localCapabilities.codecs.filter(\n              function(codec) {\n                return codec.name !== 'rtx';\n              });\n        }\n\n        sendEncodingParameters = [{\n          ssrc: (2 * sdpMLineIndex + 2) * 1001\n        }];\n\n        if (direction === 'sendrecv' || direction === 'sendonly') {\n          rtpReceiver = new RTCRtpReceiver(transceiver.dtlsTransport,\n              kind);\n\n          track = rtpReceiver.track;\n          // FIXME: does not work with Plan B.\n          if (remoteMsid) {\n            if (!streams[remoteMsid.stream]) {\n              streams[remoteMsid.stream] = new MediaStream();\n              Object.defineProperty(streams[remoteMsid.stream], 'id', {\n                get: function() {\n                  return remoteMsid.stream;\n                }\n              });\n            }\n            Object.defineProperty(track, 'id', {\n              get: function() {\n                return remoteMsid.track;\n              }\n            });\n            streams[remoteMsid.stream].addTrack(track);\n            receiverList.push([track, rtpReceiver,\n              streams[remoteMsid.stream]]);\n          } else {\n            if (!streams.default) {\n              streams.default = new MediaStream();\n            }\n            streams.default.addTrack(track);\n            receiverList.push([track, rtpReceiver, streams.default]);\n          }\n        }\n\n        transceiver.localCapabilities = localCapabilities;\n        transceiver.remoteCapabilities = remoteCapabilities;\n        transceiver.rtpReceiver = rtpReceiver;\n        transceiver.rtcpParameters = rtcpParameters;\n        transceiver.sendEncodingParameters = sendEncodingParameters;\n        transceiver.recvEncodingParameters = recvEncodingParameters;\n\n        // Start the RTCRtpReceiver now. The RTPSender is started in\n        // setLocalDescription.\n        self._transceive(self.transceivers[sdpMLineIndex],\n            false,\n            direction === 'sendrecv' || direction === 'sendonly');\n      } else if (description.type === 'answer' && !rejected) {\n        if (usingBundle && sdpMLineIndex > 0) {\n          self._disposeIceAndDtlsTransports(sdpMLineIndex);\n          self.transceivers[sdpMLineIndex].iceGatherer =\n              self.transceivers[0].iceGatherer;\n          self.transceivers[sdpMLineIndex].iceTransport =\n              self.transceivers[0].iceTransport;\n          self.transceivers[sdpMLineIndex].dtlsTransport =\n              self.transceivers[0].dtlsTransport;\n          if (self.transceivers[sdpMLineIndex].rtpSender) {\n            self.transceivers[sdpMLineIndex].rtpSender.setTransport(\n                self.transceivers[0].dtlsTransport);\n          }\n          if (self.transceivers[sdpMLineIndex].rtpReceiver) {\n            self.transceivers[sdpMLineIndex].rtpReceiver.setTransport(\n                self.transceivers[0].dtlsTransport);\n          }\n        }\n        transceiver = self.transceivers[sdpMLineIndex];\n        iceGatherer = transceiver.iceGatherer;\n        iceTransport = transceiver.iceTransport;\n        dtlsTransport = transceiver.dtlsTransport;\n        rtpReceiver = transceiver.rtpReceiver;\n        sendEncodingParameters = transceiver.sendEncodingParameters;\n        localCapabilities = transceiver.localCapabilities;\n\n        self.transceivers[sdpMLineIndex].recvEncodingParameters =\n            recvEncodingParameters;\n        self.transceivers[sdpMLineIndex].remoteCapabilities =\n            remoteCapabilities;\n        self.transceivers[sdpMLineIndex].rtcpParameters = rtcpParameters;\n\n        if ((isIceLite || isComplete) && cands.length) {\n          iceTransport.setRemoteCandidates(cands);\n        }\n        if (!usingBundle || sdpMLineIndex === 0) {\n          iceTransport.start(iceGatherer, remoteIceParameters,\n              'controlling');\n          dtlsTransport.start(remoteDtlsParameters);\n        }\n\n        self._transceive(transceiver,\n            direction === 'sendrecv' || direction === 'recvonly',\n            direction === 'sendrecv' || direction === 'sendonly');\n\n        if (rtpReceiver &&\n            (direction === 'sendrecv' || direction === 'sendonly')) {\n          track = rtpReceiver.track;\n          if (remoteMsid) {\n            if (!streams[remoteMsid.stream]) {\n              streams[remoteMsid.stream] = new MediaStream();\n            }\n            streams[remoteMsid.stream].addTrack(track);\n            receiverList.push([track, rtpReceiver, streams[remoteMsid.stream]]);\n          } else {\n            if (!streams.default) {\n              streams.default = new MediaStream();\n            }\n            streams.default.addTrack(track);\n            receiverList.push([track, rtpReceiver, streams.default]);\n          }\n        } else {\n          // FIXME: actually the receiver should be created later.\n          delete transceiver.rtpReceiver;\n        }\n      }\n    });\n\n    this.remoteDescription = {\n      type: description.type,\n      sdp: description.sdp\n    };\n    switch (description.type) {\n      case 'offer':\n        this._updateSignalingState('have-remote-offer');\n        break;\n      case 'answer':\n        this._updateSignalingState('stable');\n        break;\n      default:\n        throw new TypeError('unsupported type \"' + description.type +\n            '\"');\n    }\n    Object.keys(streams).forEach(function(sid) {\n      var stream = streams[sid];\n      if (stream.getTracks().length) {\n        self.remoteStreams.push(stream);\n        var event = new Event('addstream');\n        event.stream = stream;\n        self.dispatchEvent(event);\n        if (self.onaddstream !== null) {\n          window.setTimeout(function() {\n            self.onaddstream(event);\n          }, 0);\n        }\n\n        receiverList.forEach(function(item) {\n          var track = item[0];\n          var receiver = item[1];\n          if (stream.id !== item[2].id) {\n            return;\n          }\n          var trackEvent = new Event('track');\n          trackEvent.track = track;\n          trackEvent.receiver = receiver;\n          trackEvent.streams = [stream];\n          self.dispatchEvent(trackEvent);\n          if (self.ontrack !== null) {\n            window.setTimeout(function() {\n              self.ontrack(trackEvent);\n            }, 0);\n          }\n        });\n      }\n    });\n\n    // check whether addIceCandidate({}) was called within four seconds after\n    // setRemoteDescription.\n    window.setTimeout(function() {\n      if (!(self && self.transceivers)) {\n        return;\n      }\n      self.transceivers.forEach(function(transceiver) {\n        if (transceiver.iceTransport &&\n            transceiver.iceTransport.state === 'new' &&\n            transceiver.iceTransport.getRemoteCandidates().length > 0) {\n          console.warn('Timeout for addRemoteCandidate. Consider sending ' +\n              'an end-of-candidates notification');\n          transceiver.iceTransport.addRemoteCandidate({});\n        }\n      });\n    }, 4000);\n\n    if (arguments.length > 1 && typeof arguments[1] === 'function') {\n      window.setTimeout(arguments[1], 0);\n    }\n    return Promise.resolve();\n  };\n\n  RTCPeerConnection.prototype.close = function() {\n    this.transceivers.forEach(function(transceiver) {\n      /* not yet\n      if (transceiver.iceGatherer) {\n        transceiver.iceGatherer.close();\n      }\n      */\n      if (transceiver.iceTransport) {\n        transceiver.iceTransport.stop();\n      }\n      if (transceiver.dtlsTransport) {\n        transceiver.dtlsTransport.stop();\n      }\n      if (transceiver.rtpSender) {\n        transceiver.rtpSender.stop();\n      }\n      if (transceiver.rtpReceiver) {\n        transceiver.rtpReceiver.stop();\n      }\n    });\n    // FIXME: clean up tracks, local streams, remote streams, etc\n    this._updateSignalingState('closed');\n  };\n\n  // Update the signaling state.\n  RTCPeerConnection.prototype._updateSignalingState = function(newState) {\n    this.signalingState = newState;\n    var event = new Event('signalingstatechange');\n    this.dispatchEvent(event);\n    if (this.onsignalingstatechange !== null) {\n      this.onsignalingstatechange(event);\n    }\n  };\n\n  // Determine whether to fire the negotiationneeded event.\n  RTCPeerConnection.prototype._maybeFireNegotiationNeeded = function() {\n    var self = this;\n    if (this.signalingState !== 'stable' || this.needNegotiation === true) {\n      return;\n    }\n    this.needNegotiation = true;\n    window.setTimeout(function() {\n      if (self.needNegotiation === false) {\n        return;\n      }\n      self.needNegotiation = false;\n      var event = new Event('negotiationneeded');\n      self.dispatchEvent(event);\n      if (self.onnegotiationneeded !== null) {\n        self.onnegotiationneeded(event);\n      }\n    }, 0);\n  };\n\n  // Update the connection state.\n  RTCPeerConnection.prototype._updateConnectionState = function() {\n    var self = this;\n    var newState;\n    var states = {\n      'new': 0,\n      closed: 0,\n      connecting: 0,\n      checking: 0,\n      connected: 0,\n      completed: 0,\n      failed: 0\n    };\n    this.transceivers.forEach(function(transceiver) {\n      states[transceiver.iceTransport.state]++;\n      states[transceiver.dtlsTransport.state]++;\n    });\n    // ICETransport.completed and connected are the same for this purpose.\n    states.connected += states.completed;\n\n    newState = 'new';\n    if (states.failed > 0) {\n      newState = 'failed';\n    } else if (states.connecting > 0 || states.checking > 0) {\n      newState = 'connecting';\n    } else if (states.disconnected > 0) {\n      newState = 'disconnected';\n    } else if (states.new > 0) {\n      newState = 'new';\n    } else if (states.connected > 0 || states.completed > 0) {\n      newState = 'connected';\n    }\n\n    if (newState !== self.iceConnectionState) {\n      self.iceConnectionState = newState;\n      var event = new Event('iceconnectionstatechange');\n      this.dispatchEvent(event);\n      if (this.oniceconnectionstatechange !== null) {\n        this.oniceconnectionstatechange(event);\n      }\n    }\n  };\n\n  RTCPeerConnection.prototype.createOffer = function() {\n    var self = this;\n    if (this._pendingOffer) {\n      throw new Error('createOffer called while there is a pending offer.');\n    }\n    var offerOptions;\n    if (arguments.length === 1 && typeof arguments[0] !== 'function') {\n      offerOptions = arguments[0];\n    } else if (arguments.length === 3) {\n      offerOptions = arguments[2];\n    }\n\n    var numAudioTracks = this.transceivers.filter(function(t) {\n      return t.kind === 'audio';\n    }).length;\n    var numVideoTracks = this.transceivers.filter(function(t) {\n      return t.kind === 'video';\n    }).length;\n\n    // Determine number of audio and video tracks we need to send/recv.\n    if (offerOptions) {\n      // Reject Chrome legacy constraints.\n      if (offerOptions.mandatory || offerOptions.optional) {\n        throw new TypeError(\n            'Legacy mandatory/optional constraints not supported.');\n      }\n      if (offerOptions.offerToReceiveAudio !== undefined) {\n        if (offerOptions.offerToReceiveAudio === true) {\n          numAudioTracks = 1;\n        } else if (offerOptions.offerToReceiveAudio === false) {\n          numAudioTracks = 0;\n        } else {\n          numAudioTracks = offerOptions.offerToReceiveAudio;\n        }\n      }\n      if (offerOptions.offerToReceiveVideo !== undefined) {\n        if (offerOptions.offerToReceiveVideo === true) {\n          numVideoTracks = 1;\n        } else if (offerOptions.offerToReceiveVideo === false) {\n          numVideoTracks = 0;\n        } else {\n          numVideoTracks = offerOptions.offerToReceiveVideo;\n        }\n      }\n    }\n\n    this.transceivers.forEach(function(transceiver) {\n      if (transceiver.kind === 'audio') {\n        numAudioTracks--;\n        if (numAudioTracks < 0) {\n          transceiver.wantReceive = false;\n        }\n      } else if (transceiver.kind === 'video') {\n        numVideoTracks--;\n        if (numVideoTracks < 0) {\n          transceiver.wantReceive = false;\n        }\n      }\n    });\n\n    // Create M-lines for recvonly streams.\n    while (numAudioTracks > 0 || numVideoTracks > 0) {\n      if (numAudioTracks > 0) {\n        this._createTransceiver('audio');\n        numAudioTracks--;\n      }\n      if (numVideoTracks > 0) {\n        this._createTransceiver('video');\n        numVideoTracks--;\n      }\n    }\n    // reorder tracks\n    var transceivers = sortTracks(this.transceivers);\n\n    var sdp = SDPUtils.writeSessionBoilerplate();\n    transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      // For each track, create an ice gatherer, ice transport,\n      // dtls transport, potentially rtpsender and rtpreceiver.\n      var track = transceiver.track;\n      var kind = transceiver.kind;\n      var mid = SDPUtils.generateIdentifier();\n      transceiver.mid = mid;\n\n      if (!transceiver.iceGatherer) {\n        transceiver.iceGatherer = self.usingBundle && sdpMLineIndex > 0 ?\n            transceivers[0].iceGatherer :\n            self._createIceGatherer(mid, sdpMLineIndex);\n      }\n\n      var localCapabilities = RTCRtpSender.getCapabilities(kind);\n      // filter RTX until additional stuff needed for RTX is implemented\n      // in adapter.js\n      if (edgeVersion < 15019) {\n        localCapabilities.codecs = localCapabilities.codecs.filter(\n            function(codec) {\n              return codec.name !== 'rtx';\n            });\n      }\n      localCapabilities.codecs.forEach(function(codec) {\n        // work around https://bugs.chromium.org/p/webrtc/issues/detail?id=6552\n        // by adding level-asymmetry-allowed=1\n        if (codec.name === 'H264' &&\n            codec.parameters['level-asymmetry-allowed'] === undefined) {\n          codec.parameters['level-asymmetry-allowed'] = '1';\n        }\n      });\n\n      // generate an ssrc now, to be used later in rtpSender.send\n      var sendEncodingParameters = [{\n        ssrc: (2 * sdpMLineIndex + 1) * 1001\n      }];\n      if (track) {\n        // add RTX\n        if (edgeVersion >= 15019 && kind === 'video') {\n          sendEncodingParameters[0].rtx = {\n            ssrc: (2 * sdpMLineIndex + 1) * 1001 + 1\n          };\n        }\n      }\n\n      if (transceiver.wantReceive) {\n        transceiver.rtpReceiver = new RTCRtpReceiver(transceiver.dtlsTransport,\n            kind);\n      }\n\n      transceiver.localCapabilities = localCapabilities;\n      transceiver.sendEncodingParameters = sendEncodingParameters;\n    });\n\n    // always offer BUNDLE and dispose on return if not supported.\n    if (this._config.bundlePolicy !== 'max-compat') {\n      sdp += 'a=group:BUNDLE ' + transceivers.map(function(t) {\n        return t.mid;\n      }).join(' ') + '\\r\\n';\n    }\n    sdp += 'a=ice-options:trickle\\r\\n';\n\n    transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      sdp += SDPUtils.writeMediaSection(transceiver,\n          transceiver.localCapabilities, 'offer', transceiver.stream);\n      sdp += 'a=rtcp-rsize\\r\\n';\n    });\n\n    this._pendingOffer = transceivers;\n    var desc = new RTCSessionDescription({\n      type: 'offer',\n      sdp: sdp\n    });\n    if (arguments.length && typeof arguments[0] === 'function') {\n      window.setTimeout(arguments[0], 0, desc);\n    }\n    return Promise.resolve(desc);\n  };\n\n  RTCPeerConnection.prototype.createAnswer = function() {\n    var sdp = SDPUtils.writeSessionBoilerplate();\n    if (this.usingBundle) {\n      sdp += 'a=group:BUNDLE ' + this.transceivers.map(function(t) {\n        return t.mid;\n      }).join(' ') + '\\r\\n';\n    }\n    this.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      if (transceiver.isDatachannel) {\n        sdp += 'm=application 0 DTLS/SCTP 5000\\r\\n' +\n            'c=IN IP4 0.0.0.0\\r\\n' +\n            'a=mid:' + transceiver.mid + '\\r\\n';\n        return;\n      }\n\n      // FIXME: look at direction.\n      if (transceiver.stream) {\n        var localTrack;\n        if (transceiver.kind === 'audio') {\n          localTrack = transceiver.stream.getAudioTracks()[0];\n        } else if (transceiver.kind === 'video') {\n          localTrack = transceiver.stream.getVideoTracks()[0];\n        }\n        if (localTrack) {\n          // add RTX\n          if (edgeVersion >= 15019 && transceiver.kind === 'video') {\n            transceiver.sendEncodingParameters[0].rtx = {\n              ssrc: (2 * sdpMLineIndex + 2) * 1001 + 1\n            };\n          }\n        }\n      }\n\n      // Calculate intersection of capabilities.\n      var commonCapabilities = getCommonCapabilities(\n          transceiver.localCapabilities,\n          transceiver.remoteCapabilities);\n\n      var hasRtx = commonCapabilities.codecs.filter(function(c) {\n        return c.name.toLowerCase() === 'rtx';\n      }).length;\n      if (!hasRtx && transceiver.sendEncodingParameters[0].rtx) {\n        delete transceiver.sendEncodingParameters[0].rtx;\n      }\n\n      sdp += SDPUtils.writeMediaSection(transceiver, commonCapabilities,\n          'answer', transceiver.stream);\n      if (transceiver.rtcpParameters &&\n          transceiver.rtcpParameters.reducedSize) {\n        sdp += 'a=rtcp-rsize\\r\\n';\n      }\n    });\n\n    var desc = new RTCSessionDescription({\n      type: 'answer',\n      sdp: sdp\n    });\n    if (arguments.length && typeof arguments[0] === 'function') {\n      window.setTimeout(arguments[0], 0, desc);\n    }\n    return Promise.resolve(desc);\n  };\n\n  RTCPeerConnection.prototype.addIceCandidate = function(candidate) {\n    if (!candidate) {\n      for (var j = 0; j < this.transceivers.length; j++) {\n        this.transceivers[j].iceTransport.addRemoteCandidate({});\n        if (this.usingBundle) {\n          return Promise.resolve();\n        }\n      }\n    } else {\n      var mLineIndex = candidate.sdpMLineIndex;\n      if (candidate.sdpMid) {\n        for (var i = 0; i < this.transceivers.length; i++) {\n          if (this.transceivers[i].mid === candidate.sdpMid) {\n            mLineIndex = i;\n            break;\n          }\n        }\n      }\n      var transceiver = this.transceivers[mLineIndex];\n      if (transceiver) {\n        var cand = Object.keys(candidate.candidate).length > 0 ?\n            SDPUtils.parseCandidate(candidate.candidate) : {};\n        // Ignore Chrome's invalid candidates since Edge does not like them.\n        if (cand.protocol === 'tcp' && (cand.port === 0 || cand.port === 9)) {\n          return Promise.resolve();\n        }\n        // Ignore RTCP candidates, we assume RTCP-MUX.\n        if (cand.component &&\n            !(cand.component === '1' || cand.component === 1)) {\n          return Promise.resolve();\n        }\n        transceiver.iceTransport.addRemoteCandidate(cand);\n\n        // update the remoteDescription.\n        var sections = SDPUtils.splitSections(this.remoteDescription.sdp);\n        sections[mLineIndex + 1] += (cand.type ? candidate.candidate.trim()\n            : 'a=end-of-candidates') + '\\r\\n';\n        this.remoteDescription.sdp = sections.join('');\n      }\n    }\n    if (arguments.length > 1 && typeof arguments[1] === 'function') {\n      window.setTimeout(arguments[1], 0);\n    }\n    return Promise.resolve();\n  };\n\n  RTCPeerConnection.prototype.getStats = function() {\n    var promises = [];\n    this.transceivers.forEach(function(transceiver) {\n      ['rtpSender', 'rtpReceiver', 'iceGatherer', 'iceTransport',\n        'dtlsTransport'].forEach(function(method) {\n          if (transceiver[method]) {\n            promises.push(transceiver[method].getStats());\n          }\n        });\n    });\n    var cb = arguments.length > 1 && typeof arguments[1] === 'function' &&\n        arguments[1];\n    var fixStatsType = function(stat) {\n      return {\n        inboundrtp: 'inbound-rtp',\n        outboundrtp: 'outbound-rtp',\n        candidatepair: 'candidate-pair',\n        localcandidate: 'local-candidate',\n        remotecandidate: 'remote-candidate'\n      }[stat.type] || stat.type;\n    };\n    return new Promise(function(resolve) {\n      // shim getStats with maplike support\n      var results = new Map();\n      Promise.all(promises).then(function(res) {\n        res.forEach(function(result) {\n          Object.keys(result).forEach(function(id) {\n            result[id].type = fixStatsType(result[id]);\n            results.set(id, result[id]);\n          });\n        });\n        if (cb) {\n          window.setTimeout(cb, 0, results);\n        }\n        resolve(results);\n      });\n    });\n  };\n  return RTCPeerConnection;\n};\n\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n\n\nvar browserDetails = __webpack_require__(0).browserDetails;\n\nvar firefoxShim = {\n  shimOnTrack: function() {\n    if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in\n        window.RTCPeerConnection.prototype)) {\n      Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n        get: function() {\n          return this._ontrack;\n        },\n        set: function(f) {\n          if (this._ontrack) {\n            this.removeEventListener('track', this._ontrack);\n            this.removeEventListener('addstream', this._ontrackpoly);\n          }\n          this.addEventListener('track', this._ontrack = f);\n          this.addEventListener('addstream', this._ontrackpoly = function(e) {\n            e.stream.getTracks().forEach(function(track) {\n              var event = new Event('track');\n              event.track = track;\n              event.receiver = {track: track};\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            }.bind(this));\n          }.bind(this));\n        }\n      });\n    }\n  },\n\n  shimSourceObject: function() {\n    // Firefox has supported mozSrcObject since FF22, unprefixed in 42.\n    if (typeof window === 'object') {\n      if (window.HTMLMediaElement &&\n        !('srcObject' in window.HTMLMediaElement.prototype)) {\n        // Shim the srcObject property, once, when HTMLMediaElement is found.\n        Object.defineProperty(window.HTMLMediaElement.prototype, 'srcObject', {\n          get: function() {\n            return this.mozSrcObject;\n          },\n          set: function(stream) {\n            this.mozSrcObject = stream;\n          }\n        });\n      }\n    }\n  },\n\n  shimPeerConnection: function() {\n    if (typeof window !== 'object' || !(window.RTCPeerConnection ||\n        window.mozRTCPeerConnection)) {\n      return; // probably media.peerconnection.enabled=false in about:config\n    }\n    // The RTCPeerConnection object.\n    if (!window.RTCPeerConnection) {\n      window.RTCPeerConnection = function(pcConfig, pcConstraints) {\n        if (browserDetails.version < 38) {\n          // .urls is not supported in FF < 38.\n          // create RTCIceServers with a single url.\n          if (pcConfig && pcConfig.iceServers) {\n            var newIceServers = [];\n            for (var i = 0; i < pcConfig.iceServers.length; i++) {\n              var server = pcConfig.iceServers[i];\n              if (server.hasOwnProperty('urls')) {\n                for (var j = 0; j < server.urls.length; j++) {\n                  var newServer = {\n                    url: server.urls[j]\n                  };\n                  if (server.urls[j].indexOf('turn') === 0) {\n                    newServer.username = server.username;\n                    newServer.credential = server.credential;\n                  }\n                  newIceServers.push(newServer);\n                }\n              } else {\n                newIceServers.push(pcConfig.iceServers[i]);\n              }\n            }\n            pcConfig.iceServers = newIceServers;\n          }\n        }\n        return new mozRTCPeerConnection(pcConfig, pcConstraints);\n      };\n      window.RTCPeerConnection.prototype = mozRTCPeerConnection.prototype;\n\n      // wrap static methods. Currently just generateCertificate.\n      if (mozRTCPeerConnection.generateCertificate) {\n        Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n          get: function() {\n            return mozRTCPeerConnection.generateCertificate;\n          }\n        });\n      }\n\n      window.RTCSessionDescription = mozRTCSessionDescription;\n      window.RTCIceCandidate = mozRTCIceCandidate;\n    }\n\n    // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n        .forEach(function(method) {\n          var nativeMethod = RTCPeerConnection.prototype[method];\n          RTCPeerConnection.prototype[method] = function() {\n            arguments[0] = new ((method === 'addIceCandidate') ?\n                RTCIceCandidate : RTCSessionDescription)(arguments[0]);\n            return nativeMethod.apply(this, arguments);\n          };\n        });\n\n    // support for addIceCandidate(null or undefined)\n    var nativeAddIceCandidate =\n        RTCPeerConnection.prototype.addIceCandidate;\n    RTCPeerConnection.prototype.addIceCandidate = function() {\n      if (!arguments[0]) {\n        if (arguments[1]) {\n          arguments[1].apply(null);\n        }\n        return Promise.resolve();\n      }\n      return nativeAddIceCandidate.apply(this, arguments);\n    };\n\n    // shim getStats with maplike support\n    var makeMapStats = function(stats) {\n      var map = new Map();\n      Object.keys(stats).forEach(function(key) {\n        map.set(key, stats[key]);\n        map[key] = stats[key];\n      });\n      return map;\n    };\n\n    var modernStatsTypes = {\n      inboundrtp: 'inbound-rtp',\n      outboundrtp: 'outbound-rtp',\n      candidatepair: 'candidate-pair',\n      localcandidate: 'local-candidate',\n      remotecandidate: 'remote-candidate'\n    };\n\n    var nativeGetStats = RTCPeerConnection.prototype.getStats;\n    RTCPeerConnection.prototype.getStats = function(selector, onSucc, onErr) {\n      return nativeGetStats.apply(this, [selector || null])\n        .then(function(stats) {\n          if (browserDetails.version < 48) {\n            stats = makeMapStats(stats);\n          }\n          if (browserDetails.version < 53 && !onSucc) {\n            // Shim only promise getStats with spec-hyphens in type names\n            // Leave callback version alone; misc old uses of forEach before Map\n            try {\n              stats.forEach(function(stat) {\n                stat.type = modernStatsTypes[stat.type] || stat.type;\n              });\n            } catch (e) {\n              if (e.name !== 'TypeError') {\n                throw e;\n              }\n              // Avoid TypeError: \"type\" is read-only, in old versions. 34-43ish\n              stats.forEach(function(stat, i) {\n                stats.set(i, Object.assign({}, stat, {\n                  type: modernStatsTypes[stat.type] || stat.type\n                }));\n              });\n            }\n          }\n          return stats;\n        })\n        .then(onSucc, onErr);\n    };\n  }\n};\n\n// Expose public methods.\nmodule.exports = {\n  shimOnTrack: firefoxShim.shimOnTrack,\n  shimSourceObject: firefoxShim.shimSourceObject,\n  shimPeerConnection: firefoxShim.shimPeerConnection,\n  shimGetUserMedia: __webpack_require__(12)\n};\n\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n\n\nvar logging = __webpack_require__(0).log;\nvar browserDetails = __webpack_require__(0).browserDetails;\n\n// Expose public methods.\nmodule.exports = function() {\n  var shimError_ = function(e) {\n    return {\n      name: {\n        InternalError: 'NotReadableError',\n        NotSupportedError: 'TypeError',\n        PermissionDeniedError: 'NotAllowedError',\n        SecurityError: 'NotAllowedError'\n      }[e.name] || e.name,\n      message: {\n        'The operation is insecure.': 'The request is not allowed by the ' +\n        'user agent or the platform in the current context.'\n      }[e.message] || e.message,\n      constraint: e.constraint,\n      toString: function() {\n        return this.name + (this.message && ': ') + this.message;\n      }\n    };\n  };\n\n  // getUserMedia constraints shim.\n  var getUserMedia_ = function(constraints, onSuccess, onError) {\n    var constraintsToFF37_ = function(c) {\n      if (typeof c !== 'object' || c.require) {\n        return c;\n      }\n      var require = [];\n      Object.keys(c).forEach(function(key) {\n        if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n          return;\n        }\n        var r = c[key] = (typeof c[key] === 'object') ?\n            c[key] : {ideal: c[key]};\n        if (r.min !== undefined ||\n            r.max !== undefined || r.exact !== undefined) {\n          require.push(key);\n        }\n        if (r.exact !== undefined) {\n          if (typeof r.exact === 'number') {\n            r. min = r.max = r.exact;\n          } else {\n            c[key] = r.exact;\n          }\n          delete r.exact;\n        }\n        if (r.ideal !== undefined) {\n          c.advanced = c.advanced || [];\n          var oc = {};\n          if (typeof r.ideal === 'number') {\n            oc[key] = {min: r.ideal, max: r.ideal};\n          } else {\n            oc[key] = r.ideal;\n          }\n          c.advanced.push(oc);\n          delete r.ideal;\n          if (!Object.keys(r).length) {\n            delete c[key];\n          }\n        }\n      });\n      if (require.length) {\n        c.require = require;\n      }\n      return c;\n    };\n    constraints = JSON.parse(JSON.stringify(constraints));\n    if (browserDetails.version < 38) {\n      logging('spec: ' + JSON.stringify(constraints));\n      if (constraints.audio) {\n        constraints.audio = constraintsToFF37_(constraints.audio);\n      }\n      if (constraints.video) {\n        constraints.video = constraintsToFF37_(constraints.video);\n      }\n      logging('ff37: ' + JSON.stringify(constraints));\n    }\n    return navigator.mozGetUserMedia(constraints, onSuccess, function(e) {\n      onError(shimError_(e));\n    });\n  };\n\n  // Returns the result of getUserMedia as a Promise.\n  var getUserMediaPromise_ = function(constraints) {\n    return new Promise(function(resolve, reject) {\n      getUserMedia_(constraints, resolve, reject);\n    });\n  };\n\n  // Shim for mediaDevices on older versions.\n  if (!navigator.mediaDevices) {\n    navigator.mediaDevices = {getUserMedia: getUserMediaPromise_,\n      addEventListener: function() { },\n      removeEventListener: function() { }\n    };\n  }\n  navigator.mediaDevices.enumerateDevices =\n      navigator.mediaDevices.enumerateDevices || function() {\n        return new Promise(function(resolve) {\n          var infos = [\n            {kind: 'audioinput', deviceId: 'default', label: '', groupId: ''},\n            {kind: 'videoinput', deviceId: 'default', label: '', groupId: ''}\n          ];\n          resolve(infos);\n        });\n      };\n\n  if (browserDetails.version < 41) {\n    // Work around http://bugzil.la/1169665\n    var orgEnumerateDevices =\n        navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);\n    navigator.mediaDevices.enumerateDevices = function() {\n      return orgEnumerateDevices().then(undefined, function(e) {\n        if (e.name === 'NotFoundError') {\n          return [];\n        }\n        throw e;\n      });\n    };\n  }\n  if (browserDetails.version < 49) {\n    var origGetUserMedia = navigator.mediaDevices.getUserMedia.\n        bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(c) {\n      return origGetUserMedia(c).then(function(stream) {\n        // Work around https://bugzil.la/802326\n        if (c.audio && !stream.getAudioTracks().length ||\n            c.video && !stream.getVideoTracks().length) {\n          stream.getTracks().forEach(function(track) {\n            track.stop();\n          });\n          throw new DOMException('The object can not be found here.',\n                                 'NotFoundError');\n        }\n        return stream;\n      }, function(e) {\n        return Promise.reject(shimError_(e));\n      });\n    };\n  }\n  navigator.getUserMedia = function(constraints, onSuccess, onError) {\n    if (browserDetails.version < 44) {\n      return getUserMedia_(constraints, onSuccess, onError);\n    }\n    // Replace Firefox 44+'s deprecation warning with unprefixed version.\n    console.warn('navigator.getUserMedia has been replaced by ' +\n                 'navigator.mediaDevices.getUserMedia');\n    navigator.mediaDevices.getUserMedia(constraints).then(onSuccess, onError);\n  };\n};\n\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n\nvar safariShim = {\n  // TODO: DrAlex, should be here, double check against LayoutTests\n\n  // TODO: once the back-end for the mac port is done, add.\n  // TODO: check for webkitGTK+\n  // shimPeerConnection: function() { },\n\n  shimAddStream: function() {\n    if (typeof window === 'object' && window.RTCPeerConnection &&\n        !('addStream' in window.RTCPeerConnection.prototype)) {\n      RTCPeerConnection.prototype.addStream = function(stream) {\n        var self = this;\n        stream.getTracks().forEach(function(track) {\n          self.addTrack(track, stream);\n        });\n      };\n    }\n  },\n  shimOnAddStream: function() {\n    if (typeof window === 'object' && window.RTCPeerConnection &&\n        !('onaddstream' in window.RTCPeerConnection.prototype)) {\n      Object.defineProperty(window.RTCPeerConnection.prototype, 'onaddstream', {\n        get: function() {\n          return this._onaddstream;\n        },\n        set: function(f) {\n          if (this._onaddstream) {\n            this.removeEventListener('addstream', this._onaddstream);\n            this.removeEventListener('track', this._onaddstreampoly);\n          }\n          this.addEventListener('addstream', this._onaddstream = f);\n          this.addEventListener('track', this._onaddstreampoly = function(e) {\n            var stream = e.streams[0];\n            if (!this._streams) {\n              this._streams = [];\n            }\n            if (this._streams.indexOf(stream) >= 0) {\n              return;\n            }\n            this._streams.push(stream);\n            var event = new Event('addstream');\n            event.stream = e.streams[0];\n            this.dispatchEvent(event);\n          }.bind(this));\n        }\n      });\n    }\n  },\n  shimCallbacksAPI: function() {\n    if (typeof window !== 'object' || !window.RTCPeerConnection) {\n      return;\n    }\n    var prototype = RTCPeerConnection.prototype;\n    var createOffer = prototype.createOffer;\n    var createAnswer = prototype.createAnswer;\n    var setLocalDescription = prototype.setLocalDescription;\n    var setRemoteDescription = prototype.setRemoteDescription;\n    var addIceCandidate = prototype.addIceCandidate;\n\n    prototype.createOffer = function(successCallback, failureCallback) {\n      var options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      var promise = createOffer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n    prototype.createAnswer = function(successCallback, failureCallback) {\n      var options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      var promise = createAnswer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n    var withCallback = function(description, successCallback, failureCallback) {\n      var promise = setLocalDescription.apply(this, [description]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n    prototype.setLocalDescription = withCallback;\n\n    withCallback = function(description, successCallback, failureCallback) {\n      var promise = setRemoteDescription.apply(this, [description]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n    prototype.setRemoteDescription = withCallback;\n\n    withCallback = function(candidate, successCallback, failureCallback) {\n      var promise = addIceCandidate.apply(this, [candidate]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n    prototype.addIceCandidate = withCallback;\n  },\n  shimGetUserMedia: function() {\n    if (!navigator.getUserMedia) {\n      if (navigator.webkitGetUserMedia) {\n        navigator.getUserMedia = navigator.webkitGetUserMedia.bind(navigator);\n      } else if (navigator.mediaDevices &&\n          navigator.mediaDevices.getUserMedia) {\n        navigator.getUserMedia = function(constraints, cb, errcb) {\n          navigator.mediaDevices.getUserMedia(constraints)\n          .then(cb, errcb);\n        }.bind(navigator);\n      }\n    }\n  }\n};\n\n// Expose public methods.\nmodule.exports = {\n  shimCallbacksAPI: safariShim.shimCallbacksAPI,\n  shimAddStream: safariShim.shimAddStream,\n  shimOnAddStream: safariShim.shimOnAddStream,\n  shimGetUserMedia: safariShim.shimGetUserMedia\n  // TODO\n  // shimPeerConnection: safariShim.shimPeerConnection\n};\n\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\nfunction QRScanner() {\n  var createQRScannerAdapter = __webpack_require__(2);\n  var createQRScannerInternal = __webpack_require__(1);\n\n  var internal = createQRScannerInternal();\n  var functionList = {\n      prepare: internal.prepare,\n      show: internal.show,\n      hide: internal.hide,\n      scan: internal.scan,\n      cancelScan: internal.cancelScan,\n      pausePreview: internal.pausePreview,\n      resumePreview: internal.resumePreview,\n      enableLight: internal.enableLight,\n      disableLight: internal.disableLight,\n      useCamera: internal.useCamera,\n      openSettings: internal.openSettings,\n      getStatus: internal.getStatus,\n      destroy: internal.destroy\n  };\n\n  // always returns an executable function for use by the internal component\n  // if a callback is provided, use it\n  function getFunc(callback){\n    if(typeof callback === \"function\"){\n      return callback;\n    }\n    return function(){\n      // callback is not needed\n      return;\n    };\n  }\n\n  // shim cordova's functionality for library usage\n  var shimCordova = {\n    exec: function(successCallback, errorCallback, className, functionName, inputArray){\n      if(className !== 'QRScanner' || !functionList[functionName]){\n        return errorCallback(0);\n      }\n      if(inputArray){\n        functionList[functionName](getFunc(successCallback), getFunc(errorCallback), inputArray);\n      } else {\n        functionList[functionName](getFunc(successCallback), getFunc(errorCallback));\n      }\n    }\n  };\n\n  var adapter = createQRScannerAdapter(shimCordova);\n  return adapter;\n}\n\nmodule.exports = new QRScanner();\n\n\n/***/ })\n/******/ ]);\n});\n\n\n// WEBPACK FOOTER //\n// cordova-plugin-qrscanner-lib.min.js","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar logDisabled_ = true;\n\n// Utility methods.\nvar utils = {\n  disableLog: function(bool) {\n    if (typeof bool !== 'boolean') {\n      return new Error('Argument type: ' + typeof bool +\n          '. Please use a boolean.');\n    }\n    logDisabled_ = bool;\n    return (bool) ? 'adapter.js logging disabled' :\n        'adapter.js logging enabled';\n  },\n\n  log: function() {\n    if (typeof window === 'object') {\n      if (logDisabled_) {\n        return;\n      }\n      if (typeof console !== 'undefined' && typeof console.log === 'function') {\n        console.log.apply(console, arguments);\n      }\n    }\n  },\n\n  /**\n   * Extract browser version out of the provided user agent string.\n   *\n   * @param {!string} uastring userAgent string.\n   * @param {!string} expr Regular expression used as match criteria.\n   * @param {!number} pos position in the version string to be returned.\n   * @return {!number} browser version.\n   */\n  extractVersion: function(uastring, expr, pos) {\n    var match = uastring.match(expr);\n    return match && match.length >= pos && parseInt(match[pos], 10);\n  },\n\n  /**\n   * Browser detector.\n   *\n   * @return {object} result containing browser and version\n   *     properties.\n   */\n  detectBrowser: function() {\n    // Returned result object.\n    var result = {};\n    result.browser = null;\n    result.version = null;\n\n    // Fail early if it's not a browser\n    if (typeof window === 'undefined' || !window.navigator) {\n      result.browser = 'Not a browser.';\n      return result;\n    }\n\n    // Firefox.\n    if (navigator.mozGetUserMedia) {\n      result.browser = 'firefox';\n      result.version = this.extractVersion(navigator.userAgent,\n          /Firefox\\/(\\d+)\\./, 1);\n    } else if (navigator.webkitGetUserMedia) {\n      // Chrome, Chromium, Webview, Opera, all use the chrome shim for now\n      if (window.webkitRTCPeerConnection) {\n        result.browser = 'chrome';\n        result.version = this.extractVersion(navigator.userAgent,\n          /Chrom(e|ium)\\/(\\d+)\\./, 2);\n      } else { // Safari (in an unpublished version) or unknown webkit-based.\n        if (navigator.userAgent.match(/Version\\/(\\d+).(\\d+)/)) {\n          result.browser = 'safari';\n          result.version = this.extractVersion(navigator.userAgent,\n            /AppleWebKit\\/(\\d+)\\./, 1);\n        } else { // unknown webkit-based browser.\n          result.browser = 'Unsupported webkit-based browser ' +\n              'with GUM support but no WebRTC support.';\n          return result;\n        }\n      }\n    } else if (navigator.mediaDevices &&\n        navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/)) { // Edge.\n      result.browser = 'edge';\n      result.version = this.extractVersion(navigator.userAgent,\n          /Edge\\/(\\d+).(\\d+)$/, 2);\n    } else if (navigator.mediaDevices &&\n        navigator.userAgent.match(/AppleWebKit\\/(\\d+)\\./)) {\n        // Safari, with webkitGetUserMedia removed.\n      result.browser = 'safari';\n      result.version = this.extractVersion(navigator.userAgent,\n          /AppleWebKit\\/(\\d+)\\./, 1);\n    } else { // Default fallthrough: not supported.\n      result.browser = 'Not a supported browser.';\n      return result;\n    }\n\n    return result;\n  },\n\n  // shimCreateObjectURL must be called before shimSourceObject to avoid loop.\n\n  shimCreateObjectURL: function() {\n    if (!(typeof window === 'object' && window.HTMLMediaElement &&\n          'srcObject' in window.HTMLMediaElement.prototype)) {\n      // Only shim CreateObjectURL using srcObject if srcObject exists.\n      return undefined;\n    }\n\n    var nativeCreateObjectURL = URL.createObjectURL.bind(URL);\n    var nativeRevokeObjectURL = URL.revokeObjectURL.bind(URL);\n    var streams = new Map(), newId = 0;\n\n    URL.createObjectURL = function(stream) {\n      if ('getTracks' in stream) {\n        var url = 'polyblob:' + (++newId);\n        streams.set(url, stream);\n        console.log('URL.createObjectURL(stream) is deprecated! ' +\n                    'Use elem.srcObject = stream instead!');\n        return url;\n      }\n      return nativeCreateObjectURL(stream);\n    };\n    URL.revokeObjectURL = function(url) {\n      nativeRevokeObjectURL(url);\n      streams.delete(url);\n    };\n\n    var dsc = Object.getOwnPropertyDescriptor(window.HTMLMediaElement.prototype,\n                                              'src');\n    Object.defineProperty(window.HTMLMediaElement.prototype, 'src', {\n      get: function() {\n        return dsc.get.apply(this);\n      },\n      set: function(url) {\n        this.srcObject = streams.get(url) || null;\n        return dsc.set.apply(this, [url]);\n      }\n    });\n\n    var nativeSetAttribute = HTMLMediaElement.prototype.setAttribute;\n    HTMLMediaElement.prototype.setAttribute = function() {\n      if (arguments.length === 2 &&\n          ('' + arguments[0]).toLowerCase() === 'src') {\n        this.srcObject = streams.get(arguments[1]) || null;\n      }\n      return nativeSetAttribute.apply(this, arguments);\n    };\n  }\n};\n\n// Export.\nmodule.exports = {\n  log: utils.log,\n  disableLog: utils.disableLog,\n  browserDetails: utils.detectBrowser(),\n  extractVersion: utils.extractVersion,\n  shimCreateObjectURL: utils.shimCreateObjectURL,\n  detectBrowser: utils.detectBrowser.bind(utils)\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/webrtc-adapter/src/js/utils.js\n// module id = 0\n// module chunks = 0","require('webrtc-adapter');\nvar workerScript = require(\"raw-loader!../worker.min.js\");\n\nmodule.exports = function(){\n\n  var ELEMENTS = {\n    preview: 'cordova-plugin-qrscanner-video-preview',\n    still: 'cordova-plugin-qrscanner-still'\n  };\n  var ZINDEXES = {\n    preview: -100,\n    still: -99\n  };\n  var backCamera = null;\n  var frontCamera = null;\n  var currentCamera = 0;\n  var activeMediaStream = null;\n  var scanning = false;\n  var previewing = false;\n  var scanWorker = null;\n  var thisScanCycle = null;\n  var nextScan = null;\n  var cancelNextScan = null;\n\n  // standard screen widths/heights, from 4k down to 320x240\n  // widths and heights are each tested separately to account for screen rotation\n  var standardWidthsAndHeights = [\n    5120, 4096, 3840, 3440, 3200, 3072, 3000, 2880, 2800, 2736, 2732, 2560,\n    2538, 2400, 2304, 2160, 2100, 2048, 2000, 1920, 1856, 1824, 1800, 1792,\n    1776, 1728, 1700, 1680, 1600, 1536, 1440, 1400, 1392, 1366, 1344, 1334,\n    1280, 1200, 1152, 1136, 1120, 1080, 1050, 1024, 1000, 960, 900, 854, 848,\n    832, 800, 768, 750, 720, 640, 624, 600, 576, 544, 540, 512, 480, 320, 240\n  ];\n\n  var facingModes = [\n    'environment',\n    'user'\n  ];\n\n  //utils\n  function killStream(mediaStream){\n    mediaStream.getTracks().forEach(function(track){\n      track.stop();\n    });\n  }\n\n  // For performance, we test best-to-worst constraints. Once we find a match,\n  // we move to the next test. Since `ConstraintNotSatisfiedError`s are thrown\n  // much faster than streams can be started and stopped, the scan is much\n  // faster, even though it may iterate through more constraint objects.\n  function getCameraSpecsById(deviceId){\n\n    // return a getUserMedia Constraints\n    function getConstraintObj(deviceId, facingMode, width, height){\n      var obj = { audio: false, video: {} };\n      obj.video.deviceId = {exact: deviceId};\n      if(facingMode) {\n        obj.video.facingMode = {exact: facingMode};\n      }\n      if(width) {\n        obj.video.width = {exact: width};\n      }\n      if(height) {\n        obj.video.height = {exact: height};\n      }\n      return obj;\n    }\n\n    var facingModeConstraints = facingModes.map(function(mode){\n    \treturn getConstraintObj(deviceId, mode);\n    });\n    var widthConstraints = standardWidthsAndHeights.map(function(width){\n    \treturn getConstraintObj(deviceId, null, width);\n    });\n    var heightConstraints = standardWidthsAndHeights.map(function(height){\n    \treturn getConstraintObj(deviceId, null, null, height);\n    });\n\n    // create a promise which tries to resolve the best constraints for this deviceId\n    // rather than reject, failures return a value of `null`\n    function getFirstResolvingConstraint(constraintsBestToWorst){\n      return new Promise(function(resolveBestConstraints){\n        // build a chain of promises which either resolves or continues searching\n        return constraintsBestToWorst.reduce(function(chain, next){\n          return chain.then(function(searchState){\n            if(searchState.found){\n              // The best working constraint was found. Skip further tests.\n              return searchState;\n            } else {\n              searchState.nextConstraint = next;\n              return window.navigator.mediaDevices.getUserMedia(searchState.nextConstraint).then(function(mediaStream){\n                // We found the first working constraint object, now we can stop\n                // the stream and short-circuit the search.\n                killStream(mediaStream);\n                searchState.found = true;\n                return searchState;\n              }, function(){\n                // didn't get a media stream. The search continues:\n                return searchState;\n              });\n            }\n          });\n        }, Promise.resolve({\n          // kick off the search:\n          found: false,\n          nextConstraint: {}\n        })).then(function(searchState){\n          if(searchState.found){\n            resolveBestConstraints(searchState.nextConstraint);\n          } else {\n            resolveBestConstraints(null);\n          }\n        });\n      });\n    }\n\n    return getFirstResolvingConstraint(facingModeConstraints).then(function(facingModeSpecs){\n      return getFirstResolvingConstraint(widthConstraints).then(function(widthSpecs){\n        return getFirstResolvingConstraint(heightConstraints).then(function(heightSpecs){\n          return {\n            deviceId: deviceId,\n            facingMode: facingModeSpecs === null ? null : facingModeSpecs.video.facingMode.exact,\n            width: widthSpecs === null ? null : widthSpecs.video.width.exact,\n            height: heightSpecs === null ? null : heightSpecs.video.height.exact\n          };\n        });\n      });\n    });\n  }\n\n  function chooseCameras(){\n    var devices = window.navigator.mediaDevices.enumerateDevices();\n    return devices.then(function(mediaDeviceInfoList){\n      var videoDeviceIds = mediaDeviceInfoList.filter(function(elem){\n        return elem.kind === 'videoinput';\n      }).map(function(elem){\n        return elem.deviceId;\n      });\n      return videoDeviceIds;\n    }).then(function(videoDeviceIds){\n      // there is no standardized way for us to get the specs of each camera\n      // (due to concerns over user fingerprinting), so we're forced to\n      // iteratively test each camera for it's capabilities\n      var searches = [];\n      videoDeviceIds.forEach(function(id){\n        searches.push(getCameraSpecsById(id));\n      });\n      return Promise.all(searches);\n    }).then(function(cameraSpecsArray){\n      return cameraSpecsArray.filter(function(camera){\n        // filter out any cameras where width and height could not be captured\n        if(camera !== null && camera.width !== null && camera.height !== null){\n          return true;\n        }\n      }).sort(function(a, b){\n        // sort cameras from highest resolution (by width) to lowest\n        return b.width - a.width;\n      });\n    }).then(function(bestToWorstCameras){\n      var backCamera = null,\n          frontCamera = null;\n      // choose backCamera\n      for(var i = 0; i < bestToWorstCameras.length; i++){\n        if (bestToWorstCameras[i].facingMode === 'environment'){\n          backCamera = bestToWorstCameras[i];\n          // (shouldn't be used for frontCamera)\n          bestToWorstCameras.splice(i, 1);\n          break;\n        }\n      }\n      // if no back-facing cameras were found, choose the highest resolution\n      if(backCamera === null){\n        if(bestToWorstCameras.length > 0){\n          backCamera = bestToWorstCameras[0];\n          // (shouldn't be used for frontCamera)\n          bestToWorstCameras.splice(0, 1);\n        } else {\n          // user doesn't have any available cameras\n          backCamera = false;\n        }\n      }\n      if(bestToWorstCameras.length > 0){\n        // frontCamera should simply be the next-best resolution camera\n        frontCamera = bestToWorstCameras[0];\n      } else {\n        // user doesn't have any more cameras\n        frontCamera = false;\n      }\n      return {\n        backCamera: backCamera,\n        frontCamera: frontCamera\n      };\n    });\n  }\n\n  function mediaStreamIsActive(){\n    return activeMediaStream !== null;\n  }\n\n  function killActiveMediaStream(){\n    killStream(activeMediaStream);\n    activeMediaStream = null;\n  }\n\n  function getVideoPreview(){\n    return document.getElementById(ELEMENTS.preview);\n  }\n\n  function getImg(){\n    return document.getElementById(ELEMENTS.still);\n  }\n\n  function getCurrentCameraIndex(){\n    return currentCamera;\n  }\n\n  function getCurrentCamera(){\n    return currentCamera === 1 ? frontCamera : backCamera;\n  }\n\n  function bringStillToFront(){\n    var img = getImg();\n    if(img){\n      img.style.visibility = 'visible';\n      previewing = false;\n    }\n  }\n\n  function bringPreviewToFront(){\n    var img = getImg();\n    if(img){\n      img.style.visibility = 'hidden';\n      previewing = true;\n    }\n  }\n\n  function isInitialized(){\n    return backCamera !== null;\n  }\n\n  function canChangeCamera(){\n    return !!backCamera && !!frontCamera;\n  }\n\n  function calcStatus(){\n    return {\n      // !authorized means the user either has no camera or has denied access.\n      // This would leave a value of `null` before prepare(), and `false` after.\n      authorized: (backCamera !== null && backCamera !== false)? '1': '0',\n      // No applicable API\n      denied: '0',\n      // No applicable API\n      restricted: '0',\n      prepared: isInitialized() ? '1' : '0',\n      scanning: scanning? '1' : '0',\n      previewing: previewing? '1' : '0',\n      // We leave this true after prepare() to match the mobile experience as\n      // closely as possible. (Without additional covering, the preview will\n      // always be visible to the user).\n      showing: getVideoPreview()? '1' : '0',\n      // No applicable API\n      lightEnabled: '0',\n      // No applicable API\n      canOpenSettings: '0',\n      // No applicable API\n      canEnableLight: '0',\n      canChangeCamera: canChangeCamera() ? '1' : '0',\n      currentCamera: currentCamera.toString()\n    };\n  }\n\n  function startCamera(success, error){\n      var currentCameraIndex = getCurrentCameraIndex();\n      var currentCamera = getCurrentCamera();\n      window.navigator.mediaDevices.getUserMedia({\n        audio: false,\n        video: {\n          deviceId: {exact: currentCamera.deviceId},\n          width: {ideal: currentCamera.width},\n          height: {ideal: currentCamera.height}\n        }\n      }).then(function(mediaStream){\n        activeMediaStream = mediaStream;\n        var video = getVideoPreview();\n        video.src = URL.createObjectURL(mediaStream);\n        success(calcStatus());\n      }, function(err){\n        // something bad happened\n        err = null;\n        var code = currentCameraIndex? 4 : 3;\n        error(code); // FRONT_CAMERA_UNAVAILABLE : BACK_CAMERA_UNAVAILABLE\n      });\n  }\n\n  function getTempCanvasAndContext(videoElement){\n    var tempCanvas = document.createElement('canvas');\n    var camera = getCurrentCamera();\n    tempCanvas.height = camera.height;\n    tempCanvas.width = camera.width;\n    var tempCanvasContext = tempCanvas.getContext('2d');\n    tempCanvasContext.drawImage(videoElement, 0, 0, camera.width, camera.height);\n    return {\n      canvas: tempCanvas,\n      context: tempCanvasContext\n    };\n  }\n\n  function getCurrentImageData(videoElement){\n    var snapshot = getTempCanvasAndContext(videoElement);\n    return snapshot.context.getImageData(0, 0, snapshot.canvas.width, snapshot.canvas.height);\n  }\n\n  // take a screenshot of the video preview with a temp canvas\n  function captureCurrentFrame(videoElement){\n    return getTempCanvasAndContext(videoElement).canvas.toDataURL('image/png');\n  }\n\n  function initialize(success, error){\n    if(scanWorker === null){\n      var workerBlob = new Blob([workerScript],{type: \"text/javascript\"});\n      scanWorker = new Worker(URL.createObjectURL(workerBlob));\n    }\n    if(!getVideoPreview()){\n      // prepare DOM (sync)\n      var videoPreview = document.createElement('video');\n      videoPreview.setAttribute('autoplay', 'autoplay');\n      videoPreview.setAttribute('id', ELEMENTS.preview);\n      videoPreview.setAttribute('style', 'display:block;position:fixed;top:50%;left:50%;' +\n      'width:auto;height:auto;min-width:100%;min-height:100%;z-index:' + ZINDEXES.preview +\n      ';-moz-transform: translateX(-50%) translateY(-50%);-webkit-transform: ' +\n      'translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);' +\n      'background-size:cover;background-position:50% 50%;background-color:#FFF;');\n      videoPreview.addEventListener('loadeddata', function(){\n        bringPreviewToFront();\n      });\n\n      var stillImg = document.createElement('div');\n      stillImg.setAttribute('id', ELEMENTS.still);\n      stillImg.setAttribute('style', 'display:block;position:fixed;top:50%;left:50%;visibility: hidden;' +\n      'width:auto;height:auto;min-width:100%;min-height:100%;z-index:' + ZINDEXES.still +\n      ';-moz-transform: translateX(-50%) translateY(-50%);-webkit-transform: ' +\n      'translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);' +\n      'background-size:cover;background-position:50% 50%;background-color:#FFF;');\n\n      document.body.appendChild(videoPreview);\n      document.body.appendChild(stillImg);\n    }\n    if(backCamera === null){\n      // set instance cameras\n      chooseCameras().then(function(cameras){\n        backCamera = cameras.backCamera;\n        frontCamera = cameras.frontCamera;\n        if(backCamera !== false){\n          success();\n        } else {\n          error(5); // CAMERA_UNAVAILABLE\n        }\n      }, function(err){\n        // something bad happened\n        err = null;\n        error(0); // UNEXPECTED_ERROR\n      });\n    } else if (backCamera === false){\n      error(5); // CAMERA_UNAVAILABLE\n    } else {\n      success();\n    }\n  }\n\n  /*\n   *  --- Begin Public API ---\n   */\n\n  function prepare(success, error){\n    initialize(function(){\n      // return status on success\n      success(calcStatus());\n    },\n    // pass errors through\n    error);\n  }\n\n  function show(success, error){\n    function showCamera(){\n      if(!mediaStreamIsActive()){\n        startCamera(success, error);\n      } else {\n        success(calcStatus());\n      }\n    }\n    if(!isInitialized()){\n      initialize(function(){\n        // on successful initialization, attempt to showCamera\n        showCamera();\n      },\n      // pass errors through\n      error);\n    } else {\n      showCamera();\n    }\n  }\n\n  function hide(success, error){\n    error = null; // should never error\n    if(mediaStreamIsActive()){\n      killActiveMediaStream();\n    }\n    var video = getVideoPreview();\n    if(video){\n      video.src = '';\n    }\n    success(calcStatus());\n  }\n\n  function scan(success, error) {\n    // initialize and start video preview if not already active\n    show(function(ignore){\n      // ignore success output – `scan` method callback should be passed the decoded data\n      ignore = null;\n      var video = getVideoPreview();\n      var returned = false;\n      scanning = true;\n      scanWorker.onmessage = function(event){\n        var obj = event.data;\n        if(obj.result && !returned){\n          returned = true;\n          thisScanCycle = null;\n          success(obj.result);\n        }\n      };\n      thisScanCycle = function(){\n        scanWorker.postMessage(getCurrentImageData(video));\n        if(cancelNextScan !== null){\n          // avoid race conditions, always clear before starting a cycle\n          cancelNextScan();\n        }\n        // interval in milliseconds at which to try decoding the QR code\n        var SCAN_INTERVAL = window.QRScanner_SCAN_INTERVAL || 130;\n        // this value can be adjusted on-the-fly (while a scan is active) to\n        // balance scan speed vs. CPU/power usage\n        nextScan = window.setTimeout(thisScanCycle, SCAN_INTERVAL);\n        cancelNextScan = function(sendError){\n          window.clearTimeout(nextScan);\n          nextScan = null;\n          cancelNextScan = null;\n          if(sendError){\n            error(6); // SCAN_CANCELED\n          }\n        };\n      };\n      thisScanCycle();\n    }, error);\n  }\n\n  function cancelScan(success, error){\n    error = null; // should never error\n    if(cancelNextScan !== null){\n      cancelNextScan(true);\n    }\n    scanning = false;\n    if(typeof success === \"function\"){\n      success(calcStatus());\n    }\n  }\n\n  function pausePreview(success, error){\n    error = null; // should never error\n    if(mediaStreamIsActive()){\n      // pause scanning too\n      if(cancelNextScan !== null){\n        cancelNextScan();\n      }\n      var video = getVideoPreview();\n      video.pause();\n      var img = new Image();\n      img.src = captureCurrentFrame(video);\n      getImg().style.backgroundImage = 'url(' + img.src + ')';\n      bringStillToFront();\n      // kill the active stream to turn off the privacy light (the screenshot\n      // in the stillImg will remain visible)\n      killActiveMediaStream();\n      success(calcStatus());\n    } else {\n      success(calcStatus());\n    }\n  }\n\n  function resumePreview(success, error){\n    // if a scan was happening, resume it\n    if(thisScanCycle !== null){\n      thisScanCycle();\n    }\n    show(success, error);\n  }\n\n  function enableLight(success, error){\n    error(7); //LIGHT_UNAVAILABLE\n  }\n\n  function disableLight(success, error){\n    error(7); //LIGHT_UNAVAILABLE\n  }\n\n  function useCamera(success, error, array){\n    var requestedCamera = array[0];\n    var initialized = isInitialized();\n    if(requestedCamera !== currentCamera){\n      if(initialized && requestedCamera === 1 && !canChangeCamera()){\n          error(4); //FRONT_CAMERA_UNAVAILABLE\n      } else {\n        currentCamera = requestedCamera;\n        if(initialized){\n          hide(function(status){\n            // Don't need this one\n            status = null;\n          });\n          show(success, error);\n        } else {\n          success(calcStatus());\n        }\n      }\n    } else {\n      success(calcStatus());\n    }\n  }\n\n  function openSettings(success, error){\n    error(8); //OPEN_SETTINGS_UNAVAILABLE\n  }\n\n  function getStatus(success, error){\n    error = null; // should never error\n    success(calcStatus());\n  }\n\n  // Reset all instance variables to their original state.\n  // This method might be useful in cases where a new camera is available, and\n  // the application needs to force the plugin to chooseCameras() again.\n  function destroy(success, error){\n    error = null; // should never error\n    cancelScan();\n    if(mediaStreamIsActive()){\n      killActiveMediaStream();\n    }\n    backCamera = null;\n    frontCamera = null;\n    var preview = getVideoPreview();\n    var still = getImg();\n    if(preview){\n      preview.remove();\n    }\n    if(still){\n      still.remove();\n    }\n    success(calcStatus());\n  }\n\n  return {\n      prepare: prepare,\n      show: show,\n      hide: hide,\n      scan: scan,\n      cancelScan: cancelScan,\n      pausePreview: pausePreview,\n      resumePreview: resumePreview,\n      enableLight: enableLight,\n      disableLight: disableLight,\n      useCamera: useCamera,\n      openSettings: openSettings,\n      getStatus: getStatus,\n      destroy: destroy\n  };\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/browser/src/createQRScannerInternal.js\n// module id = 1\n// module chunks = 0","module.exports = function createQRScanner(cordova){\n// The native implementations should return their status as ['string':'string']\n// dictionaries. Boolean values are encoded to '0' and '1', respectively.\nfunction stringToBool(string) {\n  switch (string) {\n    case '1':\n      return true;\n    case '0':\n      return false;\n    default:\n    throw new Error('QRScanner plugin returned an invalid boolean number-string: ' + string);\n  }\n}\n\n// Converts the returned ['string':'string'] dictionary to a status object.\nfunction convertStatus(statusDictionary) {\n  return {\n    authorized: stringToBool(statusDictionary.authorized),\n    denied: stringToBool(statusDictionary.denied),\n    restricted: stringToBool(statusDictionary.restricted),\n    prepared: stringToBool(statusDictionary.prepared),\n    scanning: stringToBool(statusDictionary.scanning),\n    previewing: stringToBool(statusDictionary.previewing),\n    showing: stringToBool(statusDictionary.showing),\n    lightEnabled: stringToBool(statusDictionary.lightEnabled),\n    canOpenSettings: stringToBool(statusDictionary.canOpenSettings),\n    canEnableLight: stringToBool(statusDictionary.canEnableLight),\n    canChangeCamera: stringToBool(statusDictionary.canChangeCamera),\n    currentCamera: parseInt(statusDictionary.currentCamera)\n  };\n}\n\n// Simple utility method to ensure the background is transparent. Used by the\n// plugin to force re-rendering immediately after the native webview background\n// is made transparent.\nfunction clearBackground() {\n  var body = document.body;\n  if (body.style) {\n    body.style.backgroundColor = 'rgba(0,0,0,0.01)';\n    body.style.backgroundImage = '';\n    setTimeout(function() {\n      body.style.backgroundColor = 'transparent';\n    }, 1);\n    if (body.parentNode && body.parentNode.style) {\n      body.parentNode.style.backgroundColor = 'transparent';\n      body.parentNode.style.backgroundImage = '';\n    }\n  }\n}\n\nfunction errorCallback(callback) {\n  if (!callback) {\n    return null;\n  }\n  return function(error) {\n    var errorCode = parseInt(error);\n    var QRScannerError = {};\n    switch (errorCode) {\n      case 0:\n        QRScannerError = {\n          name: 'UNEXPECTED_ERROR',\n          code: 0,\n          _message: 'QRScanner experienced an unexpected error.'\n        };\n        break;\n      case 1:\n        QRScannerError = {\n          name: 'CAMERA_ACCESS_DENIED',\n          code: 1,\n          _message: 'The user denied camera access.'\n        };\n        break;\n      case 2:\n        QRScannerError = {\n          name: 'CAMERA_ACCESS_RESTRICTED',\n          code: 2,\n          _message: 'Camera access is restricted.'\n        };\n        break;\n      case 3:\n        QRScannerError = {\n          name: 'BACK_CAMERA_UNAVAILABLE',\n          code: 3,\n          _message: 'The back camera is unavailable.'\n        };\n        break;\n      case 4:\n        QRScannerError = {\n          name: 'FRONT_CAMERA_UNAVAILABLE',\n          code: 4,\n          _message: 'The front camera is unavailable.'\n        };\n        break;\n      case 5:\n        QRScannerError = {\n          name: 'CAMERA_UNAVAILABLE',\n          code: 5,\n          _message: 'The camera is unavailable.'\n        };\n        break;\n      case 6:\n        QRScannerError = {\n          name: 'SCAN_CANCELED',\n          code: 6,\n          _message: 'Scan was canceled.'\n        };\n        break;\n      case 7:\n        QRScannerError = {\n          name: 'LIGHT_UNAVAILABLE',\n          code: 7,\n          _message: 'The device light is unavailable.'\n        };\n        break;\n      case 8:\n        // Open settings is only available on iOS 8.0+.\n        QRScannerError = {\n          name: 'OPEN_SETTINGS_UNAVAILABLE',\n          code: 8,\n          _message: 'The device is unable to open settings.'\n        };\n        break;\n      default:\n        QRScannerError = {\n          name: 'UNEXPECTED_ERROR',\n          code: 0,\n          _message: 'QRScanner returned an invalid error code.'\n        };\n        break;\n    }\n    callback(QRScannerError);\n  };\n}\n\nfunction successCallback(callback) {\n  if (!callback) {\n    return null;\n  }\n  return function(statusDict) {\n    callback(null, convertStatus(statusDict));\n  };\n}\n\nfunction doneCallback(callback, clear) {\n  if (!callback) {\n    return null;\n  }\n  return function(statusDict) {\n    if (clear) {\n      clearBackground();\n    }\n    callback(convertStatus(statusDict));\n  };\n}\n\nreturn {\n  prepare: function(callback) {\n    cordova.exec(successCallback(callback), errorCallback(callback), 'QRScanner', 'prepare', []);\n  },\n  destroy: function(callback) {\n    cordova.exec(doneCallback(callback, true), null, 'QRScanner', 'destroy', []);\n  },\n  scan: function(callback) {\n    if (!callback) {\n      throw new Error('No callback provided to scan method.');\n    }\n    var success = function(result) {\n      callback(null, result);\n    };\n    cordova.exec(success, errorCallback(callback), 'QRScanner', 'scan', []);\n  },\n  cancelScan: function(callback) {\n    cordova.exec(doneCallback(callback), null, 'QRScanner', 'cancelScan', []);\n  },\n  show: function(callback) {\n    cordova.exec(doneCallback(callback, true), null, 'QRScanner', 'show', []);\n  },\n  hide: function(callback) {\n    cordova.exec(doneCallback(callback, true), null, 'QRScanner', 'hide', []);\n  },\n  pausePreview: function(callback) {\n    cordova.exec(doneCallback(callback), null, 'QRScanner', 'pausePreview', []);\n  },\n  resumePreview: function(callback) {\n    cordova.exec(doneCallback(callback), null, 'QRScanner', 'resumePreview', []);\n  },\n  enableLight: function(callback) {\n    cordova.exec(successCallback(callback), errorCallback(callback), 'QRScanner', 'enableLight', []);\n  },\n  disableLight: function(callback) {\n    cordova.exec(successCallback(callback), errorCallback(callback), 'QRScanner', 'disableLight', []);\n  },\n  useCamera: function(index, callback) {\n    cordova.exec(successCallback(callback), errorCallback(callback), 'QRScanner', 'useCamera', [index]);\n  },\n  useFrontCamera: function(callback) {\n    var frontCamera = 1;\n    if (callback) {\n      this.useCamera(frontCamera, callback);\n    } else {\n      cordova.exec(null, null, 'QRScanner', 'useCamera', [frontCamera]);\n    }\n  },\n  useBackCamera: function(callback) {\n    var backCamera = 0;\n    if (callback) {\n      this.useCamera(backCamera, callback);\n    } else {\n      cordova.exec(null, null, 'QRScanner', 'useCamera', [backCamera]);\n    }\n  },\n  openSettings: function(callback) {\n    if (callback) {\n      cordova.exec(successCallback(callback), errorCallback(callback), 'QRScanner', 'openSettings', []);\n    } else {\n      cordova.exec(null, null, 'QRScanner', 'openSettings', []);\n    }\n  },\n  getStatus: function(callback) {\n    if (!callback) {\n      throw new Error('No callback provided to getStatus method.');\n    }\n    cordova.exec(doneCallback(callback), null, 'QRScanner', 'getStatus', []);\n  }\n};\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/common/src/createQRScannerAdapter.js\n// module id = 2\n// module chunks = 0","module.exports = \"!function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,\\\"a\\\",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p=\\\"\\\",e(e.s=19)}([function(t,e,n){\\\"use strict\\\";function i(){this.imagedata=null,this.width=0,this.height=0,this.qrCodeSymbol=null,this.debug=!1,this.callback=null}function r(t,e){return t>=0?t>>e:(t>>e)+(2<<~e)}n.d(e,\\\"b\\\",function(){return s}),e.a=i,e.c=r;var o=n(14),a=n(13),s={};s.sizeOfDataLengthInfo=[[10,9,8,8],[12,11,16,10],[14,13,16,12]],i.prototype.decode=function(t,e){var n=function(){try{this.error=void 0,this.result=this.process(this.imagedata)}catch(t){this.error=t,this.result=void 0}return null!=this.callback&&this.callback(this.error,this.result),this.result}.bind(this);if(void 0!=t&&void 0!=t.width)this.width=t.width,this.height=t.height,this.imagedata={data:e||t.data},this.imagedata.width=t.width,this.imagedata.height=t.height,n();else{if(\\\"undefined\\\"==typeof Image)throw new Error(\\\"This source format is not supported in your environment, you need to pass an image buffer with width and height (see https://github.com/edi9999/jsqrcode/blob/master/test/qrcode.js)\\\");var i=new Image;i.crossOrigin=\\\"Anonymous\\\",i.onload=function(){var t=document.createElement(\\\"canvas\\\"),e=t.getContext(\\\"2d\\\"),r=document.getElementById(\\\"out-canvas\\\");if(null!=r){var o=r.getContext(\\\"2d\\\");o.clearRect(0,0,320,240),o.drawImage(i,0,0,320,240)}t.width=i.width,t.height=i.height,e.drawImage(i,0,0),this.width=i.width,this.height=i.height;try{this.imagedata=e.getImageData(0,0,i.width,i.height)}catch(t){if(this.result=\\\"Cross domain image reading not supported in your browser! Save it to your computer then drag and drop the file!\\\",null!=this.callback)return this.callback(null,this.result)}n()}.bind(this),i.src=t}},i.prototype.decode_utf8=function(t){return decodeURIComponent(escape(t))},i.prototype.process=function(t){for(var e=(new Date).getTime(),n=this.grayScaleToBitmap(this.grayscale(t)),i=new o.a(n),r=i.detect(),s=a.a.decode(r.bits),h=s.DataByte,f=\\\"\\\",w=0;w<h.length;w++)for(var u=0;u<h[w].length;u++)f+=String.fromCharCode(h[w][u]);var l=(new Date).getTime(),c=l-e;return this.debug&&console.log(\\\"QR Code processing time (ms): \\\"+c),{result:this.decode_utf8(f),points:r.points}},i.prototype.getPixel=function(t,e,n){if(t.width<e)throw\\\"point error\\\";if(t.height<n)throw\\\"point error\\\";var i=4*e+n*t.width*4;return(33*t.data[i]+34*t.data[i+1]+33*t.data[i+2])/100},i.prototype.binarize=function(t){for(var e=new Array(this.width*this.height),n=0;n<this.height;n++)for(var i=0;i<this.width;i++){var r=this.getPixel(i,n);e[i+n*this.width]=r<=t}return e},i.prototype.getMiddleBrightnessPerArea=function(t){for(var e=Math.floor(t.width/4),n=Math.floor(t.height/4),i=new Array(4),r=0;r<4;r++){i[r]=new Array(4);for(var o=0;o<4;o++)i[r][o]=[0,0]}for(var a=0;a<4;a++)for(var s=0;s<4;s++){i[s][a][0]=255;for(var h=0;h<n;h++)for(var f=0;f<e;f++){var w=t.data[e*s+f+(n*a+h)*t.width];w<i[s][a][0]&&(i[s][a][0]=w),w>i[s][a][1]&&(i[s][a][1]=w)}}for(var u=new Array(4),l=0;l<4;l++)u[l]=new Array(4);for(var a=0;a<4;a++)for(var s=0;s<4;s++)u[s][a]=Math.floor((i[s][a][0]+i[s][a][1])/2);return u},i.prototype.grayScaleToBitmap=function(t){for(var e=this.getMiddleBrightnessPerArea(t),n=e.length,i=Math.floor(t.width/n),r=Math.floor(t.height/n),o=0;o<n;o++)for(var a=0;a<n;a++)for(var s=0;s<r;s++)for(var h=0;h<i;h++)t.data[i*a+h+(r*o+s)*t.width]=t.data[i*a+h+(r*o+s)*t.width]<e[a][o];return t},i.prototype.grayscale=function(t){for(var e=new Array(t.width*t.height),n=0;n<t.height;n++)for(var i=0;i<t.width;i++){var r=this.getPixel(t,i,n);e[i+n*t.width]=r}return{height:t.height,width:t.width,data:e}}},function(t,e,n){\\\"use strict\\\";function i(t,e){if(e||(e=t),t<1||e<1)throw\\\"Both dimensions must be greater than 0\\\";this.width=t,this.height=e;var n=t>>5;0!=(31&t)&&n++,this.rowSize=n,this.bits=new Array(n*e);for(var i=0;i<this.bits.length;i++)this.bits[i]=0}e.a=i;var r=n(0);Object.defineProperty(i.prototype,\\\"Dimension\\\",{get:function(){if(this.width!=this.height)throw\\\"Can't call getDimension() on a non-square matrix\\\";return this.width}}),i.prototype.get_Renamed=function(t,e){var i=e*this.rowSize+(t>>5);return 0!=(1&n.i(r.c)(this.bits[i],31&t))},i.prototype.set_Renamed=function(t,e){var n=e*this.rowSize+(t>>5);this.bits[n]|=1<<(31&t)},i.prototype.flip=function(t,e){var n=e*this.rowSize+(t>>5);this.bits[n]^=1<<(31&t)},i.prototype.clear=function(){for(var t=this.bits.length,e=0;e<t;e++)this.bits[e]=0},i.prototype.setRegion=function(t,e,n,i){if(e<0||t<0)throw\\\"Left and top must be nonnegative\\\";if(i<1||n<1)throw\\\"Height and width must be at least 1\\\";var r=t+n,o=e+i;if(o>this.height||r>this.width)throw\\\"The region must fit inside the matrix\\\";for(var a=e;a<o;a++)for(var s=a*this.rowSize,h=t;h<r;h++)this.bits[s+(h>>5)]|=1<<(31&h)}},function(t,e,n){\\\"use strict\\\";function i(t){this.errorCorrectionLevel=o.a.forBits(t>>3&3),this.dataMask=7&t}e.a=i;var r=n(0),o=n(15),a=[[21522,0],[20773,1],[24188,2],[23371,3],[17913,4],[16590,5],[20375,6],[19104,7],[30660,8],[29427,9],[32170,10],[30877,11],[26159,12],[25368,13],[27713,14],[26998,15],[5769,16],[5054,17],[7399,18],[6608,19],[1890,20],[597,21],[3340,22],[2107,23],[13663,24],[12392,25],[16177,26],[14854,27],[9396,28],[8579,29],[11994,30],[11245,31]],s=[0,1,1,2,1,2,2,3,1,2,2,3,2,3,3,4];i.prototype.GetHashCode=function(){return this.errorCorrectionLevel.ordinal()<<3|this.dataMask},i.prototype.Equals=function(t){var e=t;return this.errorCorrectionLevel==e.errorCorrectionLevel&&this.dataMask==e.dataMask},i.numBitsDiffering=function(t,e){return t^=e,s[15&t]+s[15&n.i(r.c)(t,4)]+s[15&n.i(r.c)(t,8)]+s[15&n.i(r.c)(t,12)]+s[15&n.i(r.c)(t,16)]+s[15&n.i(r.c)(t,20)]+s[15&n.i(r.c)(t,24)]+s[15&n.i(r.c)(t,28)]},i.decodeFormatInformation=function(t){var e=i.doDecodeFormatInformation(t);return null!=e?e:i.doDecodeFormatInformation(21522^t)},i.doDecodeFormatInformation=function(t){for(var e=4294967295,n=0,r=0;r<a.length;r++){var o=a[r],s=o[0];if(s==t)return new i(o[1]);var h=this.numBitsDiffering(t,s);h<e&&(n=o[1],e=h)}return e<=3?new i(n):null}},function(t,e,n){\\\"use strict\\\";function i(t){this.expTable=new Array(256),this.logTable=new Array(256);for(var e=1,n=0;n<256;n++)this.expTable[n]=e,(e<<=1)>=256&&(e^=t);for(var n=0;n<255;n++)this.logTable[this.expTable[n]]=n;var i=new Array(1);i[0]=0,this.zero=new r.a(this,new Array(i));var o=new Array(1);o[0]=1,this.one=new r.a(this,new Array(o))}e.a=i;var r=n(4);Object.defineProperty(i.prototype,\\\"Zero\\\",{get:function(){return this.zero}}),Object.defineProperty(i.prototype,\\\"One\\\",{get:function(){return this.one}}),i.prototype.buildMonomial=function(t,e){if(t<0)throw\\\"System.ArgumentException\\\";if(0==e)return this.zero;for(var n=new Array(t+1),i=0;i<n.length;i++)n[i]=0;return n[0]=e,new r.a(this,n)},i.prototype.exp=function(t){return this.expTable[t]},i.prototype.log=function(t){if(0==t)throw\\\"System.ArgumentException\\\";return this.logTable[t]},i.prototype.inverse=function(t){if(0==t)throw\\\"System.ArithmeticException\\\";return this.expTable[255-this.logTable[t]]},i.prototype.addOrSubtract=function(t,e){return t^e},i.prototype.multiply=function(t,e){return 0==t||0==e?0:1==t?e:1==e?t:this.expTable[(this.logTable[t]+this.logTable[e])%255]},i.QR_CODE_FIELD=new i(285),i.DATA_MATRIX_FIELD=new i(301)},function(t,e,n){\\\"use strict\\\";function i(t,e){if(null==e||0==e.length)throw\\\"System.ArgumentException\\\";this.field=t;var n=e.length;if(n>1&&0==e[0]){for(var i=1;i<n&&0==e[i];)i++;if(i==n)this.coefficients=t.Zero.coefficients;else{this.coefficients=new Array(n-i);for(var r=0;r<this.coefficients.length;r++)this.coefficients[r]=0;for(var o=0;o<this.coefficients.length;o++)this.coefficients[o]=e[i+o]}}else this.coefficients=e}e.a=i,Object.defineProperty(i.prototype,\\\"Zero\\\",{get:function(){return 0==this.coefficients[0]}}),Object.defineProperty(i.prototype,\\\"Degree\\\",{get:function(){return this.coefficients.length-1}}),i.prototype.getCoefficient=function(t){return this.coefficients[this.coefficients.length-1-t]},i.prototype.evaluateAt=function(t){if(0==t)return this.getCoefficient(0);var e=this.coefficients.length;if(1==t){for(var n=0,i=0;i<e;i++)n=this.field.addOrSubtract(n,this.coefficients[i]);return n}for(var r=this.coefficients[0],i=1;i<e;i++)r=this.field.addOrSubtract(this.field.multiply(t,r),this.coefficients[i]);return r},i.prototype.addOrSubtract=function(t){if(this.field!=t.field)throw\\\"GF256Polys do not have same GF256 field\\\";if(this.Zero)return t;if(t.Zero)return this;var e=this.coefficients,n=t.coefficients;if(e.length>n.length){var r=e;e=n,n=r}for(var o=new Array(n.length),a=n.length-e.length,s=0;s<a;s++)o[s]=n[s];for(var h=a;h<n.length;h++)o[h]=this.field.addOrSubtract(e[h-a],n[h]);return new i(this.field,o)},i.prototype.multiply1=function(t){if(this.field!=t.field)throw\\\"GF256Polys do not have same GF256 field\\\";if(this.Zero||t.Zero)return this.field.Zero;for(var e=this.coefficients,n=e.length,r=t.coefficients,o=r.length,a=new Array(n+o-1),s=0;s<n;s++)for(var h=e[s],f=0;f<o;f++)a[s+f]=this.field.addOrSubtract(a[s+f],this.field.multiply(h,r[f]));return new i(this.field,a)},i.prototype.multiply2=function(t){if(0==t)return this.field.Zero;if(1==t)return this;for(var e=this.coefficients.length,n=new Array(e),r=0;r<e;r++)n[r]=this.field.multiply(this.coefficients[r],t);return new i(this.field,n)},i.prototype.multiplyByMonomial=function(t,e){if(t<0)throw\\\"System.ArgumentException\\\";if(0==e)return this.field.Zero;for(var n=this.coefficients.length,r=new Array(n+t),o=0;o<r.length;o++)r[o]=0;for(var o=0;o<n;o++)r[o]=this.field.multiply(this.coefficients[o],e);return new i(this.field,r)},i.prototype.divide=function(t){if(this.field!=t.field)throw\\\"GF256Polys do not have same GF256 field\\\";if(t.Zero)throw\\\"Divide by 0\\\";for(var e=this.field.Zero,n=this,i=t.getCoefficient(t.Degree),r=this.field.inverse(i);n.Degree>=t.Degree&&!n.Zero;){var o=n.Degree-t.Degree,a=this.field.multiply(n.getCoefficient(n.Degree),r),s=t.multiplyByMonomial(o,a),h=this.field.buildMonomial(o,a);e=e.addOrSubtract(h),n=n.addOrSubtract(s)}return[e,n]}},function(t,e,n){\\\"use strict\\\";function i(t,e){this.count=t,this.dataCodewords=e}function r(t,e,n){this.ecCodewordsPerBlock=t,this.ecBlocks=n?[e,n]:[e]}function o(t,e,n,i,r,o){this.versionNumber=t,this.alignmentPatternCenters=e,this.ecBlocks=[n,i,r,o];for(var a=0,s=n.ecCodewordsPerBlock,h=n.getECBlocks(),f=0;f<h.length;f++){var w=h[f];a+=w.count*(w.dataCodewords+s)}this.totalCodewords=a}e.a=o;var a=n(2),s=n(1);Object.defineProperty(r.prototype,\\\"TotalECCodewords\\\",{get:function(){return this.ecCodewordsPerBlock*this.NumBlocks}}),Object.defineProperty(r.prototype,\\\"NumBlocks\\\",{get:function(){for(var t=0,e=0;e<this.ecBlocks.length;e++)t+=this.ecBlocks[e].length;return t}}),r.prototype.getECBlocks=function(){return this.ecBlocks},Object.defineProperty(o.prototype,\\\"DimensionForVersion\\\",{get:function(){return 17+4*this.versionNumber}}),o.prototype.buildFunctionPattern=function(){var t=this.DimensionForVersion,e=new s.a(t);e.setRegion(0,0,9,9),e.setRegion(t-8,0,8,9),e.setRegion(0,t-8,9,8);for(var n=this.alignmentPatternCenters.length,i=0;i<n;i++)for(var r=this.alignmentPatternCenters[i]-2,o=0;o<n;o++)0==i&&(0==o||o==n-1)||i==n-1&&0==o||e.setRegion(this.alignmentPatternCenters[o]-2,r,5,5);return e.setRegion(6,9,1,t-17),e.setRegion(9,6,t-17,1),this.versionNumber>6&&(e.setRegion(t-11,0,3,6),e.setRegion(0,t-11,6,3)),e},o.prototype.getECBlocksForLevel=function(t){return this.ecBlocks[t.ordinal()]},o.VERSION_DECODE_INFO=[31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017],o.VERSIONS=function(){return[new o(1,[],new r(7,new i(1,19)),new r(10,new i(1,16)),new r(13,new i(1,13)),new r(17,new i(1,9))),new o(2,[6,18],new r(10,new i(1,34)),new r(16,new i(1,28)),new r(22,new i(1,22)),new r(28,new i(1,16))),new o(3,[6,22],new r(15,new i(1,55)),new r(26,new i(1,44)),new r(18,new i(2,17)),new r(22,new i(2,13))),new o(4,[6,26],new r(20,new i(1,80)),new r(18,new i(2,32)),new r(26,new i(2,24)),new r(16,new i(4,9))),new o(5,[6,30],new r(26,new i(1,108)),new r(24,new i(2,43)),new r(18,new i(2,15),new i(2,16)),new r(22,new i(2,11),new i(2,12))),new o(6,[6,34],new r(18,new i(2,68)),new r(16,new i(4,27)),new r(24,new i(4,19)),new r(28,new i(4,15))),new o(7,[6,22,38],new r(20,new i(2,78)),new r(18,new i(4,31)),new r(18,new i(2,14),new i(4,15)),new r(26,new i(4,13),new i(1,14))),new o(8,[6,24,42],new r(24,new i(2,97)),new r(22,new i(2,38),new i(2,39)),new r(22,new i(4,18),new i(2,19)),new r(26,new i(4,14),new i(2,15))),new o(9,[6,26,46],new r(30,new i(2,116)),new r(22,new i(3,36),new i(2,37)),new r(20,new i(4,16),new i(4,17)),new r(24,new i(4,12),new i(4,13))),new o(10,[6,28,50],new r(18,new i(2,68),new i(2,69)),new r(26,new i(4,43),new i(1,44)),new r(24,new i(6,19),new i(2,20)),new r(28,new i(6,15),new i(2,16))),new o(11,[6,30,54],new r(20,new i(4,81)),new r(30,new i(1,50),new i(4,51)),new r(28,new i(4,22),new i(4,23)),new r(24,new i(3,12),new i(8,13))),new o(12,[6,32,58],new r(24,new i(2,92),new i(2,93)),new r(22,new i(6,36),new i(2,37)),new r(26,new i(4,20),new i(6,21)),new r(28,new i(7,14),new i(4,15))),new o(13,[6,34,62],new r(26,new i(4,107)),new r(22,new i(8,37),new i(1,38)),new r(24,new i(8,20),new i(4,21)),new r(22,new i(12,11),new i(4,12))),new o(14,[6,26,46,66],new r(30,new i(3,115),new i(1,116)),new r(24,new i(4,40),new i(5,41)),new r(20,new i(11,16),new i(5,17)),new r(24,new i(11,12),new i(5,13))),new o(15,[6,26,48,70],new r(22,new i(5,87),new i(1,88)),new r(24,new i(5,41),new i(5,42)),new r(30,new i(5,24),new i(7,25)),new r(24,new i(11,12),new i(7,13))),new o(16,[6,26,50,74],new r(24,new i(5,98),new i(1,99)),new r(28,new i(7,45),new i(3,46)),new r(24,new i(15,19),new i(2,20)),new r(30,new i(3,15),new i(13,16))),new o(17,[6,30,54,78],new r(28,new i(1,107),new i(5,108)),new r(28,new i(10,46),new i(1,47)),new r(28,new i(1,22),new i(15,23)),new r(28,new i(2,14),new i(17,15))),new o(18,[6,30,56,82],new r(30,new i(5,120),new i(1,121)),new r(26,new i(9,43),new i(4,44)),new r(28,new i(17,22),new i(1,23)),new r(28,new i(2,14),new i(19,15))),new o(19,[6,30,58,86],new r(28,new i(3,113),new i(4,114)),new r(26,new i(3,44),new i(11,45)),new r(26,new i(17,21),new i(4,22)),new r(26,new i(9,13),new i(16,14))),new o(20,[6,34,62,90],new r(28,new i(3,107),new i(5,108)),new r(26,new i(3,41),new i(13,42)),new r(30,new i(15,24),new i(5,25)),new r(28,new i(15,15),new i(10,16))),new o(21,[6,28,50,72,94],new r(28,new i(4,116),new i(4,117)),new r(26,new i(17,42)),new r(28,new i(17,22),new i(6,23)),new r(30,new i(19,16),new i(6,17))),new o(22,[6,26,50,74,98],new r(28,new i(2,111),new i(7,112)),new r(28,new i(17,46)),new r(30,new i(7,24),new i(16,25)),new r(24,new i(34,13))),new o(23,[6,30,54,74,102],new r(30,new i(4,121),new i(5,122)),new r(28,new i(4,47),new i(14,48)),new r(30,new i(11,24),new i(14,25)),new r(30,new i(16,15),new i(14,16))),new o(24,[6,28,54,80,106],new r(30,new i(6,117),new i(4,118)),new r(28,new i(6,45),new i(14,46)),new r(30,new i(11,24),new i(16,25)),new r(30,new i(30,16),new i(2,17))),new o(25,[6,32,58,84,110],new r(26,new i(8,106),new i(4,107)),new r(28,new i(8,47),new i(13,48)),new r(30,new i(7,24),new i(22,25)),new r(30,new i(22,15),new i(13,16))),new o(26,[6,30,58,86,114],new r(28,new i(10,114),new i(2,115)),new r(28,new i(19,46),new i(4,47)),new r(28,new i(28,22),new i(6,23)),new r(30,new i(33,16),new i(4,17))),new o(27,[6,34,62,90,118],new r(30,new i(8,122),new i(4,123)),new r(28,new i(22,45),new i(3,46)),new r(30,new i(8,23),new i(26,24)),new r(30,new i(12,15),new i(28,16))),new o(28,[6,26,50,74,98,122],new r(30,new i(3,117),new i(10,118)),new r(28,new i(3,45),new i(23,46)),new r(30,new i(4,24),new i(31,25)),new r(30,new i(11,15),new i(31,16))),new o(29,[6,30,54,78,102,126],new r(30,new i(7,116),new i(7,117)),new r(28,new i(21,45),new i(7,46)),new r(30,new i(1,23),new i(37,24)),new r(30,new i(19,15),new i(26,16))),new o(30,[6,26,52,78,104,130],new r(30,new i(5,115),new i(10,116)),new r(28,new i(19,47),new i(10,48)),new r(30,new i(15,24),new i(25,25)),new r(30,new i(23,15),new i(25,16))),new o(31,[6,30,56,82,108,134],new r(30,new i(13,115),new i(3,116)),new r(28,new i(2,46),new i(29,47)),new r(30,new i(42,24),new i(1,25)),new r(30,new i(23,15),new i(28,16))),new o(32,[6,34,60,86,112,138],new r(30,new i(17,115)),new r(28,new i(10,46),new i(23,47)),new r(30,new i(10,24),new i(35,25)),new r(30,new i(19,15),new i(35,16))),new o(33,[6,30,58,86,114,142],new r(30,new i(17,115),new i(1,116)),new r(28,new i(14,46),new i(21,47)),new r(30,new i(29,24),new i(19,25)),new r(30,new i(11,15),new i(46,16))),new o(34,[6,34,62,90,118,146],new r(30,new i(13,115),new i(6,116)),new r(28,new i(14,46),new i(23,47)),new r(30,new i(44,24),new i(7,25)),new r(30,new i(59,16),new i(1,17))),new o(35,[6,30,54,78,102,126,150],new r(30,new i(12,121),new i(7,122)),new r(28,new i(12,47),new i(26,48)),new r(30,new i(39,24),new i(14,25)),new r(30,new i(22,15),new i(41,16))),new o(36,[6,24,50,76,102,128,154],new r(30,new i(6,121),new i(14,122)),new r(28,new i(6,47),new i(34,48)),new r(30,new i(46,24),new i(10,25)),new r(30,new i(2,15),new i(64,16))),new o(37,[6,28,54,80,106,132,158],new r(30,new i(17,122),new i(4,123)),new r(28,new i(29,46),new i(14,47)),new r(30,new i(49,24),new i(10,25)),new r(30,new i(24,15),new i(46,16))),new o(38,[6,32,58,84,110,136,162],new r(30,new i(4,122),new i(18,123)),new r(28,new i(13,46),new i(32,47)),new r(30,new i(48,24),new i(14,25)),new r(30,new i(42,15),new i(32,16))),new o(39,[6,26,54,82,110,138,166],new r(30,new i(20,117),new i(4,118)),new r(28,new i(40,47),new i(7,48)),new r(30,new i(43,24),new i(22,25)),new r(30,new i(10,15),new i(67,16))),new o(40,[6,30,58,86,114,142,170],new r(30,new i(19,118),new i(6,119)),new r(28,new i(18,47),new i(31,48)),new r(30,new i(34,24),new i(34,25)),new r(30,new i(20,15),new i(61,16)))]}(),o.getVersionForNumber=function(t){if(t<1||t>40)throw\\\"ArgumentException\\\";return o.VERSIONS[t-1]},o.getProvisionalVersionForDimension=function(t){if(t%4!=1)throw\\\"Error getProvisionalVersionForDimension\\\";try{return o.getVersionForNumber(t-17>>2)}catch(t){throw\\\"Error getVersionForNumber\\\"}},o.decodeVersionInformation=function(t){for(var e=4294967295,n=0,i=0;i<o.VERSION_DECODE_INFO.length;i++){var r=o.VERSION_DECODE_INFO[i];if(r==t)return this.getVersionForNumber(i+7);var s=a.a.numBitsDiffering(t,r);s<e&&(n=i+7,e=s)}return e<=3?this.getVersionForNumber(n):null}},function(t,e,n){\\\"use strict\\\";Object.defineProperty(e,\\\"__esModule\\\",{value:!0});var i=n(0);e.default=i.a},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,\\\"loaded\\\",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,\\\"id\\\",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){\\\"use strict\\\";function i(t,e,n){this.x=t,this.y=e,this.count=1,this.estimatedModuleSize=n}function r(t,e,n,i,r,o,a){this.image=t,this.possibleCenters=[],this.startX=e,this.startY=n,this.width=i,this.height=r,this.moduleSize=o,this.crossCheckStateCount=[0,0,0],this.resultPointCallback=a}e.a=r,Object.defineProperty(i.prototype,\\\"X\\\",{get:function(){return Math.floor(this.x)}}),Object.defineProperty(i.prototype,\\\"Y\\\",{get:function(){return Math.floor(this.y)}}),i.prototype.incrementCount=function(){this.count++},i.prototype.aboutEquals=function(t,e,n){if(Math.abs(e-this.y)<=t&&Math.abs(n-this.x)<=t){var i=Math.abs(t-this.estimatedModuleSize);return i<=1||i/this.estimatedModuleSize<=1}return!1},r.prototype.centerFromEnd=function(t,e){return e-t[2]-t[1]/2},r.prototype.foundPatternCross=function(t){for(var e=this.moduleSize,n=e/2,i=0;i<3;i++)if(Math.abs(e-t[i])>=n)return!1;return!0},r.prototype.crossCheckVertical=function(t,e,n,i){var r=this.image,o=r.height,a=this.crossCheckStateCount;a[0]=0,a[1]=0,a[2]=0;for(var s=t;s>=0&&r.data[e+s*r.width]&&a[1]<=n;)a[1]++,s--;if(s<0||a[1]>n)return NaN;for(;s>=0&&!r.data[e+s*r.width]&&a[0]<=n;)a[0]++,s--;if(a[0]>n)return NaN;for(s=t+1;s<o&&r.data[e+s*r.width]&&a[1]<=n;)a[1]++,s++;if(s==o||a[1]>n)return NaN;for(;s<o&&!r.data[e+s*r.width]&&a[2]<=n;)a[2]++,s++;if(a[2]>n)return NaN;var h=a[0]+a[1]+a[2];return 5*Math.abs(h-i)>=2*i?NaN:this.foundPatternCross(a)?this.centerFromEnd(a,s):NaN},r.prototype.handlePossibleCenter=function(t,e,n){var r=t[0]+t[1]+t[2],o=this.centerFromEnd(t,n),a=this.crossCheckVertical(e,Math.floor(o),2*t[1],r);if(!isNaN(a)){for(var s=(t[0]+t[1]+t[2])/3,h=this.possibleCenters.length,f=0;f<h;f++){if(this.possibleCenters[f].aboutEquals(s,a,o))return new i(o,a,s)}var w=new i(o,a,s);this.possibleCenters.push(w),null!=this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(w)}return null},r.prototype.find=function(){for(var t=this.image,e=this.startX,n=this.height,i=e+this.width,r=this.startY+(n>>1),o=[0,0,0],a=0;a<n;a++){var s=r+(0==(1&a)?a+1>>1:-(a+1>>1));o[0]=0,o[1]=0,o[2]=0;for(var h=e;h<i&&!t.data[h+t.width*s];)h++;for(var f=0;h<i;){if(t.data[h+s*t.width])if(1==f)o[f]++;else if(2==f){if(this.foundPatternCross(o)){var w=this.handlePossibleCenter(o,s,h);if(null!=w)return w}o[0]=o[2],o[1]=1,o[2]=0,f=1}else o[++f]++;else 1==f&&f++,o[f]++;h++}if(this.foundPatternCross(o)){var w=this.handlePossibleCenter(o,s,i);if(null!=w)return w}}if(0!=this.possibleCenters.length)return this.possibleCenters[0];throw\\\"Couldn't find enough alignment patterns\\\"}},function(t,e,n){\\\"use strict\\\";function i(t){var e=t.Dimension;if(e<21||1!=(3&e))throw\\\"Error BitMatrixParser\\\";this.bitMatrix=t,this.parsedVersion=null,this.parsedFormatInfo=null}e.a=i;var r=n(2),o=n(5),a=n(12);i.prototype.copyBit=function(t,e,n){return this.bitMatrix.get_Renamed(t,e)?n<<1|1:n<<1},i.prototype.readFormatInformation=function(){if(null!=this.parsedFormatInfo)return this.parsedFormatInfo;for(var t=0,e=0;e<6;e++)t=this.copyBit(e,8,t);t=this.copyBit(7,8,t),t=this.copyBit(8,8,t),t=this.copyBit(8,7,t);for(var n=5;n>=0;n--)t=this.copyBit(8,n,t);if(this.parsedFormatInfo=r.a.decodeFormatInformation(t),null!=this.parsedFormatInfo)return this.parsedFormatInfo;var i=this.bitMatrix.Dimension;t=0;for(var o=i-8,e=i-1;e>=o;e--)t=this.copyBit(e,8,t);for(var n=i-7;n<i;n++)t=this.copyBit(8,n,t);if(this.parsedFormatInfo=r.a.decodeFormatInformation(t),null!=this.parsedFormatInfo)return this.parsedFormatInfo;throw\\\"Error readFormatInformation\\\"},i.prototype.readVersion=function(){if(null!=this.parsedVersion)return this.parsedVersion;var t=this.bitMatrix.Dimension,e=t-17>>2;if(e<=6)return o.a.getVersionForNumber(e);for(var n=0,i=t-11,r=5;r>=0;r--)for(var a=t-9;a>=i;a--)n=this.copyBit(a,r,n);if(this.parsedVersion=o.a.decodeVersionInformation(n),null!=this.parsedVersion&&this.parsedVersion.DimensionForVersion==t)return this.parsedVersion;n=0;for(var a=5;a>=0;a--)for(var r=t-9;r>=i;r--)n=this.copyBit(a,r,n);if(this.parsedVersion=o.a.decodeVersionInformation(n),null!=this.parsedVersion&&this.parsedVersion.DimensionForVersion==t)return this.parsedVersion;throw\\\"Error readVersion\\\"},i.prototype.readCodewords=function(){var t=this.readFormatInformation(),e=this.readVersion(),n=a.a.forReference(t.dataMask),i=this.bitMatrix.Dimension;n.unmaskBitMatrix(this.bitMatrix,i);for(var r=e.buildFunctionPattern(),o=!0,s=new Array(e.totalCodewords),h=0,f=0,w=0,u=i-1;u>0;u-=2){6==u&&u--;for(var l=0;l<i;l++)for(var c=o?i-1-l:l,d=0;d<2;d++)r.get_Renamed(u-d,c)||(w++,f<<=1,this.bitMatrix.get_Renamed(u-d,c)&&(f|=1),8==w&&(s[h++]=f,w=0,f=0));o^=!0}if(h!=e.totalCodewords)throw\\\"Error readCodewords\\\";return s}},function(t,e,n){\\\"use strict\\\";function i(t,e){this.numDataCodewords=t,this.codewords=e}e.a=i,i.getDataBlocks=function(t,e,n){if(t.length!=e.totalCodewords)throw\\\"ArgumentException\\\";for(var r=e.getECBlocksForLevel(n),o=0,a=r.getECBlocks(),s=0;s<a.length;s++)o+=a[s].count;for(var h=new Array(o),f=0,w=0;w<a.length;w++)for(var u=a[w],s=0;s<u.count;s++){var l=u.dataCodewords,c=r.ecCodewordsPerBlock+l;h[f++]=new i(l,new Array(c))}for(var d=h[0].codewords.length,p=h.length-1;p>=0;){if(h[p].codewords.length==d)break;p--}p++;for(var g=d-r.ecCodewordsPerBlock,v=0,s=0;s<g;s++)for(var w=0;w<f;w++)h[w].codewords[s]=t[v++];for(var w=p;w<f;w++)h[w].codewords[g]=t[v++];for(var m=h[0].codewords.length,s=g;s<m;s++)for(var w=0;w<f;w++){var b=w<p?s:s+1;h[w].codewords[b]=t[v++]}return h}},function(t,e,n){\\\"use strict\\\";function i(t,e,n){this.blockPointer=0,this.bitPointer=7,this.dataLength=0,this.blocks=t,this.numErrorCorrectionCode=n,e<=9?this.dataLengthMode=0:e>=10&&e<=26?this.dataLengthMode=1:e>=27&&e<=40&&(this.dataLengthMode=2)}e.a=i;var r=n(0);i.prototype.getNextBits=function(t){var e=0;if(t<this.bitPointer+1){for(var n=0,i=0;i<t;i++)n+=1<<i;return n<<=this.bitPointer-t+1,e=(this.blocks[this.blockPointer]&n)>>this.bitPointer-t+1,this.bitPointer-=t,e}if(t<this.bitPointer+1+8){for(var r=0,i=0;i<this.bitPointer+1;i++)r+=1<<i;return e=(this.blocks[this.blockPointer]&r)<<t-(this.bitPointer+1),this.blockPointer++,e+=this.blocks[this.blockPointer]>>8-(t-(this.bitPointer+1)),this.bitPointer=this.bitPointer-t%8,this.bitPointer<0&&(this.bitPointer=8+this.bitPointer),e}if(t<this.bitPointer+1+16){for(var r=0,o=0,i=0;i<this.bitPointer+1;i++)r+=1<<i;var a=(this.blocks[this.blockPointer]&r)<<t-(this.bitPointer+1);this.blockPointer++;var s=this.blocks[this.blockPointer]<<t-(this.bitPointer+1+8);this.blockPointer++;for(var i=0;i<t-(this.bitPointer+1+8);i++)o+=1<<i;o<<=8-(t-(this.bitPointer+1+8));return e=a+s+((this.blocks[this.blockPointer]&o)>>8-(t-(this.bitPointer+1+8))),this.bitPointer=this.bitPointer-(t-8)%8,this.bitPointer<0&&(this.bitPointer=8+this.bitPointer),e}return 0},i.prototype.NextMode=function(){return this.blockPointer>this.blocks.length-this.numErrorCorrectionCode-2?0:this.getNextBits(4)},i.prototype.getDataLength=function(t){for(var e=0;;){if(t>>e==1)break;e++}return this.getNextBits(r.b.sizeOfDataLengthInfo[this.dataLengthMode][e])},i.prototype.getRomanAndFigureString=function(t){var e=t,n=0,i=\\\"\\\",r=[\\\"0\\\",\\\"1\\\",\\\"2\\\",\\\"3\\\",\\\"4\\\",\\\"5\\\",\\\"6\\\",\\\"7\\\",\\\"8\\\",\\\"9\\\",\\\"A\\\",\\\"B\\\",\\\"C\\\",\\\"D\\\",\\\"E\\\",\\\"F\\\",\\\"G\\\",\\\"H\\\",\\\"I\\\",\\\"J\\\",\\\"K\\\",\\\"L\\\",\\\"M\\\",\\\"N\\\",\\\"O\\\",\\\"P\\\",\\\"Q\\\",\\\"R\\\",\\\"S\\\",\\\"T\\\",\\\"U\\\",\\\"V\\\",\\\"W\\\",\\\"X\\\",\\\"Y\\\",\\\"Z\\\",\\\" \\\",\\\"$\\\",\\\"%\\\",\\\"*\\\",\\\"+\\\",\\\"-\\\",\\\".\\\",\\\"/\\\",\\\":\\\"];do{if(e>1){n=this.getNextBits(11);var o=Math.floor(n/45),a=n%45;i+=r[o],i+=r[a],e-=2}else 1==e&&(n=this.getNextBits(6),i+=r[n],e-=1)}while(e>0);return i},i.prototype.getFigureString=function(t){var e=t,n=0,i=\\\"\\\";do{e>=3?(n=this.getNextBits(10),n<100&&(i+=\\\"0\\\"),n<10&&(i+=\\\"0\\\"),e-=3):2==e?(n=this.getNextBits(7),n<10&&(i+=\\\"0\\\"),e-=2):1==e&&(n=this.getNextBits(4),e-=1),i+=n}while(e>0);return i},i.prototype.get8bitByteArray=function(t){var e=t,n=0,i=[];do{n=this.getNextBits(8),i.push(n),e--}while(e>0);return i},i.prototype.getKanjiString=function(t){var e=t,n=0,i=\\\"\\\";do{n=this.getNextBits(13);var r=n%192,o=n/192,a=(o<<8)+r,s=0;s=a+33088<=40956?a+33088:a+49472,i+=String.fromCharCode(s),e--}while(e>0);return i},Object.defineProperty(i.prototype,\\\"DataByte\\\",{get:function(){for(var t=[];;){var e=this.NextMode();if(0==e){if(t.length>0)break;throw\\\"Empty data block\\\"}if(1!=e&&2!=e&&4!=e&&8!=e&&7!=e)throw\\\"Invalid mode: \\\"+e+\\\" in (block:\\\"+this.blockPointer+\\\" bit:\\\"+this.bitPointer+\\\")\\\";var n=this.getDataLength(e);if(n<1)throw\\\"Invalid data length: \\\"+n;switch(e){case 1:for(var i=this.getFigureString(n),r=new Array(i.length),o=0;o<i.length;o++)r[o]=i.charCodeAt(o);t.push(r);break;case 2:for(var i=this.getRomanAndFigureString(n),r=new Array(i.length),o=0;o<i.length;o++)r[o]=i.charCodeAt(o);t.push(r);break;case 4:var a=this.get8bitByteArray(n);t.push(a);break;case 8:var i=this.getKanjiString(n);t.push(i)}}return t}})},function(t,e,n){\\\"use strict\\\";function i(){this.unmaskBitMatrix=function(t,e){for(var n=0;n<e;n++)for(var i=0;i<e;i++)this.isMasked(n,i)&&t.flip(i,n)},this.isMasked=function(t,e){return 0==(t+e&1)}}function r(){this.unmaskBitMatrix=function(t,e){for(var n=0;n<e;n++)for(var i=0;i<e;i++)this.isMasked(n,i)&&t.flip(i,n)},this.isMasked=function(t,e){return 0==(1&t)}}function o(){this.unmaskBitMatrix=function(t,e){for(var n=0;n<e;n++)for(var i=0;i<e;i++)this.isMasked(n,i)&&t.flip(i,n)},this.isMasked=function(t,e){return e%3==0}}function a(){this.unmaskBitMatrix=function(t,e){for(var n=0;n<e;n++)for(var i=0;i<e;i++)this.isMasked(n,i)&&t.flip(i,n)},this.isMasked=function(t,e){return(t+e)%3==0}}function s(){this.unmaskBitMatrix=function(t,e){for(var n=0;n<e;n++)for(var i=0;i<e;i++)this.isMasked(n,i)&&t.flip(i,n)},this.isMasked=function(t,e){return 0==(n.i(u.c)(t,1)+e/3&1)}}function h(){this.unmaskBitMatrix=function(t,e){for(var n=0;n<e;n++)for(var i=0;i<e;i++)this.isMasked(n,i)&&t.flip(i,n)},this.isMasked=function(t,e){var n=t*e;return(1&n)+n%3==0}}function f(){this.unmaskBitMatrix=function(t,e){for(var n=0;n<e;n++)for(var i=0;i<e;i++)this.isMasked(n,i)&&t.flip(i,n)},this.isMasked=function(t,e){var n=t*e;return 0==((1&n)+n%3&1)}}function w(){this.unmaskBitMatrix=function(t,e){for(var n=0;n<e;n++)for(var i=0;i<e;i++)this.isMasked(n,i)&&t.flip(i,n)},this.isMasked=function(t,e){return 0==((t+e&1)+t*e%3&1)}}var u=n(0),l={};l.forReference=function(t){if(t<0||t>7)throw\\\"System.ArgumentException\\\";return l.DATA_MASKS[t]},l.DATA_MASKS=[new i,new r,new o,new a,new s,new h,new f,new w],e.a=l},function(t,e,n){\\\"use strict\\\";var i=n(18),r=n(3),o=n(9),a=n(10),s=n(11),h={};h.rsDecoder=new i.a(r.a.QR_CODE_FIELD),h.correctErrors=function(t,e){for(var n=t.length,i=new Array(n),r=0;r<n;r++)i[r]=255&t[r];var o=t.length-e;try{h.rsDecoder.decode(i,o)}catch(t){throw t}for(var r=0;r<e;r++)t[r]=i[r]},h.decode=function(t){for(var e=new o.a(t),n=e.readVersion(),i=e.readFormatInformation().errorCorrectionLevel,r=e.readCodewords(),f=a.a.getDataBlocks(r,n,i),w=0,u=0;u<f.length;u++)w+=f[u].numDataCodewords;for(var l=new Array(w),c=0,d=0;d<f.length;d++){var p=f[d],g=p.codewords,v=p.numDataCodewords;h.correctErrors(g,v);for(var u=0;u<v;u++)l[c++]=g[u]}return new s.a(l,n.versionNumber,i.bits)},e.a=h},function(t,e,n){\\\"use strict\\\";function i(t,e,n,i,r,o,a,s,h){this.a11=t,this.a12=i,this.a13=a,this.a21=e,this.a22=r,this.a23=s,this.a31=n,this.a32=o,this.a33=h}function r(t,e){this.bits=t,this.points=e}function o(t){this.image=t,this.resultPointCallback=null}e.a=o;var a=n(5),s=n(8),h=n(17),f=n(16);i.prototype.transformPoints1=function(t){for(var e=t.length,n=this.a11,i=this.a12,r=this.a13,o=this.a21,a=this.a22,s=this.a23,h=this.a31,f=this.a32,w=this.a33,u=0;u<e;u+=2){var l=t[u],c=t[u+1],d=r*l+s*c+w;t[u]=(n*l+o*c+h)/d,t[u+1]=(i*l+a*c+f)/d}},i.prototype.transformPoints2=function(t,e){for(var n=t.length,i=0;i<n;i++){var r=t[i],o=e[i],a=this.a13*r+this.a23*o+this.a33;t[i]=(this.a11*r+this.a21*o+this.a31)/a,e[i]=(this.a12*r+this.a22*o+this.a32)/a}},i.prototype.buildAdjoint=function(){return new i(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)},i.prototype.times=function(t){return new i(this.a11*t.a11+this.a21*t.a12+this.a31*t.a13,this.a11*t.a21+this.a21*t.a22+this.a31*t.a23,this.a11*t.a31+this.a21*t.a32+this.a31*t.a33,this.a12*t.a11+this.a22*t.a12+this.a32*t.a13,this.a12*t.a21+this.a22*t.a22+this.a32*t.a23,this.a12*t.a31+this.a22*t.a32+this.a32*t.a33,this.a13*t.a11+this.a23*t.a12+this.a33*t.a13,this.a13*t.a21+this.a23*t.a22+this.a33*t.a23,this.a13*t.a31+this.a23*t.a32+this.a33*t.a33)},i.quadrilateralToQuadrilateral=function(t,e,n,i,r,o,a,s,h,f,w,u,l,c,d,p){var g=this.quadrilateralToSquare(t,e,n,i,r,o,a,s);return this.squareToQuadrilateral(h,f,w,u,l,c,d,p).times(g)},i.squareToQuadrilateral=function(t,e,n,r,o,a,s,h){var f=h-a,w=e-r+a-h;if(0==f&&0==w)return new i(n-t,o-n,t,r-e,a-r,e,0,0,1);var u=n-o,l=s-o,c=t-n+o-s,d=r-a,p=u*f-l*d,g=(c*f-l*w)/p,v=(u*w-c*d)/p;return new i(n-t+g*n,s-t+v*s,t,r-e+g*r,h-e+v*h,e,g,v,1)},i.quadrilateralToSquare=function(t,e,n,i,r,o,a,s){return this.squareToQuadrilateral(t,e,n,i,r,o,a,s).buildAdjoint()},o.prototype.sizeOfBlackWhiteBlackRun=function(t,e,n,i){var r=Math.abs(i-e)>Math.abs(n-t);if(r){var o=t;t=e,e=o,o=n,n=i,i=o}for(var a=Math.abs(n-t),s=Math.abs(i-e),h=-a>>1,f=e<i?1:-1,w=t<n?1:-1,u=0,l=t,c=e;l!=n;l+=w){var d=r?c:l,p=r?l:c;if(1==u?this.image.data[d+p*this.image.width]&&u++:this.image.data[d+p*this.image.width]||u++,3==u){var g=l-t,v=c-e;return Math.sqrt(g*g+v*v)}if((h+=s)>0){if(c==i)break;c+=f,h-=a}}var m=n-t,b=i-e;return Math.sqrt(m*m+b*b)},o.prototype.sizeOfBlackWhiteBlackRunBothWays=function(t,e,n,i){var r=this.sizeOfBlackWhiteBlackRun(t,e,n,i),o=1,a=t-(n-t);a<0?(o=t/(t-a),a=0):a>=this.image.width&&(o=(this.image.width-1-t)/(a-t),a=this.image.width-1);var s=Math.floor(e-(i-e)*o);return o=1,s<0?(o=e/(e-s),s=0):s>=this.image.height&&(o=(this.image.height-1-e)/(s-e),s=this.image.height-1),a=Math.floor(t+(a-t)*o),(r+=this.sizeOfBlackWhiteBlackRun(t,e,a,s))-1},o.prototype.calculateModuleSizeOneWay=function(t,e){var n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.X),Math.floor(t.Y),Math.floor(e.X),Math.floor(e.Y)),i=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.X),Math.floor(e.Y),Math.floor(t.X),Math.floor(t.Y));return isNaN(n)?i/7:isNaN(i)?n/7:(n+i)/14},o.prototype.calculateModuleSize=function(t,e,n){return(this.calculateModuleSizeOneWay(t,e)+this.calculateModuleSizeOneWay(t,n))/2},o.prototype.distance=function(t,e){var n=t.X-e.X,i=t.Y-e.Y;return Math.sqrt(n*n+i*i)},o.prototype.computeDimension=function(t,e,n,i){var r=Math.round(this.distance(t,e)/i),o=Math.round(this.distance(t,n)/i),a=7+(r+o>>1);switch(3&a){case 0:a++;break;case 2:a--;break;case 3:throw\\\"Error\\\"}return a},o.prototype.findAlignmentInRegion=function(t,e,n,i){var r=Math.floor(i*t),o=Math.max(0,e-r),a=Math.min(this.image.width-1,e+r);if(a-o<3*t)throw\\\"Error\\\";var h=Math.max(0,n-r),f=Math.min(this.image.height-1,n+r);return new s.a(this.image,o,h,a-o,f-h,t,this.resultPointCallback).find()},o.prototype.createTransform=function(t,e,n,r,o){var a,s,h,f,w=o-3.5;return null!=r?(a=r.X,s=r.Y,h=f=w-3):(a=e.X-t.X+n.X,s=e.Y-t.Y+n.Y,h=f=w),i.quadrilateralToQuadrilateral(3.5,3.5,w,3.5,h,f,3.5,w,t.X,t.Y,e.X,e.Y,a,s,n.X,n.Y)},o.prototype.sampleGrid=function(t,e,n){return h.a.sampleGrid3(t,n,e)},o.prototype.processFinderPatternInfo=function(t){var e=t.topLeft,n=t.topRight,i=t.bottomLeft,o=this.calculateModuleSize(e,n,i);if(o<1)throw\\\"Error\\\";var s=this.computeDimension(e,n,i,o),h=a.a.getProvisionalVersionForDimension(s),f=h.DimensionForVersion-7,w=null;if(h.alignmentPatternCenters.length>0)for(var u=n.X-e.X+i.X,l=n.Y-e.Y+i.Y,c=1-3/f,d=Math.floor(e.X+c*(u-e.X)),p=Math.floor(e.Y+c*(l-e.Y)),g=4;g<=16;g<<=1){w=this.findAlignmentInRegion(o,d,p,g);break}var v,m=this.createTransform(e,n,i,w,s),b=this.sampleGrid(this.image,m,s);return v=null==w?[i,e,n]:[i,e,n,w],new r(b,v)},o.prototype.detect=function(){var t=(new f.a).findFinderPattern(this.image);return this.processFinderPatternInfo(t)}},function(t,e,n){\\\"use strict\\\";function i(t,e,n){this.ordinal_Renamed_Field=t,this.bits=e,this.name=n}e.a=i,i.prototype.ordinal=function(){return this.ordinal_Renamed_Field},i.forBits=function(t){if(t<0||t>=r.length)throw\\\"ArgumentException\\\";return r[t]};var r=[new i(1,0,\\\"M\\\"),new i(0,1,\\\"L\\\"),new i(3,2,\\\"H\\\"),new i(2,3,\\\"Q\\\")]},function(t,e,n){\\\"use strict\\\";function i(t){function e(t,e){var n=t.X-e.X,i=t.Y-e.Y;return Math.sqrt(n*n+i*i)}var n,i,r,o=e(t[0],t[1]),a=e(t[1],t[2]),s=e(t[0],t[2]);if(a>=o&&a>=s?(i=t[0],n=t[1],r=t[2]):s>=a&&s>=o?(i=t[1],n=t[0],r=t[2]):(i=t[2],n=t[0],r=t[1]),function(t,e,n){var i=e.x,r=e.y;return(n.x-i)*(t.y-r)-(n.y-r)*(t.x-i)}(n,i,r)<0){var h=n;n=r,r=h}t[0]=n,t[1]=i,t[2]=r}function r(t,e,n){this.x=t,this.y=e,this.count=1,this.estimatedModuleSize=n}function o(t){this.bottomLeft=t[0],this.topLeft=t[1],this.topRight=t[2]}function a(){this.image=null,this.possibleCenters=[],this.hasSkipped=!1,this.crossCheckStateCount=[0,0,0,0,0],this.resultPointCallback=null}e.a=a;Object.defineProperty(r.prototype,\\\"X\\\",{get:function(){return this.x}}),Object.defineProperty(r.prototype,\\\"Y\\\",{get:function(){return this.y}}),r.prototype.incrementCount=function(){this.count++},r.prototype.aboutEquals=function(t,e,n){if(Math.abs(e-this.y)<=t&&Math.abs(n-this.x)<=t){var i=Math.abs(t-this.estimatedModuleSize);return i<=1||i/this.estimatedModuleSize<=1}return!1},Object.defineProperty(a.prototype,\\\"CrossCheckStateCount\\\",{get:function(){return this.crossCheckStateCount[0]=0,this.crossCheckStateCount[1]=0,this.crossCheckStateCount[2]=0,this.crossCheckStateCount[3]=0,this.crossCheckStateCount[4]=0,this.crossCheckStateCount}}),a.prototype.foundPatternCross=function(t){for(var e=0,n=0;n<5;n++){var i=t[n];if(0==i)return!1;e+=i}if(e<7)return!1;var r=Math.floor((e<<8)/7),o=Math.floor(r/2);return Math.abs(r-(t[0]<<8))<o&&Math.abs(r-(t[1]<<8))<o&&Math.abs(3*r-(t[2]<<8))<3*o&&Math.abs(r-(t[3]<<8))<o&&Math.abs(r-(t[4]<<8))<o},a.prototype.centerFromEnd=function(t,e){return e-t[4]-t[3]-t[2]/2},a.prototype.crossCheckVertical=function(t,e,n,i){for(var r=this.image,o=r.height,a=this.CrossCheckStateCount,s=t;s>=0&&r.data[e+s*r.width];)a[2]++,s--;if(s<0)return NaN;for(;s>=0&&!r.data[e+s*r.width]&&a[1]<=n;)a[1]++,s--;if(s<0||a[1]>n)return NaN;for(;s>=0&&r.data[e+s*r.width]&&a[0]<=n;)a[0]++,s--;if(a[0]>n)return NaN;for(s=t+1;s<o&&r.data[e+s*r.width];)a[2]++,s++;if(s==o)return NaN;for(;s<o&&!r.data[e+s*r.width]&&a[3]<n;)a[3]++,s++;if(s==o||a[3]>=n)return NaN;for(;s<o&&r.data[e+s*r.width]&&a[4]<n;)a[4]++,s++;if(a[4]>=n)return NaN;var h=a[0]+a[1]+a[2]+a[3]+a[4];return 5*Math.abs(h-i)>=2*i?NaN:this.foundPatternCross(a)?this.centerFromEnd(a,s):NaN},a.prototype.crossCheckHorizontal=function(t,e,n,i){for(var r=this.image,o=r.width,a=this.CrossCheckStateCount,s=t;s>=0&&r.data[s+e*r.width];)a[2]++,s--;if(s<0)return NaN;for(;s>=0&&!r.data[s+e*r.width]&&a[1]<=n;)a[1]++,s--;if(s<0||a[1]>n)return NaN;for(;s>=0&&r.data[s+e*r.width]&&a[0]<=n;)a[0]++,s--;if(a[0]>n)return NaN;for(s=t+1;s<o&&r.data[s+e*r.width];)a[2]++,s++;if(s==o)return NaN;for(;s<o&&!r.data[s+e*r.width]&&a[3]<n;)a[3]++,s++;if(s==o||a[3]>=n)return NaN;for(;s<o&&r.data[s+e*r.width]&&a[4]<n;)a[4]++,s++;if(a[4]>=n)return NaN;var h=a[0]+a[1]+a[2]+a[3]+a[4];return 5*Math.abs(h-i)>=i?NaN:this.foundPatternCross(a)?this.centerFromEnd(a,s):NaN},a.prototype.handlePossibleCenter=function(t,e,n){var i=t[0]+t[1]+t[2]+t[3]+t[4],o=this.centerFromEnd(t,n),a=this.crossCheckVertical(e,Math.floor(o),t[2],i);if(!isNaN(a)&&(o=this.crossCheckHorizontal(Math.floor(o),Math.floor(a),t[2],i),!isNaN(o))){for(var s=i/7,h=!1,f=this.possibleCenters.length,w=0;w<f;w++){var u=this.possibleCenters[w];if(u.aboutEquals(s,a,o)){u.incrementCount(),h=!0;break}}if(!h){var l=new r(o,a,s);this.possibleCenters.push(l),null!=this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(l)}return!0}return!1},a.prototype.selectBestPatterns=function(){var t=this.possibleCenters.length;if(t<3)throw\\\"Couldn't find enough finder patterns:\\\"+t+\\\" patterns found\\\";if(t>3){for(var e=0,n=0,i=0;i<t;i++){var r=this.possibleCenters[i].estimatedModuleSize;e+=r,n+=r*r}var o=e/t;this.possibleCenters.sort(function(t,e){var n=Math.abs(e.estimatedModuleSize-o),i=Math.abs(t.estimatedModuleSize-o);return n<i?-1:n==i?0:1});for(var a=Math.sqrt(n/t-o*o),s=Math.max(.2*o,a),i=this.possibleCenters-1;i>=0;i--){var h=this.possibleCenters[i];Math.abs(h.estimatedModuleSize-o)>s&&this.possibleCenters.splice(i,1)}}return this.possibleCenters.length>3&&this.possibleCenters.sort(function(t,e){return t.count>e.count?-1:t.count<e.count?1:0}),[this.possibleCenters[0],this.possibleCenters[1],this.possibleCenters[2]]},a.prototype.findRowSkip=function(){var t=this.possibleCenters.length;if(t<=1)return 0;for(var e=null,n=0;n<t;n++){var i=this.possibleCenters[n];if(i.count>=2){if(null!=e)return this.hasSkipped=!0,Math.floor((Math.abs(e.X-i.X)-Math.abs(e.Y-i.Y))/2);e=i}}return 0},a.prototype.haveMultiplyConfirmedCenters=function(){for(var t=0,e=0,n=this.possibleCenters.length,i=0;i<n;i++){var r=this.possibleCenters[i];r.count>=2&&(t++,e+=r.estimatedModuleSize)}if(t<3)return!1;for(var o=e/n,a=0,i=0;i<n;i++)r=this.possibleCenters[i],a+=Math.abs(r.estimatedModuleSize-o);return a<=.05*e},a.prototype.findFinderPattern=function(t){this.image=t;var e=t.height,n=t.width,r=Math.floor(3*e/228);r<3&&(r=3);for(var a=!1,s=new Array(5),h=r-1;h<e&&!a;h+=r){s[0]=0,s[1]=0,s[2]=0,s[3]=0,s[4]=0;for(var f=0,w=0;w<n;w++)if(t.data[w+h*t.width])1==(1&f)&&f++,s[f]++;else if(0==(1&f))if(4==f)if(this.foundPatternCross(s)){var u=this.handlePossibleCenter(s,h,w);if(u)if(r=2,this.hasSkipped)a=this.haveMultiplyConfirmedCenters();else{var l=this.findRowSkip();l>s[2]&&(h+=l-s[2]-r,w=n-1)}else{do{w++}while(w<n&&!t.data[w+h*t.width]);w--}f=0,s[0]=0,s[1]=0,s[2]=0,s[3]=0,s[4]=0}else s[0]=s[2],s[1]=s[3],s[2]=s[4],s[3]=1,s[4]=0,f=3;else s[++f]++;else s[f]++;if(this.foundPatternCross(s)){var u=this.handlePossibleCenter(s,h,n);u&&(r=s[0],this.hasSkipped&&(a=this.haveMultiplyConfirmedCenters()))}}var c=this.selectBestPatterns();return i(c),new o(c)}},function(t,e,n){\\\"use strict\\\";var i=n(1),r={};r.checkAndNudgePoints=function(t,e){for(var n=t.width,i=t.height,r=!0,o=0;o<e.length&&r;o+=2){var a=Math.floor(e[o]),s=Math.floor(e[o+1]);if(a<-1||a>n||s<-1||s>i)throw\\\"Error.checkAndNudgePoints \\\";r=!1,-1==a?(e[o]=0,r=!0):a==n&&(e[o]=n-1,r=!0),-1==s?(e[o+1]=0,r=!0):s==i&&(e[o+1]=i-1,r=!0)}r=!0;for(var o=e.length-2;o>=0&&r;o-=2){var a=Math.floor(e[o]),s=Math.floor(e[o+1]);if(a<-1||a>n||s<-1||s>i)throw\\\"Error.checkAndNudgePoints \\\";r=!1,-1==a?(e[o]=0,r=!0):a==n&&(e[o]=n-1,r=!0),-1==s?(e[o+1]=0,r=!0):s==i&&(e[o+1]=i-1,r=!0)}},r.sampleGrid3=function(t,e,n){for(var o=new i.a(e),a=new Array(e<<1),s=0;s<e;s++){for(var h=a.length,f=s+.5,w=0;w<h;w+=2)a[w]=.5+(w>>1),a[w+1]=f;n.transformPoints1(a),r.checkAndNudgePoints(t,a);try{for(var w=0;w<h;w+=2){t.data[Math.floor(a[w])+t.width*Math.floor(a[w+1])]&&o.set_Renamed(w>>1,s)}}catch(t){throw\\\"Error.checkAndNudgePoints\\\"}}return o},e.a=r},function(t,e,n){\\\"use strict\\\";function i(t){this.field=t}e.a=i;var r=n(3),o=n(4);i.prototype.decode=function(t,e){for(var n=new o.a(this.field,t),i=new Array(e),a=0;a<i.length;a++)i[a]=0;for(var s=!0,a=0;a<e;a++){var h=n.evaluateAt(this.field.exp(a));i[i.length-1-a]=h,0!=h&&(s=!1)}if(!s)for(var f=new o.a(this.field,i),w=this.runEuclideanAlgorithm(this.field.buildMonomial(e,1),f,e),u=w[0],l=w[1],c=this.findErrorLocations(u),d=this.findErrorMagnitudes(l,c,!1),a=0;a<c.length;a++){var p=t.length-1-this.field.log(c[a]);if(p<0)throw\\\"ReedSolomonException Bad error location\\\";t[p]=r.a.prototype.addOrSubtract(t[p],d[a])}},i.prototype.runEuclideanAlgorithm=function(t,e,n){if(t.Degree<e.Degree){var i=t;t=e,e=i}for(var r=t,o=e,a=this.field.One,s=this.field.Zero,h=this.field.Zero,f=this.field.One;o.Degree>=Math.floor(n/2);){var w=r,u=a,l=h;if(r=o,a=s,h=f,r.Zero)throw\\\"r_{i-1} was zero\\\";o=w;for(var c=this.field.Zero,d=r.getCoefficient(r.Degree),p=this.field.inverse(d);o.Degree>=r.Degree&&!o.Zero;){var g=o.Degree-r.Degree,v=this.field.multiply(o.getCoefficient(o.Degree),p);c=c.addOrSubtract(this.field.buildMonomial(g,v)),o=o.addOrSubtract(r.multiplyByMonomial(g,v))}s=c.multiply1(a).addOrSubtract(u),f=c.multiply1(h).addOrSubtract(l)}var m=f.getCoefficient(0);if(0==m)throw\\\"ReedSolomonException sigmaTilde(0) was zero\\\";var b=this.field.inverse(m);return[f.multiply2(b),o.multiply2(b)]},i.prototype.findErrorLocations=function(t){var e=t.Degree;if(1==e)return new Array(t.getCoefficient(1));for(var n=new Array(e),i=0,r=1;r<256&&i<e;r++)0==t.evaluateAt(r)&&(n[i]=this.field.inverse(r),i++);if(i!=e)throw\\\"Error locator degree does not match number of roots\\\";return n},i.prototype.findErrorMagnitudes=function(t,e,n){for(var i=e.length,o=new Array(i),a=0;a<i;a++){for(var s=this.field.inverse(e[a]),h=1,f=0;f<i;f++)a!=f&&(h=this.field.multiply(h,r.a.prototype.addOrSubtract(1,this.field.multiply(e[f],s))));o[a]=this.field.multiply(t.evaluateAt(s),this.field.inverse(h)),n&&(o[a]=this.field.multiply(o[a],s))}return o}},function(t,e,n){(function(t){var e=n(6).default,i=new e;i.callback=function(t,e){postMessage({result:e,err:t})},onmessage=function(t){var e=t.data;i.decode(e)}}).call(e,n(7)(t))}]);\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/raw-loader!./src/browser/worker.min.js\n// module id = 3\n// module chunks = 0"," /* eslint-env node */\n'use strict';\n\n// SDP helpers.\nvar SDPUtils = {};\n\n// Generate an alphanumeric identifier for cname or mids.\n// TODO: use UUIDs instead? https://gist.github.com/jed/982883\nSDPUtils.generateIdentifier = function() {\n  return Math.random().toString(36).substr(2, 10);\n};\n\n// The RTCP CNAME used by all peerconnections from the same JS.\nSDPUtils.localCName = SDPUtils.generateIdentifier();\n\n// Splits SDP into lines, dealing with both CRLF and LF.\nSDPUtils.splitLines = function(blob) {\n  return blob.trim().split('\\n').map(function(line) {\n    return line.trim();\n  });\n};\n// Splits SDP into sessionpart and mediasections. Ensures CRLF.\nSDPUtils.splitSections = function(blob) {\n  var parts = blob.split('\\nm=');\n  return parts.map(function(part, index) {\n    return (index > 0 ? 'm=' + part : part).trim() + '\\r\\n';\n  });\n};\n\n// Returns lines that start with a certain prefix.\nSDPUtils.matchPrefix = function(blob, prefix) {\n  return SDPUtils.splitLines(blob).filter(function(line) {\n    return line.indexOf(prefix) === 0;\n  });\n};\n\n// Parses an ICE candidate line. Sample input:\n// candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8\n// rport 55996\"\nSDPUtils.parseCandidate = function(line) {\n  var parts;\n  // Parse both variants.\n  if (line.indexOf('a=candidate:') === 0) {\n    parts = line.substring(12).split(' ');\n  } else {\n    parts = line.substring(10).split(' ');\n  }\n\n  var candidate = {\n    foundation: parts[0],\n    component: parts[1],\n    protocol: parts[2].toLowerCase(),\n    priority: parseInt(parts[3], 10),\n    ip: parts[4],\n    port: parseInt(parts[5], 10),\n    // skip parts[6] == 'typ'\n    type: parts[7]\n  };\n\n  for (var i = 8; i < parts.length; i += 2) {\n    switch (parts[i]) {\n      case 'raddr':\n        candidate.relatedAddress = parts[i + 1];\n        break;\n      case 'rport':\n        candidate.relatedPort = parseInt(parts[i + 1], 10);\n        break;\n      case 'tcptype':\n        candidate.tcpType = parts[i + 1];\n        break;\n      default: // extension handling, in particular ufrag\n        candidate[parts[i]] = parts[i + 1];\n        break;\n    }\n  }\n  return candidate;\n};\n\n// Translates a candidate object into SDP candidate attribute.\nSDPUtils.writeCandidate = function(candidate) {\n  var sdp = [];\n  sdp.push(candidate.foundation);\n  sdp.push(candidate.component);\n  sdp.push(candidate.protocol.toUpperCase());\n  sdp.push(candidate.priority);\n  sdp.push(candidate.ip);\n  sdp.push(candidate.port);\n\n  var type = candidate.type;\n  sdp.push('typ');\n  sdp.push(type);\n  if (type !== 'host' && candidate.relatedAddress &&\n      candidate.relatedPort) {\n    sdp.push('raddr');\n    sdp.push(candidate.relatedAddress); // was: relAddr\n    sdp.push('rport');\n    sdp.push(candidate.relatedPort); // was: relPort\n  }\n  if (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {\n    sdp.push('tcptype');\n    sdp.push(candidate.tcpType);\n  }\n  return 'candidate:' + sdp.join(' ');\n};\n\n// Parses an ice-options line, returns an array of option tags.\n// a=ice-options:foo bar\nSDPUtils.parseIceOptions = function(line) {\n  return line.substr(14).split(' ');\n}\n\n// Parses an rtpmap line, returns RTCRtpCoddecParameters. Sample input:\n// a=rtpmap:111 opus/48000/2\nSDPUtils.parseRtpMap = function(line) {\n  var parts = line.substr(9).split(' ');\n  var parsed = {\n    payloadType: parseInt(parts.shift(), 10) // was: id\n  };\n\n  parts = parts[0].split('/');\n\n  parsed.name = parts[0];\n  parsed.clockRate = parseInt(parts[1], 10); // was: clockrate\n  // was: channels\n  parsed.numChannels = parts.length === 3 ? parseInt(parts[2], 10) : 1;\n  return parsed;\n};\n\n// Generate an a=rtpmap line from RTCRtpCodecCapability or\n// RTCRtpCodecParameters.\nSDPUtils.writeRtpMap = function(codec) {\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  return 'a=rtpmap:' + pt + ' ' + codec.name + '/' + codec.clockRate +\n      (codec.numChannels !== 1 ? '/' + codec.numChannels : '') + '\\r\\n';\n};\n\n// Parses an a=extmap line (headerextension from RFC 5285). Sample input:\n// a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n// a=extmap:2/sendonly urn:ietf:params:rtp-hdrext:toffset\nSDPUtils.parseExtmap = function(line) {\n  var parts = line.substr(9).split(' ');\n  return {\n    id: parseInt(parts[0], 10),\n    direction: parts[0].indexOf('/') > 0 ? parts[0].split('/')[1] : 'sendrecv',\n    uri: parts[1]\n  };\n};\n\n// Generates a=extmap line from RTCRtpHeaderExtensionParameters or\n// RTCRtpHeaderExtension.\nSDPUtils.writeExtmap = function(headerExtension) {\n  return 'a=extmap:' + (headerExtension.id || headerExtension.preferredId) +\n      (headerExtension.direction && headerExtension.direction !== 'sendrecv'\n          ? '/' + headerExtension.direction\n          : '') +\n      ' ' + headerExtension.uri + '\\r\\n';\n};\n\n// Parses an ftmp line, returns dictionary. Sample input:\n// a=fmtp:96 vbr=on;cng=on\n// Also deals with vbr=on; cng=on\nSDPUtils.parseFmtp = function(line) {\n  var parsed = {};\n  var kv;\n  var parts = line.substr(line.indexOf(' ') + 1).split(';');\n  for (var j = 0; j < parts.length; j++) {\n    kv = parts[j].trim().split('=');\n    parsed[kv[0].trim()] = kv[1];\n  }\n  return parsed;\n};\n\n// Generates an a=ftmp line from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeFmtp = function(codec) {\n  var line = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.parameters && Object.keys(codec.parameters).length) {\n    var params = [];\n    Object.keys(codec.parameters).forEach(function(param) {\n      params.push(param + '=' + codec.parameters[param]);\n    });\n    line += 'a=fmtp:' + pt + ' ' + params.join(';') + '\\r\\n';\n  }\n  return line;\n};\n\n// Parses an rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:\n// a=rtcp-fb:98 nack rpsi\nSDPUtils.parseRtcpFb = function(line) {\n  var parts = line.substr(line.indexOf(' ') + 1).split(' ');\n  return {\n    type: parts.shift(),\n    parameter: parts.join(' ')\n  };\n};\n// Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeRtcpFb = function(codec) {\n  var lines = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.rtcpFeedback && codec.rtcpFeedback.length) {\n    // FIXME: special handling for trr-int?\n    codec.rtcpFeedback.forEach(function(fb) {\n      lines += 'a=rtcp-fb:' + pt + ' ' + fb.type +\n      (fb.parameter && fb.parameter.length ? ' ' + fb.parameter : '') +\n          '\\r\\n';\n    });\n  }\n  return lines;\n};\n\n// Parses an RFC 5576 ssrc media attribute. Sample input:\n// a=ssrc:3735928559 cname:something\nSDPUtils.parseSsrcMedia = function(line) {\n  var sp = line.indexOf(' ');\n  var parts = {\n    ssrc: parseInt(line.substr(7, sp - 7), 10)\n  };\n  var colon = line.indexOf(':', sp);\n  if (colon > -1) {\n    parts.attribute = line.substr(sp + 1, colon - sp - 1);\n    parts.value = line.substr(colon + 1);\n  } else {\n    parts.attribute = line.substr(sp + 1);\n  }\n  return parts;\n};\n\n// Extracts the MID (RFC 5888) from a media section.\n// returns the MID or undefined if no mid line was found.\nSDPUtils.getMid = function(mediaSection) {\n  var mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:')[0];\n  if (mid) {\n    return mid.substr(6);\n  }\n}\n\nSDPUtils.parseFingerprint = function(line) {\n  var parts = line.substr(14).split(' ');\n  return {\n    algorithm: parts[0].toLowerCase(), // algorithm is case-sensitive in Edge.\n    value: parts[1]\n  };\n};\n\n// Extracts DTLS parameters from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the fingerprint line as input. See also getIceParameters.\nSDPUtils.getDtlsParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n      'a=fingerprint:');\n  // Note: a=setup line is ignored since we use the 'auto' role.\n  // Note2: 'algorithm' is not case sensitive except in Edge.\n  return {\n    role: 'auto',\n    fingerprints: lines.map(SDPUtils.parseFingerprint)\n  };\n};\n\n// Serializes DTLS parameters to SDP.\nSDPUtils.writeDtlsParameters = function(params, setupType) {\n  var sdp = 'a=setup:' + setupType + '\\r\\n';\n  params.fingerprints.forEach(function(fp) {\n    sdp += 'a=fingerprint:' + fp.algorithm + ' ' + fp.value + '\\r\\n';\n  });\n  return sdp;\n};\n// Parses ICE information from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the ice-ufrag and ice-pwd lines as input.\nSDPUtils.getIceParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  // Search in session part, too.\n  lines = lines.concat(SDPUtils.splitLines(sessionpart));\n  var iceParameters = {\n    usernameFragment: lines.filter(function(line) {\n      return line.indexOf('a=ice-ufrag:') === 0;\n    })[0].substr(12),\n    password: lines.filter(function(line) {\n      return line.indexOf('a=ice-pwd:') === 0;\n    })[0].substr(10)\n  };\n  return iceParameters;\n};\n\n// Serializes ICE parameters to SDP.\nSDPUtils.writeIceParameters = function(params) {\n  return 'a=ice-ufrag:' + params.usernameFragment + '\\r\\n' +\n      'a=ice-pwd:' + params.password + '\\r\\n';\n};\n\n// Parses the SDP media section and returns RTCRtpParameters.\nSDPUtils.parseRtpParameters = function(mediaSection) {\n  var description = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: [],\n    rtcp: []\n  };\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  for (var i = 3; i < mline.length; i++) { // find all codecs from mline[3..]\n    var pt = mline[i];\n    var rtpmapline = SDPUtils.matchPrefix(\n        mediaSection, 'a=rtpmap:' + pt + ' ')[0];\n    if (rtpmapline) {\n      var codec = SDPUtils.parseRtpMap(rtpmapline);\n      var fmtps = SDPUtils.matchPrefix(\n          mediaSection, 'a=fmtp:' + pt + ' ');\n      // Only the first a=fmtp:<pt> is considered.\n      codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};\n      codec.rtcpFeedback = SDPUtils.matchPrefix(\n          mediaSection, 'a=rtcp-fb:' + pt + ' ')\n        .map(SDPUtils.parseRtcpFb);\n      description.codecs.push(codec);\n      // parse FEC mechanisms from rtpmap lines.\n      switch (codec.name.toUpperCase()) {\n        case 'RED':\n        case 'ULPFEC':\n          description.fecMechanisms.push(codec.name.toUpperCase());\n          break;\n        default: // only RED and ULPFEC are recognized as FEC mechanisms.\n          break;\n      }\n    }\n  }\n  SDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach(function(line) {\n    description.headerExtensions.push(SDPUtils.parseExtmap(line));\n  });\n  // FIXME: parse rtcp.\n  return description;\n};\n\n// Generates parts of the SDP media section describing the capabilities /\n// parameters.\nSDPUtils.writeRtpDescription = function(kind, caps) {\n  var sdp = '';\n\n  // Build the mline.\n  sdp += 'm=' + kind + ' ';\n  sdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.\n  sdp += ' UDP/TLS/RTP/SAVPF ';\n  sdp += caps.codecs.map(function(codec) {\n    if (codec.preferredPayloadType !== undefined) {\n      return codec.preferredPayloadType;\n    }\n    return codec.payloadType;\n  }).join(' ') + '\\r\\n';\n\n  sdp += 'c=IN IP4 0.0.0.0\\r\\n';\n  sdp += 'a=rtcp:9 IN IP4 0.0.0.0\\r\\n';\n\n  // Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.\n  caps.codecs.forEach(function(codec) {\n    sdp += SDPUtils.writeRtpMap(codec);\n    sdp += SDPUtils.writeFmtp(codec);\n    sdp += SDPUtils.writeRtcpFb(codec);\n  });\n  var maxptime = 0;\n  caps.codecs.forEach(function(codec) {\n    if (codec.maxptime > maxptime) {\n      maxptime = codec.maxptime;\n    }\n  });\n  if (maxptime > 0) {\n    sdp += 'a=maxptime:' + maxptime + '\\r\\n';\n  }\n  sdp += 'a=rtcp-mux\\r\\n';\n\n  caps.headerExtensions.forEach(function(extension) {\n    sdp += SDPUtils.writeExtmap(extension);\n  });\n  // FIXME: write fecMechanisms.\n  return sdp;\n};\n\n// Parses the SDP media section and returns an array of\n// RTCRtpEncodingParameters.\nSDPUtils.parseRtpEncodingParameters = function(mediaSection) {\n  var encodingParameters = [];\n  var description = SDPUtils.parseRtpParameters(mediaSection);\n  var hasRed = description.fecMechanisms.indexOf('RED') !== -1;\n  var hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;\n\n  // filter a=ssrc:... cname:, ignore PlanB-msid\n  var ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n  .map(function(line) {\n    return SDPUtils.parseSsrcMedia(line);\n  })\n  .filter(function(parts) {\n    return parts.attribute === 'cname';\n  });\n  var primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;\n  var secondarySsrc;\n\n  var flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID')\n  .map(function(line) {\n    var parts = line.split(' ');\n    parts.shift();\n    return parts.map(function(part) {\n      return parseInt(part, 10);\n    });\n  });\n  if (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {\n    secondarySsrc = flows[0][1];\n  }\n\n  description.codecs.forEach(function(codec) {\n    if (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {\n      var encParam = {\n        ssrc: primarySsrc,\n        codecPayloadType: parseInt(codec.parameters.apt, 10),\n        rtx: {\n          ssrc: secondarySsrc\n        }\n      };\n      encodingParameters.push(encParam);\n      if (hasRed) {\n        encParam = JSON.parse(JSON.stringify(encParam));\n        encParam.fec = {\n          ssrc: secondarySsrc,\n          mechanism: hasUlpfec ? 'red+ulpfec' : 'red'\n        };\n        encodingParameters.push(encParam);\n      }\n    }\n  });\n  if (encodingParameters.length === 0 && primarySsrc) {\n    encodingParameters.push({\n      ssrc: primarySsrc\n    });\n  }\n\n  // we support both b=AS and b=TIAS but interpret AS as TIAS.\n  var bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');\n  if (bandwidth.length) {\n    if (bandwidth[0].indexOf('b=TIAS:') === 0) {\n      bandwidth = parseInt(bandwidth[0].substr(7), 10);\n    } else if (bandwidth[0].indexOf('b=AS:') === 0) {\n      bandwidth = parseInt(bandwidth[0].substr(5), 10);\n    }\n    encodingParameters.forEach(function(params) {\n      params.maxBitrate = bandwidth;\n    });\n  }\n  return encodingParameters;\n};\n\n// parses http://draft.ortc.org/#rtcrtcpparameters*\nSDPUtils.parseRtcpParameters = function(mediaSection) {\n  var rtcpParameters = {};\n\n  var cname;\n  // Gets the first SSRC. Note that with RTX there might be multiple\n  // SSRCs.\n  var remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n      .map(function(line) {\n        return SDPUtils.parseSsrcMedia(line);\n      })\n      .filter(function(obj) {\n        return obj.attribute === 'cname';\n      })[0];\n  if (remoteSsrc) {\n    rtcpParameters.cname = remoteSsrc.value;\n    rtcpParameters.ssrc = remoteSsrc.ssrc;\n  }\n\n  // Edge uses the compound attribute instead of reducedSize\n  // compound is !reducedSize\n  var rsize = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-rsize');\n  rtcpParameters.reducedSize = rsize.length > 0;\n  rtcpParameters.compound = rsize.length === 0;\n\n  // parses the rtcp-mux attrіbute.\n  // Note that Edge does not support unmuxed RTCP.\n  var mux = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-mux');\n  rtcpParameters.mux = mux.length > 0;\n\n  return rtcpParameters;\n};\n\n// parses either a=msid: or a=ssrc:... msid lines and returns\n// the id of the MediaStream and MediaStreamTrack.\nSDPUtils.parseMsid = function(mediaSection) {\n  var parts;\n  var spec = SDPUtils.matchPrefix(mediaSection, 'a=msid:');\n  if (spec.length === 1) {\n    parts = spec[0].substr(7).split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n  var planB = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n  .map(function(line) {\n    return SDPUtils.parseSsrcMedia(line);\n  })\n  .filter(function(parts) {\n    return parts.attribute === 'msid';\n  });\n  if (planB.length > 0) {\n    parts = planB[0].value.split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n};\n\nSDPUtils.writeSessionBoilerplate = function() {\n  // FIXME: sess-id should be an NTP timestamp.\n  return 'v=0\\r\\n' +\n      'o=thisisadapterortc 8169639915646943137 2 IN IP4 127.0.0.1\\r\\n' +\n      's=-\\r\\n' +\n      't=0 0\\r\\n';\n};\n\nSDPUtils.writeMediaSection = function(transceiver, caps, type, stream) {\n  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\n\n  // Map ICE parameters (ufrag, pwd) to SDP.\n  sdp += SDPUtils.writeIceParameters(\n      transceiver.iceGatherer.getLocalParameters());\n\n  // Map DTLS parameters to SDP.\n  sdp += SDPUtils.writeDtlsParameters(\n      transceiver.dtlsTransport.getLocalParameters(),\n      type === 'offer' ? 'actpass' : 'active');\n\n  sdp += 'a=mid:' + transceiver.mid + '\\r\\n';\n\n  if (transceiver.direction) {\n    sdp += 'a=' + transceiver.direction + '\\r\\n';\n  } else if (transceiver.rtpSender && transceiver.rtpReceiver) {\n    sdp += 'a=sendrecv\\r\\n';\n  } else if (transceiver.rtpSender) {\n    sdp += 'a=sendonly\\r\\n';\n  } else if (transceiver.rtpReceiver) {\n    sdp += 'a=recvonly\\r\\n';\n  } else {\n    sdp += 'a=inactive\\r\\n';\n  }\n\n  if (transceiver.rtpSender) {\n    // spec.\n    var msid = 'msid:' + stream.id + ' ' +\n        transceiver.rtpSender.track.id + '\\r\\n';\n    sdp += 'a=' + msid;\n\n    // for Chrome.\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n        ' ' + msid;\n    if (transceiver.sendEncodingParameters[0].rtx) {\n      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n          ' ' + msid;\n      sdp += 'a=ssrc-group:FID ' +\n          transceiver.sendEncodingParameters[0].ssrc + ' ' +\n          transceiver.sendEncodingParameters[0].rtx.ssrc +\n          '\\r\\n';\n    }\n  }\n  // FIXME: this should be written by writeRtpDescription.\n  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n      ' cname:' + SDPUtils.localCName + '\\r\\n';\n  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n        ' cname:' + SDPUtils.localCName + '\\r\\n';\n  }\n  return sdp;\n};\n\n// Gets the direction from the mediaSection or the sessionpart.\nSDPUtils.getDirection = function(mediaSection, sessionpart) {\n  // Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.\n  var lines = SDPUtils.splitLines(mediaSection);\n  for (var i = 0; i < lines.length; i++) {\n    switch (lines[i]) {\n      case 'a=sendrecv':\n      case 'a=sendonly':\n      case 'a=recvonly':\n      case 'a=inactive':\n        return lines[i].substr(2);\n      default:\n        // FIXME: What should happen here?\n    }\n  }\n  if (sessionpart) {\n    return SDPUtils.getDirection(sessionpart);\n  }\n  return 'sendrecv';\n};\n\nSDPUtils.getKind = function(mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  return mline[0].substr(2);\n};\n\nSDPUtils.isRejected = function(mediaSection) {\n  return mediaSection.split(' ', 2)[1] === '0';\n};\n\n// Expose public methods.\nmodule.exports = SDPUtils;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/sdp/sdp.js\n// module id = 4\n// module chunks = 0","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n\n'use strict';\n\n// Shimming starts here.\n(function() {\n  // Utils.\n  var utils = require('./utils');\n  var logging = utils.log;\n  var browserDetails = utils.browserDetails;\n  // Export to the adapter global object visible in the browser.\n  module.exports.browserDetails = browserDetails;\n  module.exports.extractVersion = utils.extractVersion;\n  module.exports.disableLog = utils.disableLog;\n\n  // Uncomment the line below if you want logging to occur, including logging\n  // for the switch statement below. Can also be turned on in the browser via\n  // adapter.disableLog(false), but then logging from the switch statement below\n  // will not appear.\n  // require('./utils').disableLog(false);\n\n  // Browser shims.\n  var chromeShim = require('./chrome/chrome_shim') || null;\n  var edgeShim = require('./edge/edge_shim') || null;\n  var firefoxShim = require('./firefox/firefox_shim') || null;\n  var safariShim = require('./safari/safari_shim') || null;\n\n  // Shim browser if found.\n  switch (browserDetails.browser) {\n    case 'chrome':\n      if (!chromeShim || !chromeShim.shimPeerConnection) {\n        logging('Chrome shim is not included in this adapter release.');\n        return;\n      }\n      logging('adapter.js shimming chrome.');\n      // Export to the adapter global object visible in the browser.\n      module.exports.browserShim = chromeShim;\n\n      chromeShim.shimGetUserMedia();\n      chromeShim.shimMediaStream();\n      utils.shimCreateObjectURL();\n      chromeShim.shimSourceObject();\n      chromeShim.shimPeerConnection();\n      chromeShim.shimOnTrack();\n      chromeShim.shimGetSendersWithDtmf();\n      break;\n    case 'firefox':\n      if (!firefoxShim || !firefoxShim.shimPeerConnection) {\n        logging('Firefox shim is not included in this adapter release.');\n        return;\n      }\n      logging('adapter.js shimming firefox.');\n      // Export to the adapter global object visible in the browser.\n      module.exports.browserShim = firefoxShim;\n\n      firefoxShim.shimGetUserMedia();\n      utils.shimCreateObjectURL();\n      firefoxShim.shimSourceObject();\n      firefoxShim.shimPeerConnection();\n      firefoxShim.shimOnTrack();\n      break;\n    case 'edge':\n      if (!edgeShim || !edgeShim.shimPeerConnection) {\n        logging('MS edge shim is not included in this adapter release.');\n        return;\n      }\n      logging('adapter.js shimming edge.');\n      // Export to the adapter global object visible in the browser.\n      module.exports.browserShim = edgeShim;\n\n      edgeShim.shimGetUserMedia();\n      utils.shimCreateObjectURL();\n      edgeShim.shimPeerConnection();\n      edgeShim.shimReplaceTrack();\n      break;\n    case 'safari':\n      if (!safariShim) {\n        logging('Safari shim is not included in this adapter release.');\n        return;\n      }\n      logging('adapter.js shimming safari.');\n      // Export to the adapter global object visible in the browser.\n      module.exports.browserShim = safariShim;\n\n      safariShim.shimCallbacksAPI();\n      safariShim.shimAddStream();\n      safariShim.shimOnAddStream();\n      safariShim.shimGetUserMedia();\n      break;\n    default:\n      logging('Unsupported browser!');\n  }\n})();\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/webrtc-adapter/src/js/adapter_core.js\n// module id = 5\n// module chunks = 0","\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\nvar logging = require('../utils.js').log;\nvar browserDetails = require('../utils.js').browserDetails;\n\nvar chromeShim = {\n  shimMediaStream: function() {\n    window.MediaStream = window.MediaStream || window.webkitMediaStream;\n  },\n\n  shimOnTrack: function() {\n    if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in\n        window.RTCPeerConnection.prototype)) {\n      Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n        get: function() {\n          return this._ontrack;\n        },\n        set: function(f) {\n          var self = this;\n          if (this._ontrack) {\n            this.removeEventListener('track', this._ontrack);\n            this.removeEventListener('addstream', this._ontrackpoly);\n          }\n          this.addEventListener('track', this._ontrack = f);\n          this.addEventListener('addstream', this._ontrackpoly = function(e) {\n            // onaddstream does not fire when a track is added to an existing\n            // stream. But stream.onaddtrack is implemented so we use that.\n            e.stream.addEventListener('addtrack', function(te) {\n              var receiver;\n              if (RTCPeerConnection.prototype.getReceivers) {\n                receiver = self.getReceivers().find(function(r) {\n                  return r.track.id === te.track.id;\n                });\n              } else {\n                receiver = {track: te.track};\n              }\n\n              var event = new Event('track');\n              event.track = te.track;\n              event.receiver = receiver;\n              event.streams = [e.stream];\n              self.dispatchEvent(event);\n            });\n            e.stream.getTracks().forEach(function(track) {\n              var receiver;\n              if (RTCPeerConnection.prototype.getReceivers) {\n                receiver = self.getReceivers().find(function(r) {\n                  return r.track.id === track.id;\n                });\n              } else {\n                receiver = {track: track};\n              }\n              var event = new Event('track');\n              event.track = track;\n              event.receiver = receiver;\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            }.bind(this));\n          }.bind(this));\n        }\n      });\n    }\n  },\n\n  shimGetSendersWithDtmf: function() {\n    if (typeof window === 'object' && window.RTCPeerConnection &&\n        !('getSenders' in RTCPeerConnection.prototype) &&\n        'createDTMFSender' in RTCPeerConnection.prototype) {\n      RTCPeerConnection.prototype.getSenders = function() {\n        return this._senders || [];\n      };\n      var origAddStream = RTCPeerConnection.prototype.addStream;\n      var origRemoveStream = RTCPeerConnection.prototype.removeStream;\n\n      if (!RTCPeerConnection.prototype.addTrack) {\n        RTCPeerConnection.prototype.addTrack = function(track, stream) {\n          var pc = this;\n          if (pc.signalingState === 'closed') {\n            throw new DOMException(\n              'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n              'InvalidStateError');\n          }\n          var streams = [].slice.call(arguments, 1);\n          if (streams.length !== 1 ||\n              !streams[0].getTracks().find(function(t) {\n                return t === track;\n              })) {\n            // this is not fully correct but all we can manage without\n            // [[associated MediaStreams]] internal slot.\n            throw new DOMException(\n              'The adapter.js addTrack polyfill only supports a single ' +\n              ' stream which is associated with the specified track.',\n              'NotSupportedError');\n          }\n\n          pc._senders = pc._senders || [];\n          var alreadyExists = pc._senders.find(function(t) {\n            return t.track === track;\n          });\n          if (alreadyExists) {\n            throw new DOMException('Track already exists.',\n                'InvalidAccessError');\n          }\n\n          pc._streams = pc._streams || {};\n          var oldStream = pc._streams[stream.id];\n          if (oldStream) {\n            oldStream.addTrack(track);\n            pc.removeStream(oldStream);\n            pc.addStream(oldStream);\n          } else {\n            var newStream = new MediaStream([track]);\n            pc._streams[stream.id] = newStream;\n            pc.addStream(newStream);\n          }\n\n          var sender = {\n            track: track,\n            get dtmf() {\n              if (this._dtmf === undefined) {\n                if (track.kind === 'audio') {\n                  this._dtmf = pc.createDTMFSender(track);\n                } else {\n                  this._dtmf = null;\n                }\n              }\n              return this._dtmf;\n            }\n          };\n          pc._senders.push(sender);\n          return sender;\n        };\n      }\n      RTCPeerConnection.prototype.addStream = function(stream) {\n        var pc = this;\n        pc._senders = pc._senders || [];\n        origAddStream.apply(pc, [stream]);\n        stream.getTracks().forEach(function(track) {\n          pc._senders.push({\n            track: track,\n            get dtmf() {\n              if (this._dtmf === undefined) {\n                if (track.kind === 'audio') {\n                  this._dtmf = pc.createDTMFSender(track);\n                } else {\n                  this._dtmf = null;\n                }\n              }\n              return this._dtmf;\n            }\n          });\n        });\n      };\n\n      RTCPeerConnection.prototype.removeStream = function(stream) {\n        var pc = this;\n        pc._senders = pc._senders || [];\n        origRemoveStream.apply(pc, [stream]);\n        stream.getTracks().forEach(function(track) {\n          var sender = pc._senders.find(function(s) {\n            return s.track === track;\n          });\n          if (sender) {\n            pc._senders.splice(pc._senders.indexOf(sender), 1); // remove sender\n          }\n        });\n      };\n    }\n  },\n\n  shimSourceObject: function() {\n    if (typeof window === 'object') {\n      if (window.HTMLMediaElement &&\n        !('srcObject' in window.HTMLMediaElement.prototype)) {\n        // Shim the srcObject property, once, when HTMLMediaElement is found.\n        Object.defineProperty(window.HTMLMediaElement.prototype, 'srcObject', {\n          get: function() {\n            return this._srcObject;\n          },\n          set: function(stream) {\n            var self = this;\n            // Use _srcObject as a private property for this shim\n            this._srcObject = stream;\n            if (this.src) {\n              URL.revokeObjectURL(this.src);\n            }\n\n            if (!stream) {\n              this.src = '';\n              return undefined;\n            }\n            this.src = URL.createObjectURL(stream);\n            // We need to recreate the blob url when a track is added or\n            // removed. Doing it manually since we want to avoid a recursion.\n            stream.addEventListener('addtrack', function() {\n              if (self.src) {\n                URL.revokeObjectURL(self.src);\n              }\n              self.src = URL.createObjectURL(stream);\n            });\n            stream.addEventListener('removetrack', function() {\n              if (self.src) {\n                URL.revokeObjectURL(self.src);\n              }\n              self.src = URL.createObjectURL(stream);\n            });\n          }\n        });\n      }\n    }\n  },\n\n  shimPeerConnection: function() {\n    // The RTCPeerConnection object.\n    if (!window.RTCPeerConnection) {\n      window.RTCPeerConnection = function(pcConfig, pcConstraints) {\n        // Translate iceTransportPolicy to iceTransports,\n        // see https://code.google.com/p/webrtc/issues/detail?id=4869\n        // this was fixed in M56 along with unprefixing RTCPeerConnection.\n        logging('PeerConnection');\n        if (pcConfig && pcConfig.iceTransportPolicy) {\n          pcConfig.iceTransports = pcConfig.iceTransportPolicy;\n        }\n\n        return new webkitRTCPeerConnection(pcConfig, pcConstraints);\n      };\n      window.RTCPeerConnection.prototype = webkitRTCPeerConnection.prototype;\n      // wrap static methods. Currently just generateCertificate.\n      if (webkitRTCPeerConnection.generateCertificate) {\n        Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n          get: function() {\n            return webkitRTCPeerConnection.generateCertificate;\n          }\n        });\n      }\n    } else {\n      // migrate from non-spec RTCIceServer.url to RTCIceServer.urls\n      var OrigPeerConnection = RTCPeerConnection;\n      window.RTCPeerConnection = function(pcConfig, pcConstraints) {\n        if (pcConfig && pcConfig.iceServers) {\n          var newIceServers = [];\n          for (var i = 0; i < pcConfig.iceServers.length; i++) {\n            var server = pcConfig.iceServers[i];\n            if (!server.hasOwnProperty('urls') &&\n                server.hasOwnProperty('url')) {\n              console.warn('RTCIceServer.url is deprecated! Use urls instead.');\n              server = JSON.parse(JSON.stringify(server));\n              server.urls = server.url;\n              newIceServers.push(server);\n            } else {\n              newIceServers.push(pcConfig.iceServers[i]);\n            }\n          }\n          pcConfig.iceServers = newIceServers;\n        }\n        return new OrigPeerConnection(pcConfig, pcConstraints);\n      };\n      window.RTCPeerConnection.prototype = OrigPeerConnection.prototype;\n      // wrap static methods. Currently just generateCertificate.\n      Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n        get: function() {\n          return OrigPeerConnection.generateCertificate;\n        }\n      });\n    }\n\n    var origGetStats = RTCPeerConnection.prototype.getStats;\n    RTCPeerConnection.prototype.getStats = function(selector,\n        successCallback, errorCallback) {\n      var self = this;\n      var args = arguments;\n\n      // If selector is a function then we are in the old style stats so just\n      // pass back the original getStats format to avoid breaking old users.\n      if (arguments.length > 0 && typeof selector === 'function') {\n        return origGetStats.apply(this, arguments);\n      }\n\n      // When spec-style getStats is supported, return those when called with\n      // either no arguments or the selector argument is null.\n      if (origGetStats.length === 0 && (arguments.length === 0 ||\n          typeof arguments[0] !== 'function')) {\n        return origGetStats.apply(this, []);\n      }\n\n      var fixChromeStats_ = function(response) {\n        var standardReport = {};\n        var reports = response.result();\n        reports.forEach(function(report) {\n          var standardStats = {\n            id: report.id,\n            timestamp: report.timestamp,\n            type: {\n              localcandidate: 'local-candidate',\n              remotecandidate: 'remote-candidate'\n            }[report.type] || report.type\n          };\n          report.names().forEach(function(name) {\n            standardStats[name] = report.stat(name);\n          });\n          standardReport[standardStats.id] = standardStats;\n        });\n\n        return standardReport;\n      };\n\n      // shim getStats with maplike support\n      var makeMapStats = function(stats) {\n        return new Map(Object.keys(stats).map(function(key) {\n          return [key, stats[key]];\n        }));\n      };\n\n      if (arguments.length >= 2) {\n        var successCallbackWrapper_ = function(response) {\n          args[1](makeMapStats(fixChromeStats_(response)));\n        };\n\n        return origGetStats.apply(this, [successCallbackWrapper_,\n          arguments[0]]);\n      }\n\n      // promise-support\n      return new Promise(function(resolve, reject) {\n        origGetStats.apply(self, [\n          function(response) {\n            resolve(makeMapStats(fixChromeStats_(response)));\n          }, reject]);\n      }).then(successCallback, errorCallback);\n    };\n\n    // add promise support -- natively available in Chrome 51\n    if (browserDetails.version < 51) {\n      ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n          .forEach(function(method) {\n            var nativeMethod = RTCPeerConnection.prototype[method];\n            RTCPeerConnection.prototype[method] = function() {\n              var args = arguments;\n              var self = this;\n              var promise = new Promise(function(resolve, reject) {\n                nativeMethod.apply(self, [args[0], resolve, reject]);\n              });\n              if (args.length < 2) {\n                return promise;\n              }\n              return promise.then(function() {\n                args[1].apply(null, []);\n              },\n              function(err) {\n                if (args.length >= 3) {\n                  args[2].apply(null, [err]);\n                }\n              });\n            };\n          });\n    }\n\n    // promise support for createOffer and createAnswer. Available (without\n    // bugs) since M52: crbug/619289\n    if (browserDetails.version < 52) {\n      ['createOffer', 'createAnswer'].forEach(function(method) {\n        var nativeMethod = RTCPeerConnection.prototype[method];\n        RTCPeerConnection.prototype[method] = function() {\n          var self = this;\n          if (arguments.length < 1 || (arguments.length === 1 &&\n              typeof arguments[0] === 'object')) {\n            var opts = arguments.length === 1 ? arguments[0] : undefined;\n            return new Promise(function(resolve, reject) {\n              nativeMethod.apply(self, [resolve, reject, opts]);\n            });\n          }\n          return nativeMethod.apply(this, arguments);\n        };\n      });\n    }\n\n    // shim implicit creation of RTCSessionDescription/RTCIceCandidate\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n        .forEach(function(method) {\n          var nativeMethod = RTCPeerConnection.prototype[method];\n          RTCPeerConnection.prototype[method] = function() {\n            arguments[0] = new ((method === 'addIceCandidate') ?\n                RTCIceCandidate : RTCSessionDescription)(arguments[0]);\n            return nativeMethod.apply(this, arguments);\n          };\n        });\n\n    // support for addIceCandidate(null or undefined)\n    var nativeAddIceCandidate =\n        RTCPeerConnection.prototype.addIceCandidate;\n    RTCPeerConnection.prototype.addIceCandidate = function() {\n      if (!arguments[0]) {\n        if (arguments[1]) {\n          arguments[1].apply(null);\n        }\n        return Promise.resolve();\n      }\n      return nativeAddIceCandidate.apply(this, arguments);\n    };\n  }\n};\n\n\n// Expose public methods.\nmodule.exports = {\n  shimMediaStream: chromeShim.shimMediaStream,\n  shimOnTrack: chromeShim.shimOnTrack,\n  shimGetSendersWithDtmf: chromeShim.shimGetSendersWithDtmf,\n  shimSourceObject: chromeShim.shimSourceObject,\n  shimPeerConnection: chromeShim.shimPeerConnection,\n  shimGetUserMedia: require('./getusermedia')\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/webrtc-adapter/src/js/chrome/chrome_shim.js\n// module id = 6\n// module chunks = 0","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\nvar logging = require('../utils.js').log;\nvar browserDetails = require('../utils.js').browserDetails;\n\n// Expose public methods.\nmodule.exports = function() {\n  var constraintsToChrome_ = function(c) {\n    if (typeof c !== 'object' || c.mandatory || c.optional) {\n      return c;\n    }\n    var cc = {};\n    Object.keys(c).forEach(function(key) {\n      if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n        return;\n      }\n      var r = (typeof c[key] === 'object') ? c[key] : {ideal: c[key]};\n      if (r.exact !== undefined && typeof r.exact === 'number') {\n        r.min = r.max = r.exact;\n      }\n      var oldname_ = function(prefix, name) {\n        if (prefix) {\n          return prefix + name.charAt(0).toUpperCase() + name.slice(1);\n        }\n        return (name === 'deviceId') ? 'sourceId' : name;\n      };\n      if (r.ideal !== undefined) {\n        cc.optional = cc.optional || [];\n        var oc = {};\n        if (typeof r.ideal === 'number') {\n          oc[oldname_('min', key)] = r.ideal;\n          cc.optional.push(oc);\n          oc = {};\n          oc[oldname_('max', key)] = r.ideal;\n          cc.optional.push(oc);\n        } else {\n          oc[oldname_('', key)] = r.ideal;\n          cc.optional.push(oc);\n        }\n      }\n      if (r.exact !== undefined && typeof r.exact !== 'number') {\n        cc.mandatory = cc.mandatory || {};\n        cc.mandatory[oldname_('', key)] = r.exact;\n      } else {\n        ['min', 'max'].forEach(function(mix) {\n          if (r[mix] !== undefined) {\n            cc.mandatory = cc.mandatory || {};\n            cc.mandatory[oldname_(mix, key)] = r[mix];\n          }\n        });\n      }\n    });\n    if (c.advanced) {\n      cc.optional = (cc.optional || []).concat(c.advanced);\n    }\n    return cc;\n  };\n\n  var shimConstraints_ = function(constraints, func) {\n    constraints = JSON.parse(JSON.stringify(constraints));\n    if (constraints && constraints.audio) {\n      constraints.audio = constraintsToChrome_(constraints.audio);\n    }\n    if (constraints && typeof constraints.video === 'object') {\n      // Shim facingMode for mobile & surface pro.\n      var face = constraints.video.facingMode;\n      face = face && ((typeof face === 'object') ? face : {ideal: face});\n      var getSupportedFacingModeLies = browserDetails.version < 61;\n\n      if ((face && (face.exact === 'user' || face.exact === 'environment' ||\n                    face.ideal === 'user' || face.ideal === 'environment')) &&\n          !(navigator.mediaDevices.getSupportedConstraints &&\n            navigator.mediaDevices.getSupportedConstraints().facingMode &&\n            !getSupportedFacingModeLies)) {\n        delete constraints.video.facingMode;\n        var matches;\n        if (face.exact === 'environment' || face.ideal === 'environment') {\n          matches = ['back', 'rear'];\n        } else if (face.exact === 'user' || face.ideal === 'user') {\n          matches = ['front'];\n        }\n        if (matches) {\n          // Look for matches in label, or use last cam for back (typical).\n          return navigator.mediaDevices.enumerateDevices()\n          .then(function(devices) {\n            devices = devices.filter(function(d) {\n              return d.kind === 'videoinput';\n            });\n            var dev = devices.find(function(d) {\n              return matches.some(function(match) {\n                return d.label.toLowerCase().indexOf(match) !== -1;\n              });\n            });\n            if (!dev && devices.length && matches.indexOf('back') !== -1) {\n              dev = devices[devices.length - 1]; // more likely the back cam\n            }\n            if (dev) {\n              constraints.video.deviceId = face.exact ? {exact: dev.deviceId} :\n                                                        {ideal: dev.deviceId};\n            }\n            constraints.video = constraintsToChrome_(constraints.video);\n            logging('chrome: ' + JSON.stringify(constraints));\n            return func(constraints);\n          });\n        }\n      }\n      constraints.video = constraintsToChrome_(constraints.video);\n    }\n    logging('chrome: ' + JSON.stringify(constraints));\n    return func(constraints);\n  };\n\n  var shimError_ = function(e) {\n    return {\n      name: {\n        ConstraintNotSatisfiedError: 'OverconstrainedError',\n        PermissionDeniedError: 'NotAllowedError',\n        TrackStartError: 'NotReadableError'\n      }[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraintName,\n      toString: function() {\n        return this.name + (this.message && ': ') + this.message;\n      }\n    };\n  };\n\n  var getUserMedia_ = function(constraints, onSuccess, onError) {\n    shimConstraints_(constraints, function(c) {\n      navigator.webkitGetUserMedia(c, onSuccess, function(e) {\n        onError(shimError_(e));\n      });\n    });\n  };\n\n  navigator.getUserMedia = getUserMedia_;\n\n  // Returns the result of getUserMedia as a Promise.\n  var getUserMediaPromise_ = function(constraints) {\n    return new Promise(function(resolve, reject) {\n      navigator.getUserMedia(constraints, resolve, reject);\n    });\n  };\n\n  if (!navigator.mediaDevices) {\n    navigator.mediaDevices = {\n      getUserMedia: getUserMediaPromise_,\n      enumerateDevices: function() {\n        return new Promise(function(resolve) {\n          var kinds = {audio: 'audioinput', video: 'videoinput'};\n          return MediaStreamTrack.getSources(function(devices) {\n            resolve(devices.map(function(device) {\n              return {label: device.label,\n                kind: kinds[device.kind],\n                deviceId: device.id,\n                groupId: ''};\n            }));\n          });\n        });\n      },\n      getSupportedConstraints: function() {\n        return {\n          deviceId: true, echoCancellation: true, facingMode: true,\n          frameRate: true, height: true, width: true\n        };\n      }\n    };\n  }\n\n  // A shim for getUserMedia method on the mediaDevices object.\n  // TODO(KaptenJansson) remove once implemented in Chrome stable.\n  if (!navigator.mediaDevices.getUserMedia) {\n    navigator.mediaDevices.getUserMedia = function(constraints) {\n      return getUserMediaPromise_(constraints);\n    };\n  } else {\n    // Even though Chrome 45 has navigator.mediaDevices and a getUserMedia\n    // function which returns a Promise, it does not accept spec-style\n    // constraints.\n    var origGetUserMedia = navigator.mediaDevices.getUserMedia.\n        bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(cs) {\n      return shimConstraints_(cs, function(c) {\n        return origGetUserMedia(c).then(function(stream) {\n          if (c.audio && !stream.getAudioTracks().length ||\n              c.video && !stream.getVideoTracks().length) {\n            stream.getTracks().forEach(function(track) {\n              track.stop();\n            });\n            throw new DOMException('', 'NotFoundError');\n          }\n          return stream;\n        }, function(e) {\n          return Promise.reject(shimError_(e));\n        });\n      });\n    };\n  }\n\n  // Dummy devicechange event methods.\n  // TODO(KaptenJansson) remove once implemented in Chrome stable.\n  if (typeof navigator.mediaDevices.addEventListener === 'undefined') {\n    navigator.mediaDevices.addEventListener = function() {\n      logging('Dummy mediaDevices.addEventListener called.');\n    };\n  }\n  if (typeof navigator.mediaDevices.removeEventListener === 'undefined') {\n    navigator.mediaDevices.removeEventListener = function() {\n      logging('Dummy mediaDevices.removeEventListener called.');\n    };\n  }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/webrtc-adapter/src/js/chrome/getusermedia.js\n// module id = 7\n// module chunks = 0","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar browserDetails = require('../utils').browserDetails;\nvar shimRTCPeerConnection = require('./rtcpeerconnection_shim');\n\nmodule.exports = {\n  shimGetUserMedia: require('./getusermedia'),\n  shimPeerConnection: function() {\n    if (window.RTCIceGatherer) {\n      // ORTC defines an RTCIceCandidate object but no constructor.\n      // Not implemented in Edge.\n      if (!window.RTCIceCandidate) {\n        window.RTCIceCandidate = function(args) {\n          return args;\n        };\n      }\n      // ORTC does not have a session description object but\n      // other browsers (i.e. Chrome) that will support both PC and ORTC\n      // in the future might have this defined already.\n      if (!window.RTCSessionDescription) {\n        window.RTCSessionDescription = function(args) {\n          return args;\n        };\n      }\n      // this adds an additional event listener to MediaStrackTrack that signals\n      // when a tracks enabled property was changed. Workaround for a bug in\n      // addStream, see below. No longer required in 15025+\n      if (browserDetails.version < 15025) {\n        var origMSTEnabled = Object.getOwnPropertyDescriptor(\n            MediaStreamTrack.prototype, 'enabled');\n        Object.defineProperty(MediaStreamTrack.prototype, 'enabled', {\n          set: function(value) {\n            origMSTEnabled.set.call(this, value);\n            var ev = new Event('enabled');\n            ev.enabled = value;\n            this.dispatchEvent(ev);\n          }\n        });\n      }\n    }\n    window.RTCPeerConnection = shimRTCPeerConnection(browserDetails.version);\n  },\n  shimReplaceTrack: function() {\n    // ORTC has replaceTrack -- https://github.com/w3c/ortc/issues/614\n    if (window.RTCRtpSender && !('replaceTrack' in RTCRtpSender.prototype)) {\n      RTCRtpSender.prototype.replaceTrack = RTCRtpSender.prototype.setTrack;\n    }\n  }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/webrtc-adapter/src/js/edge/edge_shim.js\n// module id = 8\n// module chunks = 0","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\n// Expose public methods.\nmodule.exports = function() {\n  var shimError_ = function(e) {\n    return {\n      name: {PermissionDeniedError: 'NotAllowedError'}[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint,\n      toString: function() {\n        return this.name;\n      }\n    };\n  };\n\n  // getUserMedia error shim.\n  var origGetUserMedia = navigator.mediaDevices.getUserMedia.\n      bind(navigator.mediaDevices);\n  navigator.mediaDevices.getUserMedia = function(c) {\n    return origGetUserMedia(c).catch(function(e) {\n      return Promise.reject(shimError_(e));\n    });\n  };\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/webrtc-adapter/src/js/edge/getusermedia.js\n// module id = 9\n// module chunks = 0","/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar SDPUtils = require('sdp');\n\n// sort tracks such that they follow an a-v-a-v...\n// pattern.\nfunction sortTracks(tracks) {\n  var audioTracks = tracks.filter(function(track) {\n    return track.kind === 'audio';\n  });\n  var videoTracks = tracks.filter(function(track) {\n    return track.kind === 'video';\n  });\n  tracks = [];\n  while (audioTracks.length || videoTracks.length) {\n    if (audioTracks.length) {\n      tracks.push(audioTracks.shift());\n    }\n    if (videoTracks.length) {\n      tracks.push(videoTracks.shift());\n    }\n  }\n  return tracks;\n}\n\n// Edge does not like\n// 1) stun:\n// 2) turn: that does not have all of turn:host:port?transport=udp\n// 3) turn: with ipv6 addresses\n// 4) turn: occurring muliple times\nfunction filterIceServers(iceServers, edgeVersion) {\n  var hasTurn = false;\n  iceServers = JSON.parse(JSON.stringify(iceServers));\n  return iceServers.filter(function(server) {\n    if (server && (server.urls || server.url)) {\n      var urls = server.urls || server.url;\n      if (server.url && !server.urls) {\n        console.warn('RTCIceServer.url is deprecated! Use urls instead.');\n      }\n      var isString = typeof urls === 'string';\n      if (isString) {\n        urls = [urls];\n      }\n      urls = urls.filter(function(url) {\n        var validTurn = url.indexOf('turn:') === 0 &&\n            url.indexOf('transport=udp') !== -1 &&\n            url.indexOf('turn:[') === -1 &&\n            !hasTurn;\n\n        if (validTurn) {\n          hasTurn = true;\n          return true;\n        }\n        return url.indexOf('stun:') === 0 && edgeVersion >= 14393;\n      });\n\n      delete server.url;\n      server.urls = isString ? urls[0] : urls;\n      return !!urls.length;\n    }\n    return false;\n  });\n}\n\n// Determines the intersection of local and remote capabilities.\nfunction getCommonCapabilities(localCapabilities, remoteCapabilities) {\n  var commonCapabilities = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: []\n  };\n\n  var findCodecByPayloadType = function(pt, codecs) {\n    pt = parseInt(pt, 10);\n    for (var i = 0; i < codecs.length; i++) {\n      if (codecs[i].payloadType === pt ||\n          codecs[i].preferredPayloadType === pt) {\n        return codecs[i];\n      }\n    }\n  };\n\n  var rtxCapabilityMatches = function(lRtx, rRtx, lCodecs, rCodecs) {\n    var lCodec = findCodecByPayloadType(lRtx.parameters.apt, lCodecs);\n    var rCodec = findCodecByPayloadType(rRtx.parameters.apt, rCodecs);\n    return lCodec && rCodec &&\n        lCodec.name.toLowerCase() === rCodec.name.toLowerCase();\n  };\n\n  localCapabilities.codecs.forEach(function(lCodec) {\n    for (var i = 0; i < remoteCapabilities.codecs.length; i++) {\n      var rCodec = remoteCapabilities.codecs[i];\n      if (lCodec.name.toLowerCase() === rCodec.name.toLowerCase() &&\n          lCodec.clockRate === rCodec.clockRate) {\n        if (lCodec.name.toLowerCase() === 'rtx' &&\n            lCodec.parameters && rCodec.parameters.apt) {\n          // for RTX we need to find the local rtx that has a apt\n          // which points to the same local codec as the remote one.\n          if (!rtxCapabilityMatches(lCodec, rCodec,\n              localCapabilities.codecs, remoteCapabilities.codecs)) {\n            continue;\n          }\n        }\n        rCodec = JSON.parse(JSON.stringify(rCodec)); // deepcopy\n        // number of channels is the highest common number of channels\n        rCodec.numChannels = Math.min(lCodec.numChannels,\n            rCodec.numChannels);\n        // push rCodec so we reply with offerer payload type\n        commonCapabilities.codecs.push(rCodec);\n\n        // determine common feedback mechanisms\n        rCodec.rtcpFeedback = rCodec.rtcpFeedback.filter(function(fb) {\n          for (var j = 0; j < lCodec.rtcpFeedback.length; j++) {\n            if (lCodec.rtcpFeedback[j].type === fb.type &&\n                lCodec.rtcpFeedback[j].parameter === fb.parameter) {\n              return true;\n            }\n          }\n          return false;\n        });\n        // FIXME: also need to determine .parameters\n        //  see https://github.com/openpeer/ortc/issues/569\n        break;\n      }\n    }\n  });\n\n  localCapabilities.headerExtensions.forEach(function(lHeaderExtension) {\n    for (var i = 0; i < remoteCapabilities.headerExtensions.length;\n         i++) {\n      var rHeaderExtension = remoteCapabilities.headerExtensions[i];\n      if (lHeaderExtension.uri === rHeaderExtension.uri) {\n        commonCapabilities.headerExtensions.push(rHeaderExtension);\n        break;\n      }\n    }\n  });\n\n  // FIXME: fecMechanisms\n  return commonCapabilities;\n}\n\n// is action=setLocalDescription with type allowed in signalingState\nfunction isActionAllowedInSignalingState(action, type, signalingState) {\n  return {\n    offer: {\n      setLocalDescription: ['stable', 'have-local-offer'],\n      setRemoteDescription: ['stable', 'have-remote-offer']\n    },\n    answer: {\n      setLocalDescription: ['have-remote-offer', 'have-local-pranswer'],\n      setRemoteDescription: ['have-local-offer', 'have-remote-pranswer']\n    }\n  }[type][action].indexOf(signalingState) !== -1;\n}\n\nmodule.exports = function(edgeVersion) {\n  var RTCPeerConnection = function(config) {\n    var self = this;\n\n    var _eventTarget = document.createDocumentFragment();\n    ['addEventListener', 'removeEventListener', 'dispatchEvent']\n        .forEach(function(method) {\n          self[method] = _eventTarget[method].bind(_eventTarget);\n        });\n\n    this.needNegotiation = false;\n\n    this.onicecandidate = null;\n    this.onaddstream = null;\n    this.ontrack = null;\n    this.onremovestream = null;\n    this.onsignalingstatechange = null;\n    this.oniceconnectionstatechange = null;\n    this.onicegatheringstatechange = null;\n    this.onnegotiationneeded = null;\n    this.ondatachannel = null;\n    this.canTrickleIceCandidates = null;\n\n    this.localStreams = [];\n    this.remoteStreams = [];\n    this.getLocalStreams = function() {\n      return self.localStreams;\n    };\n    this.getRemoteStreams = function() {\n      return self.remoteStreams;\n    };\n\n    this.localDescription = new RTCSessionDescription({\n      type: '',\n      sdp: ''\n    });\n    this.remoteDescription = new RTCSessionDescription({\n      type: '',\n      sdp: ''\n    });\n    this.signalingState = 'stable';\n    this.iceConnectionState = 'new';\n    this.iceGatheringState = 'new';\n\n    this.iceOptions = {\n      gatherPolicy: 'all',\n      iceServers: []\n    };\n    if (config && config.iceTransportPolicy) {\n      switch (config.iceTransportPolicy) {\n        case 'all':\n        case 'relay':\n          this.iceOptions.gatherPolicy = config.iceTransportPolicy;\n          break;\n        default:\n          // don't set iceTransportPolicy.\n          break;\n      }\n    }\n    this.usingBundle = config && config.bundlePolicy === 'max-bundle';\n\n    if (config && config.iceServers) {\n      this.iceOptions.iceServers = filterIceServers(config.iceServers,\n          edgeVersion);\n    }\n    this._config = config || {};\n\n    // per-track iceGathers, iceTransports, dtlsTransports, rtpSenders, ...\n    // everything that is needed to describe a SDP m-line.\n    this.transceivers = [];\n\n    // since the iceGatherer is currently created in createOffer but we\n    // must not emit candidates until after setLocalDescription we buffer\n    // them in this array.\n    this._localIceCandidatesBuffer = [];\n  };\n\n  RTCPeerConnection.prototype._emitGatheringStateChange = function() {\n    var event = new Event('icegatheringstatechange');\n    this.dispatchEvent(event);\n    if (this.onicegatheringstatechange !== null) {\n      this.onicegatheringstatechange(event);\n    }\n  };\n\n  RTCPeerConnection.prototype._emitBufferedCandidates = function() {\n    var self = this;\n    var sections = SDPUtils.splitSections(self.localDescription.sdp);\n    // FIXME: need to apply ice candidates in a way which is async but\n    // in-order\n    this._localIceCandidatesBuffer.forEach(function(event) {\n      var end = !event.candidate || Object.keys(event.candidate).length === 0;\n      if (end) {\n        for (var j = 1; j < sections.length; j++) {\n          if (sections[j].indexOf('\\r\\na=end-of-candidates\\r\\n') === -1) {\n            sections[j] += 'a=end-of-candidates\\r\\n';\n          }\n        }\n      } else {\n        sections[event.candidate.sdpMLineIndex + 1] +=\n            'a=' + event.candidate.candidate + '\\r\\n';\n      }\n      self.localDescription.sdp = sections.join('');\n      self.dispatchEvent(event);\n      if (self.onicecandidate !== null) {\n        self.onicecandidate(event);\n      }\n      if (!event.candidate && self.iceGatheringState !== 'complete') {\n        var complete = self.transceivers.every(function(transceiver) {\n          return transceiver.iceGatherer &&\n              transceiver.iceGatherer.state === 'completed';\n        });\n        if (complete && self.iceGatheringStateChange !== 'complete') {\n          self.iceGatheringState = 'complete';\n          self._emitGatheringStateChange();\n        }\n      }\n    });\n    this._localIceCandidatesBuffer = [];\n  };\n\n  RTCPeerConnection.prototype.getConfiguration = function() {\n    return this._config;\n  };\n\n  // internal helper to create a transceiver object.\n  // (whih is not yet the same as the WebRTC 1.0 transceiver)\n  RTCPeerConnection.prototype._createTransceiver = function(kind) {\n    var hasBundleTransport = this.transceivers.length > 0;\n    var transceiver = {\n      track: null,\n      iceGatherer: null,\n      iceTransport: null,\n      dtlsTransport: null,\n      localCapabilities: null,\n      remoteCapabilities: null,\n      rtpSender: null,\n      rtpReceiver: null,\n      kind: kind,\n      mid: null,\n      sendEncodingParameters: null,\n      recvEncodingParameters: null,\n      stream: null,\n      wantReceive: true\n    };\n    if (this.usingBundle && hasBundleTransport) {\n      transceiver.iceTransport = this.transceivers[0].iceTransport;\n      transceiver.dtlsTransport = this.transceivers[0].dtlsTransport;\n    } else {\n      var transports = this._createIceAndDtlsTransports();\n      transceiver.iceTransport = transports.iceTransport;\n      transceiver.dtlsTransport = transports.dtlsTransport;\n    }\n    this.transceivers.push(transceiver);\n    return transceiver;\n  };\n\n  RTCPeerConnection.prototype.addTrack = function(track, stream) {\n    var transceiver;\n    for (var i = 0; i < this.transceivers.length; i++) {\n      if (!this.transceivers[i].track &&\n          this.transceivers[i].kind === track.kind) {\n        transceiver = this.transceivers[i];\n      }\n    }\n    if (!transceiver) {\n      transceiver = this._createTransceiver(track.kind);\n    }\n\n    transceiver.track = track;\n    transceiver.stream = stream;\n    transceiver.rtpSender = new RTCRtpSender(track,\n        transceiver.dtlsTransport);\n\n    this._maybeFireNegotiationNeeded();\n    return transceiver.rtpSender;\n  };\n\n  RTCPeerConnection.prototype.addStream = function(stream) {\n    var self = this;\n    if (edgeVersion >= 15025) {\n      this.localStreams.push(stream);\n      stream.getTracks().forEach(function(track) {\n        self.addTrack(track, stream);\n      });\n    } else {\n      // Clone is necessary for local demos mostly, attaching directly\n      // to two different senders does not work (build 10547).\n      // Fixed in 15025 (or earlier)\n      var clonedStream = stream.clone();\n      stream.getTracks().forEach(function(track, idx) {\n        var clonedTrack = clonedStream.getTracks()[idx];\n        track.addEventListener('enabled', function(event) {\n          clonedTrack.enabled = event.enabled;\n        });\n      });\n      clonedStream.getTracks().forEach(function(track) {\n        self.addTrack(track, clonedStream);\n      });\n      this.localStreams.push(clonedStream);\n    }\n    this._maybeFireNegotiationNeeded();\n  };\n\n  RTCPeerConnection.prototype.removeStream = function(stream) {\n    var idx = this.localStreams.indexOf(stream);\n    if (idx > -1) {\n      this.localStreams.splice(idx, 1);\n      this._maybeFireNegotiationNeeded();\n    }\n  };\n\n  RTCPeerConnection.prototype.getSenders = function() {\n    return this.transceivers.filter(function(transceiver) {\n      return !!transceiver.rtpSender;\n    })\n    .map(function(transceiver) {\n      return transceiver.rtpSender;\n    });\n  };\n\n  RTCPeerConnection.prototype.getReceivers = function() {\n    return this.transceivers.filter(function(transceiver) {\n      return !!transceiver.rtpReceiver;\n    })\n    .map(function(transceiver) {\n      return transceiver.rtpReceiver;\n    });\n  };\n\n  // Create ICE gatherer and hook it up.\n  RTCPeerConnection.prototype._createIceGatherer = function(mid,\n      sdpMLineIndex) {\n    var self = this;\n    var iceGatherer = new RTCIceGatherer(self.iceOptions);\n    iceGatherer.onlocalcandidate = function(evt) {\n      var event = new Event('icecandidate');\n      event.candidate = {sdpMid: mid, sdpMLineIndex: sdpMLineIndex};\n\n      var cand = evt.candidate;\n      var end = !cand || Object.keys(cand).length === 0;\n      // Edge emits an empty object for RTCIceCandidateComplete‥\n      if (end) {\n        // polyfill since RTCIceGatherer.state is not implemented in\n        // Edge 10547 yet.\n        if (iceGatherer.state === undefined) {\n          iceGatherer.state = 'completed';\n        }\n      } else {\n        // RTCIceCandidate doesn't have a component, needs to be added\n        cand.component = 1;\n        event.candidate.candidate = SDPUtils.writeCandidate(cand);\n      }\n\n      // update local description.\n      var sections = SDPUtils.splitSections(self.localDescription.sdp);\n      if (!end) {\n        sections[event.candidate.sdpMLineIndex + 1] +=\n            'a=' + event.candidate.candidate + '\\r\\n';\n      } else {\n        sections[event.candidate.sdpMLineIndex + 1] +=\n            'a=end-of-candidates\\r\\n';\n      }\n      self.localDescription.sdp = sections.join('');\n      var transceivers = self._pendingOffer ? self._pendingOffer :\n          self.transceivers;\n      var complete = transceivers.every(function(transceiver) {\n        return transceiver.iceGatherer &&\n            transceiver.iceGatherer.state === 'completed';\n      });\n\n      // Emit candidate if localDescription is set.\n      // Also emits null candidate when all gatherers are complete.\n      switch (self.iceGatheringState) {\n        case 'new':\n          if (!end) {\n            self._localIceCandidatesBuffer.push(event);\n          }\n          if (end && complete) {\n            self._localIceCandidatesBuffer.push(\n                new Event('icecandidate'));\n          }\n          break;\n        case 'gathering':\n          self._emitBufferedCandidates();\n          if (!end) {\n            self.dispatchEvent(event);\n            if (self.onicecandidate !== null) {\n              self.onicecandidate(event);\n            }\n          }\n          if (complete) {\n            self.dispatchEvent(new Event('icecandidate'));\n            if (self.onicecandidate !== null) {\n              self.onicecandidate(new Event('icecandidate'));\n            }\n            self.iceGatheringState = 'complete';\n            self._emitGatheringStateChange();\n          }\n          break;\n        case 'complete':\n          // should not happen... currently!\n          break;\n        default: // no-op.\n          break;\n      }\n    };\n    return iceGatherer;\n  };\n\n  // Create ICE transport and DTLS transport.\n  RTCPeerConnection.prototype._createIceAndDtlsTransports = function() {\n    var self = this;\n    var iceTransport = new RTCIceTransport(null);\n    iceTransport.onicestatechange = function() {\n      self._updateConnectionState();\n    };\n\n    var dtlsTransport = new RTCDtlsTransport(iceTransport);\n    dtlsTransport.ondtlsstatechange = function() {\n      self._updateConnectionState();\n    };\n    dtlsTransport.onerror = function() {\n      // onerror does not set state to failed by itself.\n      Object.defineProperty(dtlsTransport, 'state',\n          {value: 'failed', writable: true});\n      self._updateConnectionState();\n    };\n\n    return {\n      iceTransport: iceTransport,\n      dtlsTransport: dtlsTransport\n    };\n  };\n\n  // Destroy ICE gatherer, ICE transport and DTLS transport.\n  // Without triggering the callbacks.\n  RTCPeerConnection.prototype._disposeIceAndDtlsTransports = function(\n      sdpMLineIndex) {\n    var iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;\n    if (iceGatherer) {\n      delete iceGatherer.onlocalcandidate;\n      delete this.transceivers[sdpMLineIndex].iceGatherer;\n    }\n    var iceTransport = this.transceivers[sdpMLineIndex].iceTransport;\n    if (iceTransport) {\n      delete iceTransport.onicestatechange;\n      delete this.transceivers[sdpMLineIndex].iceTransport;\n    }\n    var dtlsTransport = this.transceivers[sdpMLineIndex].dtlsTransport;\n    if (dtlsTransport) {\n      delete dtlsTransport.ondtlssttatechange;\n      delete dtlsTransport.onerror;\n      delete this.transceivers[sdpMLineIndex].dtlsTransport;\n    }\n  };\n\n  // Start the RTP Sender and Receiver for a transceiver.\n  RTCPeerConnection.prototype._transceive = function(transceiver,\n      send, recv) {\n    var params = getCommonCapabilities(transceiver.localCapabilities,\n        transceiver.remoteCapabilities);\n    if (send && transceiver.rtpSender) {\n      params.encodings = transceiver.sendEncodingParameters;\n      params.rtcp = {\n        cname: SDPUtils.localCName,\n        compound: transceiver.rtcpParameters.compound\n      };\n      if (transceiver.recvEncodingParameters.length) {\n        params.rtcp.ssrc = transceiver.recvEncodingParameters[0].ssrc;\n      }\n      transceiver.rtpSender.send(params);\n    }\n    if (recv && transceiver.rtpReceiver) {\n      // remove RTX field in Edge 14942\n      if (transceiver.kind === 'video'\n          && transceiver.recvEncodingParameters\n          && edgeVersion < 15019) {\n        transceiver.recvEncodingParameters.forEach(function(p) {\n          delete p.rtx;\n        });\n      }\n      params.encodings = transceiver.recvEncodingParameters;\n      params.rtcp = {\n        cname: transceiver.rtcpParameters.cname,\n        compound: transceiver.rtcpParameters.compound\n      };\n      if (transceiver.sendEncodingParameters.length) {\n        params.rtcp.ssrc = transceiver.sendEncodingParameters[0].ssrc;\n      }\n      transceiver.rtpReceiver.receive(params);\n    }\n  };\n\n  RTCPeerConnection.prototype.setLocalDescription = function(description) {\n    var self = this;\n\n    if (!isActionAllowedInSignalingState('setLocalDescription',\n        description.type, this.signalingState)) {\n      var e = new Error('Can not set local ' + description.type +\n          ' in state ' + this.signalingState);\n      e.name = 'InvalidStateError';\n      if (arguments.length > 2 && typeof arguments[2] === 'function') {\n        window.setTimeout(arguments[2], 0, e);\n      }\n      return Promise.reject(e);\n    }\n\n    var sections;\n    var sessionpart;\n    if (description.type === 'offer') {\n      // FIXME: What was the purpose of this empty if statement?\n      // if (!this._pendingOffer) {\n      // } else {\n      if (this._pendingOffer) {\n        // VERY limited support for SDP munging. Limited to:\n        // * changing the order of codecs\n        sections = SDPUtils.splitSections(description.sdp);\n        sessionpart = sections.shift();\n        sections.forEach(function(mediaSection, sdpMLineIndex) {\n          var caps = SDPUtils.parseRtpParameters(mediaSection);\n          self._pendingOffer[sdpMLineIndex].localCapabilities = caps;\n        });\n        this.transceivers = this._pendingOffer;\n        delete this._pendingOffer;\n      }\n    } else if (description.type === 'answer') {\n      sections = SDPUtils.splitSections(self.remoteDescription.sdp);\n      sessionpart = sections.shift();\n      var isIceLite = SDPUtils.matchPrefix(sessionpart,\n          'a=ice-lite').length > 0;\n      sections.forEach(function(mediaSection, sdpMLineIndex) {\n        var transceiver = self.transceivers[sdpMLineIndex];\n        var iceGatherer = transceiver.iceGatherer;\n        var iceTransport = transceiver.iceTransport;\n        var dtlsTransport = transceiver.dtlsTransport;\n        var localCapabilities = transceiver.localCapabilities;\n        var remoteCapabilities = transceiver.remoteCapabilities;\n\n        var rejected = SDPUtils.isRejected(mediaSection);\n\n        if (!rejected && !transceiver.isDatachannel) {\n          var remoteIceParameters = SDPUtils.getIceParameters(\n              mediaSection, sessionpart);\n          var remoteDtlsParameters = SDPUtils.getDtlsParameters(\n              mediaSection, sessionpart);\n          if (isIceLite) {\n            remoteDtlsParameters.role = 'server';\n          }\n\n          if (!self.usingBundle || sdpMLineIndex === 0) {\n            iceTransport.start(iceGatherer, remoteIceParameters,\n                isIceLite ? 'controlling' : 'controlled');\n            dtlsTransport.start(remoteDtlsParameters);\n          }\n\n          // Calculate intersection of capabilities.\n          var params = getCommonCapabilities(localCapabilities,\n              remoteCapabilities);\n\n          // Start the RTCRtpSender. The RTCRtpReceiver for this\n          // transceiver has already been started in setRemoteDescription.\n          self._transceive(transceiver,\n              params.codecs.length > 0,\n              false);\n        }\n      });\n    }\n\n    this.localDescription = {\n      type: description.type,\n      sdp: description.sdp\n    };\n    switch (description.type) {\n      case 'offer':\n        this._updateSignalingState('have-local-offer');\n        break;\n      case 'answer':\n        this._updateSignalingState('stable');\n        break;\n      default:\n        throw new TypeError('unsupported type \"' + description.type +\n            '\"');\n    }\n\n    // If a success callback was provided, emit ICE candidates after it\n    // has been executed. Otherwise, emit callback after the Promise is\n    // resolved.\n    var hasCallback = arguments.length > 1 &&\n      typeof arguments[1] === 'function';\n    if (hasCallback) {\n      var cb = arguments[1];\n      window.setTimeout(function() {\n        cb();\n        if (self.iceGatheringState === 'new') {\n          self.iceGatheringState = 'gathering';\n          self._emitGatheringStateChange();\n        }\n        self._emitBufferedCandidates();\n      }, 0);\n    }\n    var p = Promise.resolve();\n    p.then(function() {\n      if (!hasCallback) {\n        if (self.iceGatheringState === 'new') {\n          self.iceGatheringState = 'gathering';\n          self._emitGatheringStateChange();\n        }\n        // Usually candidates will be emitted earlier.\n        window.setTimeout(self._emitBufferedCandidates.bind(self), 500);\n      }\n    });\n    return p;\n  };\n\n  RTCPeerConnection.prototype.setRemoteDescription = function(description) {\n    var self = this;\n\n    if (!isActionAllowedInSignalingState('setRemoteDescription',\n        description.type, this.signalingState)) {\n      var e = new Error('Can not set remote ' + description.type +\n          ' in state ' + this.signalingState);\n      e.name = 'InvalidStateError';\n      if (arguments.length > 2 && typeof arguments[2] === 'function') {\n        window.setTimeout(arguments[2], 0, e);\n      }\n      return Promise.reject(e);\n    }\n\n    var streams = {};\n    var receiverList = [];\n    var sections = SDPUtils.splitSections(description.sdp);\n    var sessionpart = sections.shift();\n    var isIceLite = SDPUtils.matchPrefix(sessionpart,\n        'a=ice-lite').length > 0;\n    var usingBundle = SDPUtils.matchPrefix(sessionpart,\n        'a=group:BUNDLE ').length > 0;\n    this.usingBundle = usingBundle;\n    var iceOptions = SDPUtils.matchPrefix(sessionpart,\n        'a=ice-options:')[0];\n    if (iceOptions) {\n      this.canTrickleIceCandidates = iceOptions.substr(14).split(' ')\n          .indexOf('trickle') >= 0;\n    } else {\n      this.canTrickleIceCandidates = false;\n    }\n\n    sections.forEach(function(mediaSection, sdpMLineIndex) {\n      var lines = SDPUtils.splitLines(mediaSection);\n      var kind = SDPUtils.getKind(mediaSection);\n      var rejected = SDPUtils.isRejected(mediaSection);\n      var protocol = lines[0].substr(2).split(' ')[2];\n\n      var direction = SDPUtils.getDirection(mediaSection, sessionpart);\n      var remoteMsid = SDPUtils.parseMsid(mediaSection);\n\n      var mid = SDPUtils.getMid(mediaSection) || SDPUtils.generateIdentifier();\n\n      // Reject datachannels which are not implemented yet.\n      if (kind === 'application' && protocol === 'DTLS/SCTP') {\n        self.transceivers[sdpMLineIndex] = {\n          mid: mid,\n          isDatachannel: true\n        };\n        return;\n      }\n\n      var transceiver;\n      var iceGatherer;\n      var iceTransport;\n      var dtlsTransport;\n      var rtpReceiver;\n      var sendEncodingParameters;\n      var recvEncodingParameters;\n      var localCapabilities;\n\n      var track;\n      // FIXME: ensure the mediaSection has rtcp-mux set.\n      var remoteCapabilities = SDPUtils.parseRtpParameters(mediaSection);\n      var remoteIceParameters;\n      var remoteDtlsParameters;\n      if (!rejected) {\n        remoteIceParameters = SDPUtils.getIceParameters(mediaSection,\n            sessionpart);\n        remoteDtlsParameters = SDPUtils.getDtlsParameters(mediaSection,\n            sessionpart);\n        remoteDtlsParameters.role = 'client';\n      }\n      recvEncodingParameters =\n          SDPUtils.parseRtpEncodingParameters(mediaSection);\n\n      var rtcpParameters = SDPUtils.parseRtcpParameters(mediaSection);\n\n      var isComplete = SDPUtils.matchPrefix(mediaSection,\n          'a=end-of-candidates', sessionpart).length > 0;\n      var cands = SDPUtils.matchPrefix(mediaSection, 'a=candidate:')\n          .map(function(cand) {\n            return SDPUtils.parseCandidate(cand);\n          })\n          .filter(function(cand) {\n            return cand.component === '1' || cand.component === 1;\n          });\n      if (description.type === 'offer' && !rejected) {\n        transceiver = self.transceivers[sdpMLineIndex] ||\n            self._createTransceiver(kind);\n        transceiver.mid = mid;\n\n        if (!transceiver.iceGatherer) {\n          transceiver.iceGatherer = usingBundle && sdpMLineIndex > 0 ?\n              self.transceivers[0].iceGatherer :\n              self._createIceGatherer(mid, sdpMLineIndex);\n        }\n\n        if (isComplete && (!usingBundle || sdpMLineIndex === 0)) {\n          transceiver.iceTransport.setRemoteCandidates(cands);\n        }\n\n        localCapabilities = RTCRtpReceiver.getCapabilities(kind);\n\n        // filter RTX until additional stuff needed for RTX is implemented\n        // in adapter.js\n        if (edgeVersion < 15019) {\n          localCapabilities.codecs = localCapabilities.codecs.filter(\n              function(codec) {\n                return codec.name !== 'rtx';\n              });\n        }\n\n        sendEncodingParameters = [{\n          ssrc: (2 * sdpMLineIndex + 2) * 1001\n        }];\n\n        if (direction === 'sendrecv' || direction === 'sendonly') {\n          rtpReceiver = new RTCRtpReceiver(transceiver.dtlsTransport,\n              kind);\n\n          track = rtpReceiver.track;\n          // FIXME: does not work with Plan B.\n          if (remoteMsid) {\n            if (!streams[remoteMsid.stream]) {\n              streams[remoteMsid.stream] = new MediaStream();\n              Object.defineProperty(streams[remoteMsid.stream], 'id', {\n                get: function() {\n                  return remoteMsid.stream;\n                }\n              });\n            }\n            Object.defineProperty(track, 'id', {\n              get: function() {\n                return remoteMsid.track;\n              }\n            });\n            streams[remoteMsid.stream].addTrack(track);\n            receiverList.push([track, rtpReceiver,\n              streams[remoteMsid.stream]]);\n          } else {\n            if (!streams.default) {\n              streams.default = new MediaStream();\n            }\n            streams.default.addTrack(track);\n            receiverList.push([track, rtpReceiver, streams.default]);\n          }\n        }\n\n        transceiver.localCapabilities = localCapabilities;\n        transceiver.remoteCapabilities = remoteCapabilities;\n        transceiver.rtpReceiver = rtpReceiver;\n        transceiver.rtcpParameters = rtcpParameters;\n        transceiver.sendEncodingParameters = sendEncodingParameters;\n        transceiver.recvEncodingParameters = recvEncodingParameters;\n\n        // Start the RTCRtpReceiver now. The RTPSender is started in\n        // setLocalDescription.\n        self._transceive(self.transceivers[sdpMLineIndex],\n            false,\n            direction === 'sendrecv' || direction === 'sendonly');\n      } else if (description.type === 'answer' && !rejected) {\n        if (usingBundle && sdpMLineIndex > 0) {\n          self._disposeIceAndDtlsTransports(sdpMLineIndex);\n          self.transceivers[sdpMLineIndex].iceGatherer =\n              self.transceivers[0].iceGatherer;\n          self.transceivers[sdpMLineIndex].iceTransport =\n              self.transceivers[0].iceTransport;\n          self.transceivers[sdpMLineIndex].dtlsTransport =\n              self.transceivers[0].dtlsTransport;\n          if (self.transceivers[sdpMLineIndex].rtpSender) {\n            self.transceivers[sdpMLineIndex].rtpSender.setTransport(\n                self.transceivers[0].dtlsTransport);\n          }\n          if (self.transceivers[sdpMLineIndex].rtpReceiver) {\n            self.transceivers[sdpMLineIndex].rtpReceiver.setTransport(\n                self.transceivers[0].dtlsTransport);\n          }\n        }\n        transceiver = self.transceivers[sdpMLineIndex];\n        iceGatherer = transceiver.iceGatherer;\n        iceTransport = transceiver.iceTransport;\n        dtlsTransport = transceiver.dtlsTransport;\n        rtpReceiver = transceiver.rtpReceiver;\n        sendEncodingParameters = transceiver.sendEncodingParameters;\n        localCapabilities = transceiver.localCapabilities;\n\n        self.transceivers[sdpMLineIndex].recvEncodingParameters =\n            recvEncodingParameters;\n        self.transceivers[sdpMLineIndex].remoteCapabilities =\n            remoteCapabilities;\n        self.transceivers[sdpMLineIndex].rtcpParameters = rtcpParameters;\n\n        if ((isIceLite || isComplete) && cands.length) {\n          iceTransport.setRemoteCandidates(cands);\n        }\n        if (!usingBundle || sdpMLineIndex === 0) {\n          iceTransport.start(iceGatherer, remoteIceParameters,\n              'controlling');\n          dtlsTransport.start(remoteDtlsParameters);\n        }\n\n        self._transceive(transceiver,\n            direction === 'sendrecv' || direction === 'recvonly',\n            direction === 'sendrecv' || direction === 'sendonly');\n\n        if (rtpReceiver &&\n            (direction === 'sendrecv' || direction === 'sendonly')) {\n          track = rtpReceiver.track;\n          if (remoteMsid) {\n            if (!streams[remoteMsid.stream]) {\n              streams[remoteMsid.stream] = new MediaStream();\n            }\n            streams[remoteMsid.stream].addTrack(track);\n            receiverList.push([track, rtpReceiver, streams[remoteMsid.stream]]);\n          } else {\n            if (!streams.default) {\n              streams.default = new MediaStream();\n            }\n            streams.default.addTrack(track);\n            receiverList.push([track, rtpReceiver, streams.default]);\n          }\n        } else {\n          // FIXME: actually the receiver should be created later.\n          delete transceiver.rtpReceiver;\n        }\n      }\n    });\n\n    this.remoteDescription = {\n      type: description.type,\n      sdp: description.sdp\n    };\n    switch (description.type) {\n      case 'offer':\n        this._updateSignalingState('have-remote-offer');\n        break;\n      case 'answer':\n        this._updateSignalingState('stable');\n        break;\n      default:\n        throw new TypeError('unsupported type \"' + description.type +\n            '\"');\n    }\n    Object.keys(streams).forEach(function(sid) {\n      var stream = streams[sid];\n      if (stream.getTracks().length) {\n        self.remoteStreams.push(stream);\n        var event = new Event('addstream');\n        event.stream = stream;\n        self.dispatchEvent(event);\n        if (self.onaddstream !== null) {\n          window.setTimeout(function() {\n            self.onaddstream(event);\n          }, 0);\n        }\n\n        receiverList.forEach(function(item) {\n          var track = item[0];\n          var receiver = item[1];\n          if (stream.id !== item[2].id) {\n            return;\n          }\n          var trackEvent = new Event('track');\n          trackEvent.track = track;\n          trackEvent.receiver = receiver;\n          trackEvent.streams = [stream];\n          self.dispatchEvent(trackEvent);\n          if (self.ontrack !== null) {\n            window.setTimeout(function() {\n              self.ontrack(trackEvent);\n            }, 0);\n          }\n        });\n      }\n    });\n\n    // check whether addIceCandidate({}) was called within four seconds after\n    // setRemoteDescription.\n    window.setTimeout(function() {\n      if (!(self && self.transceivers)) {\n        return;\n      }\n      self.transceivers.forEach(function(transceiver) {\n        if (transceiver.iceTransport &&\n            transceiver.iceTransport.state === 'new' &&\n            transceiver.iceTransport.getRemoteCandidates().length > 0) {\n          console.warn('Timeout for addRemoteCandidate. Consider sending ' +\n              'an end-of-candidates notification');\n          transceiver.iceTransport.addRemoteCandidate({});\n        }\n      });\n    }, 4000);\n\n    if (arguments.length > 1 && typeof arguments[1] === 'function') {\n      window.setTimeout(arguments[1], 0);\n    }\n    return Promise.resolve();\n  };\n\n  RTCPeerConnection.prototype.close = function() {\n    this.transceivers.forEach(function(transceiver) {\n      /* not yet\n      if (transceiver.iceGatherer) {\n        transceiver.iceGatherer.close();\n      }\n      */\n      if (transceiver.iceTransport) {\n        transceiver.iceTransport.stop();\n      }\n      if (transceiver.dtlsTransport) {\n        transceiver.dtlsTransport.stop();\n      }\n      if (transceiver.rtpSender) {\n        transceiver.rtpSender.stop();\n      }\n      if (transceiver.rtpReceiver) {\n        transceiver.rtpReceiver.stop();\n      }\n    });\n    // FIXME: clean up tracks, local streams, remote streams, etc\n    this._updateSignalingState('closed');\n  };\n\n  // Update the signaling state.\n  RTCPeerConnection.prototype._updateSignalingState = function(newState) {\n    this.signalingState = newState;\n    var event = new Event('signalingstatechange');\n    this.dispatchEvent(event);\n    if (this.onsignalingstatechange !== null) {\n      this.onsignalingstatechange(event);\n    }\n  };\n\n  // Determine whether to fire the negotiationneeded event.\n  RTCPeerConnection.prototype._maybeFireNegotiationNeeded = function() {\n    var self = this;\n    if (this.signalingState !== 'stable' || this.needNegotiation === true) {\n      return;\n    }\n    this.needNegotiation = true;\n    window.setTimeout(function() {\n      if (self.needNegotiation === false) {\n        return;\n      }\n      self.needNegotiation = false;\n      var event = new Event('negotiationneeded');\n      self.dispatchEvent(event);\n      if (self.onnegotiationneeded !== null) {\n        self.onnegotiationneeded(event);\n      }\n    }, 0);\n  };\n\n  // Update the connection state.\n  RTCPeerConnection.prototype._updateConnectionState = function() {\n    var self = this;\n    var newState;\n    var states = {\n      'new': 0,\n      closed: 0,\n      connecting: 0,\n      checking: 0,\n      connected: 0,\n      completed: 0,\n      failed: 0\n    };\n    this.transceivers.forEach(function(transceiver) {\n      states[transceiver.iceTransport.state]++;\n      states[transceiver.dtlsTransport.state]++;\n    });\n    // ICETransport.completed and connected are the same for this purpose.\n    states.connected += states.completed;\n\n    newState = 'new';\n    if (states.failed > 0) {\n      newState = 'failed';\n    } else if (states.connecting > 0 || states.checking > 0) {\n      newState = 'connecting';\n    } else if (states.disconnected > 0) {\n      newState = 'disconnected';\n    } else if (states.new > 0) {\n      newState = 'new';\n    } else if (states.connected > 0 || states.completed > 0) {\n      newState = 'connected';\n    }\n\n    if (newState !== self.iceConnectionState) {\n      self.iceConnectionState = newState;\n      var event = new Event('iceconnectionstatechange');\n      this.dispatchEvent(event);\n      if (this.oniceconnectionstatechange !== null) {\n        this.oniceconnectionstatechange(event);\n      }\n    }\n  };\n\n  RTCPeerConnection.prototype.createOffer = function() {\n    var self = this;\n    if (this._pendingOffer) {\n      throw new Error('createOffer called while there is a pending offer.');\n    }\n    var offerOptions;\n    if (arguments.length === 1 && typeof arguments[0] !== 'function') {\n      offerOptions = arguments[0];\n    } else if (arguments.length === 3) {\n      offerOptions = arguments[2];\n    }\n\n    var numAudioTracks = this.transceivers.filter(function(t) {\n      return t.kind === 'audio';\n    }).length;\n    var numVideoTracks = this.transceivers.filter(function(t) {\n      return t.kind === 'video';\n    }).length;\n\n    // Determine number of audio and video tracks we need to send/recv.\n    if (offerOptions) {\n      // Reject Chrome legacy constraints.\n      if (offerOptions.mandatory || offerOptions.optional) {\n        throw new TypeError(\n            'Legacy mandatory/optional constraints not supported.');\n      }\n      if (offerOptions.offerToReceiveAudio !== undefined) {\n        if (offerOptions.offerToReceiveAudio === true) {\n          numAudioTracks = 1;\n        } else if (offerOptions.offerToReceiveAudio === false) {\n          numAudioTracks = 0;\n        } else {\n          numAudioTracks = offerOptions.offerToReceiveAudio;\n        }\n      }\n      if (offerOptions.offerToReceiveVideo !== undefined) {\n        if (offerOptions.offerToReceiveVideo === true) {\n          numVideoTracks = 1;\n        } else if (offerOptions.offerToReceiveVideo === false) {\n          numVideoTracks = 0;\n        } else {\n          numVideoTracks = offerOptions.offerToReceiveVideo;\n        }\n      }\n    }\n\n    this.transceivers.forEach(function(transceiver) {\n      if (transceiver.kind === 'audio') {\n        numAudioTracks--;\n        if (numAudioTracks < 0) {\n          transceiver.wantReceive = false;\n        }\n      } else if (transceiver.kind === 'video') {\n        numVideoTracks--;\n        if (numVideoTracks < 0) {\n          transceiver.wantReceive = false;\n        }\n      }\n    });\n\n    // Create M-lines for recvonly streams.\n    while (numAudioTracks > 0 || numVideoTracks > 0) {\n      if (numAudioTracks > 0) {\n        this._createTransceiver('audio');\n        numAudioTracks--;\n      }\n      if (numVideoTracks > 0) {\n        this._createTransceiver('video');\n        numVideoTracks--;\n      }\n    }\n    // reorder tracks\n    var transceivers = sortTracks(this.transceivers);\n\n    var sdp = SDPUtils.writeSessionBoilerplate();\n    transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      // For each track, create an ice gatherer, ice transport,\n      // dtls transport, potentially rtpsender and rtpreceiver.\n      var track = transceiver.track;\n      var kind = transceiver.kind;\n      var mid = SDPUtils.generateIdentifier();\n      transceiver.mid = mid;\n\n      if (!transceiver.iceGatherer) {\n        transceiver.iceGatherer = self.usingBundle && sdpMLineIndex > 0 ?\n            transceivers[0].iceGatherer :\n            self._createIceGatherer(mid, sdpMLineIndex);\n      }\n\n      var localCapabilities = RTCRtpSender.getCapabilities(kind);\n      // filter RTX until additional stuff needed for RTX is implemented\n      // in adapter.js\n      if (edgeVersion < 15019) {\n        localCapabilities.codecs = localCapabilities.codecs.filter(\n            function(codec) {\n              return codec.name !== 'rtx';\n            });\n      }\n      localCapabilities.codecs.forEach(function(codec) {\n        // work around https://bugs.chromium.org/p/webrtc/issues/detail?id=6552\n        // by adding level-asymmetry-allowed=1\n        if (codec.name === 'H264' &&\n            codec.parameters['level-asymmetry-allowed'] === undefined) {\n          codec.parameters['level-asymmetry-allowed'] = '1';\n        }\n      });\n\n      // generate an ssrc now, to be used later in rtpSender.send\n      var sendEncodingParameters = [{\n        ssrc: (2 * sdpMLineIndex + 1) * 1001\n      }];\n      if (track) {\n        // add RTX\n        if (edgeVersion >= 15019 && kind === 'video') {\n          sendEncodingParameters[0].rtx = {\n            ssrc: (2 * sdpMLineIndex + 1) * 1001 + 1\n          };\n        }\n      }\n\n      if (transceiver.wantReceive) {\n        transceiver.rtpReceiver = new RTCRtpReceiver(transceiver.dtlsTransport,\n            kind);\n      }\n\n      transceiver.localCapabilities = localCapabilities;\n      transceiver.sendEncodingParameters = sendEncodingParameters;\n    });\n\n    // always offer BUNDLE and dispose on return if not supported.\n    if (this._config.bundlePolicy !== 'max-compat') {\n      sdp += 'a=group:BUNDLE ' + transceivers.map(function(t) {\n        return t.mid;\n      }).join(' ') + '\\r\\n';\n    }\n    sdp += 'a=ice-options:trickle\\r\\n';\n\n    transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      sdp += SDPUtils.writeMediaSection(transceiver,\n          transceiver.localCapabilities, 'offer', transceiver.stream);\n      sdp += 'a=rtcp-rsize\\r\\n';\n    });\n\n    this._pendingOffer = transceivers;\n    var desc = new RTCSessionDescription({\n      type: 'offer',\n      sdp: sdp\n    });\n    if (arguments.length && typeof arguments[0] === 'function') {\n      window.setTimeout(arguments[0], 0, desc);\n    }\n    return Promise.resolve(desc);\n  };\n\n  RTCPeerConnection.prototype.createAnswer = function() {\n    var sdp = SDPUtils.writeSessionBoilerplate();\n    if (this.usingBundle) {\n      sdp += 'a=group:BUNDLE ' + this.transceivers.map(function(t) {\n        return t.mid;\n      }).join(' ') + '\\r\\n';\n    }\n    this.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      if (transceiver.isDatachannel) {\n        sdp += 'm=application 0 DTLS/SCTP 5000\\r\\n' +\n            'c=IN IP4 0.0.0.0\\r\\n' +\n            'a=mid:' + transceiver.mid + '\\r\\n';\n        return;\n      }\n\n      // FIXME: look at direction.\n      if (transceiver.stream) {\n        var localTrack;\n        if (transceiver.kind === 'audio') {\n          localTrack = transceiver.stream.getAudioTracks()[0];\n        } else if (transceiver.kind === 'video') {\n          localTrack = transceiver.stream.getVideoTracks()[0];\n        }\n        if (localTrack) {\n          // add RTX\n          if (edgeVersion >= 15019 && transceiver.kind === 'video') {\n            transceiver.sendEncodingParameters[0].rtx = {\n              ssrc: (2 * sdpMLineIndex + 2) * 1001 + 1\n            };\n          }\n        }\n      }\n\n      // Calculate intersection of capabilities.\n      var commonCapabilities = getCommonCapabilities(\n          transceiver.localCapabilities,\n          transceiver.remoteCapabilities);\n\n      var hasRtx = commonCapabilities.codecs.filter(function(c) {\n        return c.name.toLowerCase() === 'rtx';\n      }).length;\n      if (!hasRtx && transceiver.sendEncodingParameters[0].rtx) {\n        delete transceiver.sendEncodingParameters[0].rtx;\n      }\n\n      sdp += SDPUtils.writeMediaSection(transceiver, commonCapabilities,\n          'answer', transceiver.stream);\n      if (transceiver.rtcpParameters &&\n          transceiver.rtcpParameters.reducedSize) {\n        sdp += 'a=rtcp-rsize\\r\\n';\n      }\n    });\n\n    var desc = new RTCSessionDescription({\n      type: 'answer',\n      sdp: sdp\n    });\n    if (arguments.length && typeof arguments[0] === 'function') {\n      window.setTimeout(arguments[0], 0, desc);\n    }\n    return Promise.resolve(desc);\n  };\n\n  RTCPeerConnection.prototype.addIceCandidate = function(candidate) {\n    if (!candidate) {\n      for (var j = 0; j < this.transceivers.length; j++) {\n        this.transceivers[j].iceTransport.addRemoteCandidate({});\n        if (this.usingBundle) {\n          return Promise.resolve();\n        }\n      }\n    } else {\n      var mLineIndex = candidate.sdpMLineIndex;\n      if (candidate.sdpMid) {\n        for (var i = 0; i < this.transceivers.length; i++) {\n          if (this.transceivers[i].mid === candidate.sdpMid) {\n            mLineIndex = i;\n            break;\n          }\n        }\n      }\n      var transceiver = this.transceivers[mLineIndex];\n      if (transceiver) {\n        var cand = Object.keys(candidate.candidate).length > 0 ?\n            SDPUtils.parseCandidate(candidate.candidate) : {};\n        // Ignore Chrome's invalid candidates since Edge does not like them.\n        if (cand.protocol === 'tcp' && (cand.port === 0 || cand.port === 9)) {\n          return Promise.resolve();\n        }\n        // Ignore RTCP candidates, we assume RTCP-MUX.\n        if (cand.component &&\n            !(cand.component === '1' || cand.component === 1)) {\n          return Promise.resolve();\n        }\n        transceiver.iceTransport.addRemoteCandidate(cand);\n\n        // update the remoteDescription.\n        var sections = SDPUtils.splitSections(this.remoteDescription.sdp);\n        sections[mLineIndex + 1] += (cand.type ? candidate.candidate.trim()\n            : 'a=end-of-candidates') + '\\r\\n';\n        this.remoteDescription.sdp = sections.join('');\n      }\n    }\n    if (arguments.length > 1 && typeof arguments[1] === 'function') {\n      window.setTimeout(arguments[1], 0);\n    }\n    return Promise.resolve();\n  };\n\n  RTCPeerConnection.prototype.getStats = function() {\n    var promises = [];\n    this.transceivers.forEach(function(transceiver) {\n      ['rtpSender', 'rtpReceiver', 'iceGatherer', 'iceTransport',\n        'dtlsTransport'].forEach(function(method) {\n          if (transceiver[method]) {\n            promises.push(transceiver[method].getStats());\n          }\n        });\n    });\n    var cb = arguments.length > 1 && typeof arguments[1] === 'function' &&\n        arguments[1];\n    var fixStatsType = function(stat) {\n      return {\n        inboundrtp: 'inbound-rtp',\n        outboundrtp: 'outbound-rtp',\n        candidatepair: 'candidate-pair',\n        localcandidate: 'local-candidate',\n        remotecandidate: 'remote-candidate'\n      }[stat.type] || stat.type;\n    };\n    return new Promise(function(resolve) {\n      // shim getStats with maplike support\n      var results = new Map();\n      Promise.all(promises).then(function(res) {\n        res.forEach(function(result) {\n          Object.keys(result).forEach(function(id) {\n            result[id].type = fixStatsType(result[id]);\n            results.set(id, result[id]);\n          });\n        });\n        if (cb) {\n          window.setTimeout(cb, 0, results);\n        }\n        resolve(results);\n      });\n    });\n  };\n  return RTCPeerConnection;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/webrtc-adapter/src/js/edge/rtcpeerconnection_shim.js\n// module id = 10\n// module chunks = 0","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar browserDetails = require('../utils').browserDetails;\n\nvar firefoxShim = {\n  shimOnTrack: function() {\n    if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in\n        window.RTCPeerConnection.prototype)) {\n      Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n        get: function() {\n          return this._ontrack;\n        },\n        set: function(f) {\n          if (this._ontrack) {\n            this.removeEventListener('track', this._ontrack);\n            this.removeEventListener('addstream', this._ontrackpoly);\n          }\n          this.addEventListener('track', this._ontrack = f);\n          this.addEventListener('addstream', this._ontrackpoly = function(e) {\n            e.stream.getTracks().forEach(function(track) {\n              var event = new Event('track');\n              event.track = track;\n              event.receiver = {track: track};\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            }.bind(this));\n          }.bind(this));\n        }\n      });\n    }\n  },\n\n  shimSourceObject: function() {\n    // Firefox has supported mozSrcObject since FF22, unprefixed in 42.\n    if (typeof window === 'object') {\n      if (window.HTMLMediaElement &&\n        !('srcObject' in window.HTMLMediaElement.prototype)) {\n        // Shim the srcObject property, once, when HTMLMediaElement is found.\n        Object.defineProperty(window.HTMLMediaElement.prototype, 'srcObject', {\n          get: function() {\n            return this.mozSrcObject;\n          },\n          set: function(stream) {\n            this.mozSrcObject = stream;\n          }\n        });\n      }\n    }\n  },\n\n  shimPeerConnection: function() {\n    if (typeof window !== 'object' || !(window.RTCPeerConnection ||\n        window.mozRTCPeerConnection)) {\n      return; // probably media.peerconnection.enabled=false in about:config\n    }\n    // The RTCPeerConnection object.\n    if (!window.RTCPeerConnection) {\n      window.RTCPeerConnection = function(pcConfig, pcConstraints) {\n        if (browserDetails.version < 38) {\n          // .urls is not supported in FF < 38.\n          // create RTCIceServers with a single url.\n          if (pcConfig && pcConfig.iceServers) {\n            var newIceServers = [];\n            for (var i = 0; i < pcConfig.iceServers.length; i++) {\n              var server = pcConfig.iceServers[i];\n              if (server.hasOwnProperty('urls')) {\n                for (var j = 0; j < server.urls.length; j++) {\n                  var newServer = {\n                    url: server.urls[j]\n                  };\n                  if (server.urls[j].indexOf('turn') === 0) {\n                    newServer.username = server.username;\n                    newServer.credential = server.credential;\n                  }\n                  newIceServers.push(newServer);\n                }\n              } else {\n                newIceServers.push(pcConfig.iceServers[i]);\n              }\n            }\n            pcConfig.iceServers = newIceServers;\n          }\n        }\n        return new mozRTCPeerConnection(pcConfig, pcConstraints);\n      };\n      window.RTCPeerConnection.prototype = mozRTCPeerConnection.prototype;\n\n      // wrap static methods. Currently just generateCertificate.\n      if (mozRTCPeerConnection.generateCertificate) {\n        Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n          get: function() {\n            return mozRTCPeerConnection.generateCertificate;\n          }\n        });\n      }\n\n      window.RTCSessionDescription = mozRTCSessionDescription;\n      window.RTCIceCandidate = mozRTCIceCandidate;\n    }\n\n    // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n        .forEach(function(method) {\n          var nativeMethod = RTCPeerConnection.prototype[method];\n          RTCPeerConnection.prototype[method] = function() {\n            arguments[0] = new ((method === 'addIceCandidate') ?\n                RTCIceCandidate : RTCSessionDescription)(arguments[0]);\n            return nativeMethod.apply(this, arguments);\n          };\n        });\n\n    // support for addIceCandidate(null or undefined)\n    var nativeAddIceCandidate =\n        RTCPeerConnection.prototype.addIceCandidate;\n    RTCPeerConnection.prototype.addIceCandidate = function() {\n      if (!arguments[0]) {\n        if (arguments[1]) {\n          arguments[1].apply(null);\n        }\n        return Promise.resolve();\n      }\n      return nativeAddIceCandidate.apply(this, arguments);\n    };\n\n    // shim getStats with maplike support\n    var makeMapStats = function(stats) {\n      var map = new Map();\n      Object.keys(stats).forEach(function(key) {\n        map.set(key, stats[key]);\n        map[key] = stats[key];\n      });\n      return map;\n    };\n\n    var modernStatsTypes = {\n      inboundrtp: 'inbound-rtp',\n      outboundrtp: 'outbound-rtp',\n      candidatepair: 'candidate-pair',\n      localcandidate: 'local-candidate',\n      remotecandidate: 'remote-candidate'\n    };\n\n    var nativeGetStats = RTCPeerConnection.prototype.getStats;\n    RTCPeerConnection.prototype.getStats = function(selector, onSucc, onErr) {\n      return nativeGetStats.apply(this, [selector || null])\n        .then(function(stats) {\n          if (browserDetails.version < 48) {\n            stats = makeMapStats(stats);\n          }\n          if (browserDetails.version < 53 && !onSucc) {\n            // Shim only promise getStats with spec-hyphens in type names\n            // Leave callback version alone; misc old uses of forEach before Map\n            try {\n              stats.forEach(function(stat) {\n                stat.type = modernStatsTypes[stat.type] || stat.type;\n              });\n            } catch (e) {\n              if (e.name !== 'TypeError') {\n                throw e;\n              }\n              // Avoid TypeError: \"type\" is read-only, in old versions. 34-43ish\n              stats.forEach(function(stat, i) {\n                stats.set(i, Object.assign({}, stat, {\n                  type: modernStatsTypes[stat.type] || stat.type\n                }));\n              });\n            }\n          }\n          return stats;\n        })\n        .then(onSucc, onErr);\n    };\n  }\n};\n\n// Expose public methods.\nmodule.exports = {\n  shimOnTrack: firefoxShim.shimOnTrack,\n  shimSourceObject: firefoxShim.shimSourceObject,\n  shimPeerConnection: firefoxShim.shimPeerConnection,\n  shimGetUserMedia: require('./getusermedia')\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/webrtc-adapter/src/js/firefox/firefox_shim.js\n// module id = 11\n// module chunks = 0","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar logging = require('../utils').log;\nvar browserDetails = require('../utils').browserDetails;\n\n// Expose public methods.\nmodule.exports = function() {\n  var shimError_ = function(e) {\n    return {\n      name: {\n        InternalError: 'NotReadableError',\n        NotSupportedError: 'TypeError',\n        PermissionDeniedError: 'NotAllowedError',\n        SecurityError: 'NotAllowedError'\n      }[e.name] || e.name,\n      message: {\n        'The operation is insecure.': 'The request is not allowed by the ' +\n        'user agent or the platform in the current context.'\n      }[e.message] || e.message,\n      constraint: e.constraint,\n      toString: function() {\n        return this.name + (this.message && ': ') + this.message;\n      }\n    };\n  };\n\n  // getUserMedia constraints shim.\n  var getUserMedia_ = function(constraints, onSuccess, onError) {\n    var constraintsToFF37_ = function(c) {\n      if (typeof c !== 'object' || c.require) {\n        return c;\n      }\n      var require = [];\n      Object.keys(c).forEach(function(key) {\n        if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n          return;\n        }\n        var r = c[key] = (typeof c[key] === 'object') ?\n            c[key] : {ideal: c[key]};\n        if (r.min !== undefined ||\n            r.max !== undefined || r.exact !== undefined) {\n          require.push(key);\n        }\n        if (r.exact !== undefined) {\n          if (typeof r.exact === 'number') {\n            r. min = r.max = r.exact;\n          } else {\n            c[key] = r.exact;\n          }\n          delete r.exact;\n        }\n        if (r.ideal !== undefined) {\n          c.advanced = c.advanced || [];\n          var oc = {};\n          if (typeof r.ideal === 'number') {\n            oc[key] = {min: r.ideal, max: r.ideal};\n          } else {\n            oc[key] = r.ideal;\n          }\n          c.advanced.push(oc);\n          delete r.ideal;\n          if (!Object.keys(r).length) {\n            delete c[key];\n          }\n        }\n      });\n      if (require.length) {\n        c.require = require;\n      }\n      return c;\n    };\n    constraints = JSON.parse(JSON.stringify(constraints));\n    if (browserDetails.version < 38) {\n      logging('spec: ' + JSON.stringify(constraints));\n      if (constraints.audio) {\n        constraints.audio = constraintsToFF37_(constraints.audio);\n      }\n      if (constraints.video) {\n        constraints.video = constraintsToFF37_(constraints.video);\n      }\n      logging('ff37: ' + JSON.stringify(constraints));\n    }\n    return navigator.mozGetUserMedia(constraints, onSuccess, function(e) {\n      onError(shimError_(e));\n    });\n  };\n\n  // Returns the result of getUserMedia as a Promise.\n  var getUserMediaPromise_ = function(constraints) {\n    return new Promise(function(resolve, reject) {\n      getUserMedia_(constraints, resolve, reject);\n    });\n  };\n\n  // Shim for mediaDevices on older versions.\n  if (!navigator.mediaDevices) {\n    navigator.mediaDevices = {getUserMedia: getUserMediaPromise_,\n      addEventListener: function() { },\n      removeEventListener: function() { }\n    };\n  }\n  navigator.mediaDevices.enumerateDevices =\n      navigator.mediaDevices.enumerateDevices || function() {\n        return new Promise(function(resolve) {\n          var infos = [\n            {kind: 'audioinput', deviceId: 'default', label: '', groupId: ''},\n            {kind: 'videoinput', deviceId: 'default', label: '', groupId: ''}\n          ];\n          resolve(infos);\n        });\n      };\n\n  if (browserDetails.version < 41) {\n    // Work around http://bugzil.la/1169665\n    var orgEnumerateDevices =\n        navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);\n    navigator.mediaDevices.enumerateDevices = function() {\n      return orgEnumerateDevices().then(undefined, function(e) {\n        if (e.name === 'NotFoundError') {\n          return [];\n        }\n        throw e;\n      });\n    };\n  }\n  if (browserDetails.version < 49) {\n    var origGetUserMedia = navigator.mediaDevices.getUserMedia.\n        bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(c) {\n      return origGetUserMedia(c).then(function(stream) {\n        // Work around https://bugzil.la/802326\n        if (c.audio && !stream.getAudioTracks().length ||\n            c.video && !stream.getVideoTracks().length) {\n          stream.getTracks().forEach(function(track) {\n            track.stop();\n          });\n          throw new DOMException('The object can not be found here.',\n                                 'NotFoundError');\n        }\n        return stream;\n      }, function(e) {\n        return Promise.reject(shimError_(e));\n      });\n    };\n  }\n  navigator.getUserMedia = function(constraints, onSuccess, onError) {\n    if (browserDetails.version < 44) {\n      return getUserMedia_(constraints, onSuccess, onError);\n    }\n    // Replace Firefox 44+'s deprecation warning with unprefixed version.\n    console.warn('navigator.getUserMedia has been replaced by ' +\n                 'navigator.mediaDevices.getUserMedia');\n    navigator.mediaDevices.getUserMedia(constraints).then(onSuccess, onError);\n  };\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/webrtc-adapter/src/js/firefox/getusermedia.js\n// module id = 12\n// module chunks = 0","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n'use strict';\nvar safariShim = {\n  // TODO: DrAlex, should be here, double check against LayoutTests\n\n  // TODO: once the back-end for the mac port is done, add.\n  // TODO: check for webkitGTK+\n  // shimPeerConnection: function() { },\n\n  shimAddStream: function() {\n    if (typeof window === 'object' && window.RTCPeerConnection &&\n        !('addStream' in window.RTCPeerConnection.prototype)) {\n      RTCPeerConnection.prototype.addStream = function(stream) {\n        var self = this;\n        stream.getTracks().forEach(function(track) {\n          self.addTrack(track, stream);\n        });\n      };\n    }\n  },\n  shimOnAddStream: function() {\n    if (typeof window === 'object' && window.RTCPeerConnection &&\n        !('onaddstream' in window.RTCPeerConnection.prototype)) {\n      Object.defineProperty(window.RTCPeerConnection.prototype, 'onaddstream', {\n        get: function() {\n          return this._onaddstream;\n        },\n        set: function(f) {\n          if (this._onaddstream) {\n            this.removeEventListener('addstream', this._onaddstream);\n            this.removeEventListener('track', this._onaddstreampoly);\n          }\n          this.addEventListener('addstream', this._onaddstream = f);\n          this.addEventListener('track', this._onaddstreampoly = function(e) {\n            var stream = e.streams[0];\n            if (!this._streams) {\n              this._streams = [];\n            }\n            if (this._streams.indexOf(stream) >= 0) {\n              return;\n            }\n            this._streams.push(stream);\n            var event = new Event('addstream');\n            event.stream = e.streams[0];\n            this.dispatchEvent(event);\n          }.bind(this));\n        }\n      });\n    }\n  },\n  shimCallbacksAPI: function() {\n    if (typeof window !== 'object' || !window.RTCPeerConnection) {\n      return;\n    }\n    var prototype = RTCPeerConnection.prototype;\n    var createOffer = prototype.createOffer;\n    var createAnswer = prototype.createAnswer;\n    var setLocalDescription = prototype.setLocalDescription;\n    var setRemoteDescription = prototype.setRemoteDescription;\n    var addIceCandidate = prototype.addIceCandidate;\n\n    prototype.createOffer = function(successCallback, failureCallback) {\n      var options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      var promise = createOffer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n    prototype.createAnswer = function(successCallback, failureCallback) {\n      var options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      var promise = createAnswer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n    var withCallback = function(description, successCallback, failureCallback) {\n      var promise = setLocalDescription.apply(this, [description]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n    prototype.setLocalDescription = withCallback;\n\n    withCallback = function(description, successCallback, failureCallback) {\n      var promise = setRemoteDescription.apply(this, [description]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n    prototype.setRemoteDescription = withCallback;\n\n    withCallback = function(candidate, successCallback, failureCallback) {\n      var promise = addIceCandidate.apply(this, [candidate]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n    prototype.addIceCandidate = withCallback;\n  },\n  shimGetUserMedia: function() {\n    if (!navigator.getUserMedia) {\n      if (navigator.webkitGetUserMedia) {\n        navigator.getUserMedia = navigator.webkitGetUserMedia.bind(navigator);\n      } else if (navigator.mediaDevices &&\n          navigator.mediaDevices.getUserMedia) {\n        navigator.getUserMedia = function(constraints, cb, errcb) {\n          navigator.mediaDevices.getUserMedia(constraints)\n          .then(cb, errcb);\n        }.bind(navigator);\n      }\n    }\n  }\n};\n\n// Expose public methods.\nmodule.exports = {\n  shimCallbacksAPI: safariShim.shimCallbacksAPI,\n  shimAddStream: safariShim.shimAddStream,\n  shimOnAddStream: safariShim.shimOnAddStream,\n  shimGetUserMedia: safariShim.shimGetUserMedia\n  // TODO\n  // shimPeerConnection: safariShim.shimPeerConnection\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/webrtc-adapter/src/js/safari/safari_shim.js\n// module id = 13\n// module chunks = 0","function QRScanner() {\n  var createQRScannerAdapter = require('../../common/src/createQRScannerAdapter.js');\n  var createQRScannerInternal = require('./createQRScannerInternal.js');\n\n  var internal = createQRScannerInternal();\n  var functionList = {\n      prepare: internal.prepare,\n      show: internal.show,\n      hide: internal.hide,\n      scan: internal.scan,\n      cancelScan: internal.cancelScan,\n      pausePreview: internal.pausePreview,\n      resumePreview: internal.resumePreview,\n      enableLight: internal.enableLight,\n      disableLight: internal.disableLight,\n      useCamera: internal.useCamera,\n      openSettings: internal.openSettings,\n      getStatus: internal.getStatus,\n      destroy: internal.destroy\n  };\n\n  // always returns an executable function for use by the internal component\n  // if a callback is provided, use it\n  function getFunc(callback){\n    if(typeof callback === \"function\"){\n      return callback;\n    }\n    return function(){\n      // callback is not needed\n      return;\n    };\n  }\n\n  // shim cordova's functionality for library usage\n  var shimCordova = {\n    exec: function(successCallback, errorCallback, className, functionName, inputArray){\n      if(className !== 'QRScanner' || !functionList[functionName]){\n        return errorCallback(0);\n      }\n      if(inputArray){\n        functionList[functionName](getFunc(successCallback), getFunc(errorCallback), inputArray);\n      } else {\n        functionList[functionName](getFunc(successCallback), getFunc(errorCallback));\n      }\n    }\n  };\n\n  var adapter = createQRScannerAdapter(shimCordova);\n  return adapter;\n}\n\nmodule.exports = new QRScanner();\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/browser/src/library.js\n// module id = 14\n// module chunks = 0"],"sourceRoot":""}